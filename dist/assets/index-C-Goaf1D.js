const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-BA3etXaY.js","assets/vendor-react-C0zd0Nk4.js"])))=>i.map(i=>d[i]);
import{r as a,j as e,H as tt,u as at,C as Q,b as be,P as st,L as it,U as Ne,c as Ve,d as qe,T as rt,S as ke,X as ne,e as He,f as nt,h as Ce,R as lt,i as ot,k as ge,l as me,m as G,D as dt,Z as ct,n as pt,W as xt,o as ht,p as ut,q as Z,s as gt,E as mt,t as ft,F as yt,v as Ye,w as jt,A as bt,x as vt,y as St,z as Me,B as wt,G as Nt,I as kt,J as Ct,K as $e,N as zt,M as It,O as _e,Q as X,V as Oe,Y as Tt,_ as Wt,$ as Dt}from"./vendor-react-C0zd0Nk4.js";import{a as At,m as Y,A as ce}from"./vendor-BA3etXaY.js";(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const d of s)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function c(s){const d={};return s.integrity&&(d.integrity=s.integrity),s.referrerPolicy&&(d.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?d.credentials="include":s.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(s){if(s.ep)return;s.ep=!0;const d=c(s);fetch(s.href,d)}})();const Bt="",R=At.create({baseURL:Bt});R.interceptors.request.use(t=>{const x=localStorage.getItem("userInfo");if(x){const{token:c}=JSON.parse(x);t.headers.Authorization=`Bearer ${c}`}return t},t=>Promise.reject(t));const Je=a.createContext(),Rt=({children:t})=>{const[x,c]=a.useState(null),[i,s]=a.useState(!0);a.useEffect(()=>{const b=localStorage.getItem("userInfo");b&&c(JSON.parse(b)),s(!1)},[]);const d=async(b,k)=>{const{data:p}=await R.post("/api/auth/login",{mobile:b,password:k});return localStorage.setItem("userInfo",JSON.stringify(p)),c(p),p},f=()=>{localStorage.removeItem("userInfo"),c(null)};return e.jsx(Je.Provider,{value:{user:x,login:d,logout:f,loading:i},children:t})},ze=()=>a.useContext(Je),ee=({title:t,description:x,keywords:c,image:i})=>{const s="FleetCRM | Professional Taxi & Fleet Management",d="Smart Fleet Management solution for modern taxi businesses. Track vehicles, manage drivers, and monitor daily reports with ease.",f=t?`${t} | ${s}`:s;return e.jsxs(tt,{children:[e.jsx("title",{children:f}),e.jsx("meta",{name:"description",content:x||d}),e.jsx("meta",{name:"keywords",content:c||"fleet management, taxi crm, vehicle tracking, driver management, taxi fleet software"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:title",content:f}),e.jsx("meta",{property:"og:description",content:x||d}),i&&e.jsx("meta",{property:"og:image",content:i}),e.jsx("meta",{name:"twitter:creator",content:"FleetCRM"}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:f}),e.jsx("meta",{name:"twitter:description",content:x||d}),i&&e.jsx("meta",{name:"twitter:image",content:i}),e.jsx("link",{rel:"canonical",href:window.location.href})]})},Pt=()=>{const[t,x]=a.useState(""),[c,i]=a.useState(""),[s,d]=a.useState(""),[f,b]=a.useState(!1),{login:k}=ze(),p=at(),n=async C=>{C.preventDefault(),d(""),b(!0);try{(await k(t,c)).role==="Admin"?p("/admin"):p("/driver")}catch(h){console.error("Login Error Object:",h);const S=h.response?.data?.message||h.message||"Invalid credentials",A=h.response?.data?.error?` (${h.response.data.error})`:"";d(S+A)}finally{b(!1)}};return e.jsxs("div",{className:"login-container",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",padding:"20px"},children:[e.jsx(ee,{title:"Admin Login",description:"Access the FleetCRM Management Portal to manage your taxi fleet and drivers."}),e.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card",style:{width:"100%",maxWidth:"400px",padding:"40px",textAlign:"center"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"30px"},children:[e.jsx("div",{style:{background:"linear-gradient(135deg, #0ea5e9, #6366f1)",padding:"15px",borderRadius:"20px",marginBottom:"15px"},children:e.jsx(Q,{size:32,color:"white"})}),e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"white"},children:"Fleet CRM"}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"5px"},children:"Management Portal"})]}),s&&e.jsxs("div",{style:{background:"rgba(244, 63, 94, 0.1)",border:"1px solid var(--accent)",color:"var(--accent)",padding:"10px",borderRadius:"8px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px",fontSize:"14px"},children:[e.jsx(be,{size:16}),s]}),e.jsxs("form",{onSubmit:n,style:{textAlign:"left"},children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",marginBottom:"8px",color:"var(--text-muted)"},children:"Username or Mobile"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(st,{size:18,style:{position:"absolute",left:"12px",top:"14px",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"input-field",style:{paddingLeft:"40px"},placeholder:"Username or Mobile",value:t,onChange:C=>x(C.target.value),required:!0})]})]}),e.jsxs("div",{style:{marginBottom:"25px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",marginBottom:"8px",color:"var(--text-muted)"},children:"Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(it,{size:18,style:{position:"absolute",left:"12px",top:"14px",color:"var(--text-muted)"}}),e.jsx("input",{type:"password",className:"input-field",style:{paddingLeft:"40px"},placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:c,onChange:C=>i(C.target.value),required:!0})]})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%"},disabled:f,children:f?"Signing In...":"Sign In"})]})]})]})},Xe=a.createContext(),Ot=({children:t})=>{const[x,c]=a.useState([]),[i,s]=a.useState(null),[d,f]=a.useState(!0),b=()=>{const h=new Date,S=h.getFullYear(),A=String(h.getMonth()+1).padStart(2,"0"),g=String(h.getDate()).padStart(2,"0");return`${S}-${A}-${g}`},[k,p]=a.useState(b());a.useEffect(()=>{n()},[]);const n=async()=>{try{const h=JSON.parse(localStorage.getItem("userInfo"));if(!h)return;const{data:S}=await R.get("/api/auth/companies",{headers:{Authorization:`Bearer ${h.token}`}});c(S);const A=localStorage.getItem("selectedCompanyId");if(A){const g=S.find(P=>P._id===A);s(g||S[0])}else S.length>0&&s(S[0])}catch(h){console.error("Error fetching companies",h)}finally{f(!1)}},C=h=>{s(h),h&&localStorage.setItem("selectedCompanyId",h._id)};return e.jsx(Xe.Provider,{value:{companies:x,selectedCompany:i,setSelectedCompany:C,selectedDate:k,setSelectedDate:p,loading:d},children:t})},le=()=>a.useContext(Xe),je=({icon:t,label:x,value:c,color:i,loading:s})=>e.jsxs("div",{className:`stat-card glass-card ${s?"stale-card":""}`,children:[e.jsxs("div",{className:"stat-card-header",children:[e.jsx("div",{className:"stat-card-icon",style:{background:`${i}15`,color:i},children:e.jsx(t,{size:16})}),e.jsx("p",{className:"stat-card-label",children:x})]}),e.jsx("div",{className:"stat-card-body",children:e.jsx("h3",{className:"stat-card-value",children:s?e.jsx("span",{className:"loading-dots",children:"..."}):c||0})})]}),Lt=({item:t,onClose:x})=>(a.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]),e.jsx("div",{className:"modal-overlay",onClick:x,children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},className:"glass-card modal-content",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{className:"modal-title",children:"Attendance Details"}),e.jsx("button",{onClick:x,className:"modal-close-btn",children:e.jsx(ne,{size:18})})]}),e.jsxs("div",{className:"modal-grid-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"modal-section-title",style:{color:"#10b981"},children:"Punch In"}),e.jsxs("div",{className:"photo-grid",children:[e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"SELFIE"}),e.jsx("img",{src:t.punchIn?.selfie,alt:"Punch In Selfie",className:"photo-thumbnail",loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"KM METER"}),e.jsx("img",{src:t.punchIn?.kmPhoto,alt:"KM Photo",className:"photo-thumbnail",loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"CAR SELFIE"}),e.jsx("img",{src:t.punchIn?.carSelfie,alt:"Car Selfie",className:"photo-thumbnail",loading:"lazy"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"modal-section-title",style:{color:"#f43f5e"},children:"Punch Out"}),t.punchOut?.time?e.jsxs("div",{className:"photo-grid",children:[e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"SELFIE"}),e.jsx("img",{src:t.punchOut?.selfie,alt:"Punch Out Selfie",className:"photo-thumbnail",loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"KM METER"}),e.jsx("img",{src:t.punchOut?.kmPhoto,alt:"KM Photo",className:"photo-thumbnail",loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"CAR SELFIE"}),e.jsx("img",{src:t.punchOut?.carSelfie,alt:"Car Selfie",className:"photo-thumbnail",loading:"lazy"})]})]}):e.jsxs("div",{style:{height:"clamp(70px, 16vw, 85px)",display:"flex",flexDirection:"column",gap:"8px",justifyContent:"center",alignItems:"center",color:"var(--text-muted)",border:"1px dashed rgba(255,255,255,0.1)",borderRadius:"12px",background:"rgba(255,255,255,0.02)"},children:[e.jsx(qe,{size:20}),e.jsx("p",{style:{fontSize:"clamp(11px, 2.5vw, 12px)",margin:0,fontWeight:"600"},children:"On Trip..."})]})]})]}),e.jsxs("div",{style:{marginTop:"clamp(20px, 4vw, 25px)",display:"grid",gap:"clamp(12px, 2.5vw, 20px)"},className:"modal-grid-2",children:[e.jsxs("div",{className:"glass-card",style:{padding:"clamp(12px, 2.5vw, 15px)",border:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("p",{style:{fontSize:"clamp(9px, 2.2vw, 10px)",color:"var(--text-muted)",marginBottom:"12px",fontWeight:"800",letterSpacing:"0.5px"},children:"FUEL REFILL"}),t.fuel?.filled?e.jsxs("div",{style:{display:"grid",gap:"10px"},children:[t.fuel.entries&&t.fuel.entries.length>0?t.fuel.entries.map((c,i)=>e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",background:"rgba(255,255,255,0.03)",padding:"8px",borderRadius:"8px"},children:[e.jsx("img",{src:c.slipPhoto,onClick:()=>window.open(c.slipPhoto),alt:"Fuel slip",style:{width:"35px",height:"35px",borderRadius:"6px",objectFit:"cover",cursor:"pointer"}}),e.jsx("div",{style:{flex:1},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"clamp(11px, 2.8vw, 12px)"},children:[e.jsxs("span",{style:{color:"white",fontWeight:"800"},children:["â‚¹",c.amount]}),e.jsxs("span",{style:{color:"var(--primary)",fontWeight:"700"},children:[c.km," KM"]})]})})]},i)):e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[t.fuel.slipPhoto&&e.jsx("img",{src:t.fuel.slipPhoto,onClick:()=>window.open(t.fuel.slipPhoto),alt:"Fuel slip",style:{width:"40px",height:"40px",borderRadius:"6px",objectFit:"cover",cursor:"pointer"}}),e.jsxs("div",{children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"clamp(13px, 3.2vw, 15px)",margin:0},children:["â‚¹",t.fuel.amount]}),e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700",fontSize:"clamp(10px, 2.5vw, 11px)",margin:0},children:[t.fuel.km||"--"," KM"]})]})]}),t.fuel.entries?.length>1&&e.jsxs("p",{style:{margin:0,fontSize:"clamp(10px, 2.5vw, 11px)",color:"#10b981",fontWeight:"800",textAlign:"right"},children:["Total: â‚¹",t.fuel.amount]})]}):e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"clamp(12px, 2.8vw, 13px)",margin:0},children:"-"})]}),e.jsxs("div",{className:"glass-card",style:{padding:"clamp(12px, 2.5vw, 15px)",border:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("p",{style:{fontSize:"clamp(9px, 2.2vw, 10px)",color:"var(--text-muted)",marginBottom:"12px",fontWeight:"800",letterSpacing:"0.5px"},children:"PARKING & TOLL"}),t.parking&&t.parking.length>0?e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:t.parking.map((c,i)=>e.jsx("div",{style:{padding:"4px 10px",borderRadius:"6px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.05)",display:"flex",alignItems:"center",gap:"4px"},children:e.jsxs("span",{style:{color:"white",fontWeight:"700",fontSize:"clamp(10px, 2.3vw, 11px)"},children:["â‚¹",c.amount]})},i))}):e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"clamp(12px, 2.8vw, 13px)",margin:0},children:"â‚¹ 0"})]}),e.jsxs("div",{className:"glass-card",style:{padding:"clamp(12px, 2.5vw, 15px)",border:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("p",{style:{fontSize:"clamp(9px, 2.2vw, 10px)",color:"var(--text-muted)",marginBottom:"12px",fontWeight:"800",letterSpacing:"0.5px"},children:"ALLOWANCES"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[t.punchOut?.allowanceTA>0&&e.jsxs("span",{style:{padding:"4px 10px",borderRadius:"6px",background:"rgba(16, 185, 129, 0.1)",color:"#10b981",fontSize:"clamp(10px, 2.3vw, 11px)",fontWeight:"700"},children:["TA: â‚¹",t.punchOut.allowanceTA]}),t.punchOut?.nightStayAmount>0&&e.jsxs("span",{style:{padding:"4px 10px",borderRadius:"6px",background:"rgba(16, 185, 129, 0.1)",color:"#10b981",fontSize:"clamp(10px, 2.3vw, 11px)",fontWeight:"700"},children:["Stay: â‚¹",t.punchOut.nightStayAmount]}),!t.punchOut?.allowanceTA&&!t.punchOut?.nightStayAmount&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"clamp(12px, 2.8vw, 13px)",margin:0},children:"-"})]})]})]}),t.punchOut?.remarks&&e.jsxs("div",{className:"glass-card",style:{marginTop:"clamp(18px, 4vw, 20px)",padding:"clamp(12px, 2.5vw, 15px)",border:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("p",{style:{fontSize:"clamp(9px, 2.2vw, 10px)",color:"var(--text-muted)",marginBottom:"8px",fontWeight:"800"},children:"REMARKS"}),e.jsxs("p",{style:{color:"white",fontSize:"clamp(12px, 2.8vw, 13px)",lineHeight:"1.6",margin:0,fontStyle:"italic"},children:['"',t.punchOut.remarks,'"']})]}),t.punchOut?.otherRemarks&&e.jsxs("div",{className:"glass-card",style:{marginTop:"clamp(12px, 2.5vw, 15px)",padding:"clamp(12px, 2.5vw, 15px)",border:"1px solid rgba(244, 63, 94, 0.2)",background:"rgba(244, 63, 94, 0.05)"},children:[e.jsx("p",{style:{fontSize:"clamp(9px, 2.2vw, 10px)",color:"#f43f5e",marginBottom:"8px",fontWeight:"800"},children:"ISSUES / MAINTENANCE"}),e.jsx("p",{style:{color:"white",fontSize:"clamp(12px, 2.8vw, 13px)",lineHeight:"1.6",margin:0},children:t.punchOut.otherRemarks})]}),e.jsx("div",{style:{marginTop:"clamp(18px, 4vw, 25px)",display:"grid",gap:"clamp(12px, 2.5vw, 15px)"},className:"modal-grid-2",children:e.jsxs("div",{className:"glass-card",style:{padding:"clamp(14px, 2.5vw, 15px)",textAlign:"center",border:"1px solid rgba(16, 185, 129, 0.2)",background:"rgba(16, 185, 129, 0.05)"},children:[e.jsx("p",{style:{fontSize:"clamp(9px, 2.2vw, 10px)",color:"#10b981",fontWeight:"800",marginBottom:"6px"},children:"DISTANCE COVERED"}),e.jsxs("h3",{style:{color:"white",margin:0,fontSize:"clamp(20px, 4.5vw, 24px)",fontWeight:"800"},children:[t.totalKM," ",e.jsx("small",{style:{fontSize:"clamp(11px, 2.5vw, 12px)",opacity:.6},children:"KM"})]})]})})]})})),Et=()=>{const{selectedCompany:t,selectedDate:x,setSelectedDate:c}=le(),[i,s]=a.useState(null),[d,f]=a.useState(!0),[b,k]=a.useState(null),p={YatreeDestination:"/logos/YD.Logo.webp",GoGetGo:"/logos/gogetgo.webp"};return a.useEffect(()=>{let n=!1;return(async()=>{const h=localStorage.getItem("userInfo");if(!(!h||!t)){f(!0);try{const S=JSON.parse(h),{data:A}=await R.get(`/api/admin/dashboard/${t._id}?date=${x}`,{headers:{Authorization:`Bearer ${S.token}`}});n||s(A)}catch(S){console.error("Error fetching stats",S)}finally{n||f(!1)}}})(),()=>{n=!0}},[t,x]),e.jsxs("div",{className:"container-fluid admin-layout-wrapper",children:[e.jsx(ee,{title:`${t?.name||"Admin"} Dashboard`,description:`Real-time stats and activity for ${t?.name||"your fleet"}.`}),e.jsxs("header",{className:"dashboard-header",children:[e.jsxs("div",{className:"header-logo-section",children:[e.jsx("div",{className:"header-logo-container",children:e.jsx("img",{src:p[t?.name],alt:`${t?.name} Logo`,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title text-gradient",children:"Intel Center"}),e.jsx("p",{className:"header-subtitle text-gradient-blue",style:{fontWeight:"600"},children:t?.name})]})]}),e.jsx("div",{className:"date-selector-container",children:e.jsxs("div",{className:"date-selector-inner",children:[e.jsx("button",{onClick:()=>{const n=new Date(x);n.setDate(n.getDate()-1),c(n.toISOString().split("T")[0])},className:"glass-card-hover-effect",title:"Previous Day",children:"â†"}),e.jsx("input",{type:"date",value:x,onChange:n=>{n.target.value&&c(n.target.value)}}),e.jsx("button",{onClick:()=>{const n=new Date(x);n.setDate(n.getDate()+1),c(n.toISOString().split("T")[0])},className:"glass-card-hover-effect",title:"Next Day",children:"â†’"}),e.jsx("button",{onClick:()=>{const n=new Date().toISOString().split("T")[0];c(n)},children:"Today"})]})})]}),e.jsxs("div",{style:{position:"relative",minHeight:"600px"},children:[e.jsx(ce,{children:d&&e.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"absolute",inset:0,background:"rgba(15, 23, 42, 0.4)",backdropFilter:"blur(4px)",zIndex:10,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"16px",pointerEvents:"none"},children:e.jsx("div",{className:"spinner"})})}),i&&e.jsxs(Y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"dashboard-main-container",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsx(je,{icon:Q,label:"Fleet",value:i.totalVehicles,color:"#0ea5e9",loading:d}),e.jsx(je,{icon:Ne,label:"Drivers",value:i.totalDrivers,color:"#6366f1",loading:d}),e.jsx(je,{icon:Ve,label:"Fastag",value:`â‚¹${i.totalFastagBalance?.toLocaleString()||0}`,color:"#10b981",loading:d}),e.jsx(je,{icon:qe,label:"Punch-In",value:i.countPunchIns,color:"#8b5cf6",loading:d}),e.jsx(je,{icon:rt,label:"Finished",value:i.countPunchOuts,color:"#f59e0b",loading:d})]}),i.expiringAlerts&&i.expiringAlerts.length>0&&e.jsxs("div",{className:"glass-card",style:{border:"1px solid rgba(244, 63, 94, 0.2)",background:"linear-gradient(145deg, rgba(244, 63, 94, 0.05), rgba(15, 23, 42, 0.2))"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"clamp(16px, 3.5vw, 20px)",flexWrap:"wrap"},children:[e.jsx(ke,{color:"#f43f5e",size:20}),e.jsx("h3",{style:{fontSize:"clamp(13px, 3.2vw, 16px)",fontWeight:"700",color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Expiry Alerts (Within 30 Days)"})]}),e.jsx("div",{className:"expiry-alerts-grid",children:i.expiringAlerts.map((n,C)=>e.jsxs("div",{className:"alert-card glass-card-hover-effect",style:{background:n.status==="Expired"?"rgba(244, 63, 94, 0.1)":"rgba(245, 158, 11, 0.1)",border:`1px solid ${n.status==="Expired"?"rgba(244, 63, 94, 0.2)":"rgba(245, 158, 11, 0.2)"}`,position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"10px",gap:"8px"},children:[e.jsx("span",{className:"alert-identifier",style:{color:"rgba(255,255,255,0.9)",textTransform:"uppercase",flex:1,fontWeight:"700"},children:n.identifier}),e.jsx("span",{style:{fontSize:"clamp(9px, 2vw, 10px)",padding:"4px 8px",borderRadius:"6px",background:n.daysLeft<0?"#f43f5e":n.daysLeft===0?"#0ea5e9":"#f59e0b",color:"white",fontWeight:"800",flexShrink:0,whiteSpace:"nowrap",boxShadow:"0 2px 5px rgba(0,0,0,0.2)"},children:n.daysLeft<0?`${Math.abs(n.daysLeft)}d Ago`:n.daysLeft===0?"Today":`${n.daysLeft}d Left`})]}),e.jsx("div",{className:"alert-type",style:{color:"white",marginBottom:"8px"},children:n.documentType}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",gap:"8px"},children:[e.jsxs("div",{className:"alert-date",style:{color:"rgba(255,255,255,0.6)",fontWeight:"500",fontSize:"clamp(10px, 2.5vw, 12px)"},children:["Exp: ",e.jsx("span",{style:{color:"white",fontWeight:"700"},children:new Date(n.expiryDate).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("a",{href:`https://wa.me/916367466426?text=${encodeURIComponent(`REMINDER: Vehicle document for ${n.identifier} (${n.documentType}) is expiring on ${new Date(n.expiryDate).toLocaleDateString()}. Please renew it ASAP.`)}`,target:"_blank",rel:"noopener noreferrer",style:{background:"rgba(37, 211, 102, 0.2)",color:"#25D366",padding:"4px 8px",borderRadius:"6px",fontSize:"clamp(9px, 2.2vw, 10px)",fontWeight:"800",display:"flex",alignItems:"center",gap:"4px",textDecoration:"none",border:"1px solid rgba(37, 211, 102, 0.3)"},title:"Send WhatsApp Reminder",children:[e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ’¬"})," WA"]})]})]},C))})]}),e.jsxs("div",{className:"glass-card",style:{border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"clamp(16px, 3.5vw, 20px)",flexWrap:"wrap",gap:"10px"},children:[e.jsx("h3",{style:{fontSize:"clamp(14px, 3.2vw, 16px)",fontWeight:"700",color:"white",margin:0},children:"Activity Feed"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{width:"8px",height:"8px",background:"#10b981",borderRadius:"50%",boxShadow:"0 0 10px #10b981"}}),e.jsx("span",{style:{fontSize:"clamp(9px, 2.2vw, 11px)",color:"var(--text-muted)",fontWeight:"600",letterSpacing:"0.5px"},children:"LIVE UPDATES"})]})]}),e.jsx("div",{className:"activity-table-wrapper",children:e.jsxs("table",{className:"activity-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Driver Details"}),e.jsx("th",{children:"Assigned Car"}),e.jsx("th",{children:"Trip Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsxs("tbody",{children:[i.attendanceDetails?.map(n=>e.jsxs("tr",{className:"hover-row",children:[e.jsxs("td",{children:[e.jsx("div",{className:"driver-name",children:n.driver?.name}),e.jsx("div",{className:"driver-mobile",children:n.driver?.mobile})]}),e.jsx("td",{children:e.jsx("span",{className:"vehicle-badge",children:n.vehicle?.carNumber})}),e.jsx("td",{children:e.jsx("span",{className:"status-pill",style:{background:n.status==="completed"?"rgba(16, 185, 129, 0.1)":"rgba(245, 158, 11, 0.1)",color:n.status==="completed"?"#10b981":"#f59e0b",border:`1px solid ${n.status==="completed"?"rgba(16, 185, 129, 0.2)":"rgba(245, 158, 11, 0.2)"}`},children:n.status==="completed"?"Duty Ended":"On Trip"})}),e.jsx("td",{style:{textAlign:"right"},children:e.jsx("button",{onClick:()=>k(n),className:"action-button glass-card-hover-effect",children:"Details"})})]},n._id)),(!i.attendanceDetails||i.attendanceDetails.length===0)&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"4",style:{padding:"clamp(40px, 10vw, 60px) clamp(16px, 4vw, 25px)",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(Ne,{size:32,style:{opacity:.15,marginBottom:"12px"}}),e.jsx("p",{style:{fontSize:"clamp(12px, 2.8vw, 14px)",margin:0},children:"No activity recorded for this date"})]})})]})]})})]})]}),e.jsx(ce,{children:b&&e.jsx(Lt,{item:b,onClose:()=>k(null)})})]})]})},Ge=a.createContext(),Ft={en:{logout:"Logout",yes:"Yes",no:"No",processing:"Processing...",submit:"Submit",save:"Save",capture:"Capture",noVehicle:"No Vehicle Active",startDutyMessage:"Please start your duty to select a vehicle.",assignedVehicle:"YOUR ASSIGNED VEHICLE",punchIn:"PUNCH IN",punchOut:"PUNCH OUT",dutyCompleted:"Duty Completed",offDutyMessage:"Your reports are submitted. You are now off-duty.",startNewDuty:"Start New Duty",waitingAdmin:"Waiting for Admin",reviewMessage:"Your request is under review. Please wait.",onDuty:"You are On Duty",driveSafely:"Drive safely! Close duty only after reaching parking.",submitReports:"Submit Reports & End Duty",dutyPunchIn:"Duty Punch-In",dutyPunchOut:"Duty Punch-Out",start:"START",end:"END",currentKm:"CURRENT KM METER READING",enterKm:"Enter KM",selectVehicle:"Select Assigned Vehicle",selectCar:"-- Select Available Car --",driverSelfie:"1. DRIVER SELFIE",takeSelfie:"Take Selfie",kmPhoto:"2. KM PHOTO",takeKmPhoto:"Take KM Photo",carSelfie:"3. CAR SELFIE",takeCarPhoto:"Take Car Photo",expenditureDetails:"EXPENDITURE & TRIP DETAILS",fuelQuestion:"1. Did you refill Petrol/Diesel?",refillNo:"REFILL NO.",amount:"Amount (â‚¹)",meterKm:"Meter KM",captureSlip:"Capture Slip",addAnotherBill:"Add Another Bill",parkingQuestion:"2. Did you pay for parking?",receipt:"Receipt",addAnotherParking:"Add Another Parking",outsideCityQuestion:"3. Did you go outside city?",sameDay:"SAME DAY (+100)",nightStay:"NIGHT STAY (+500)",maintenanceIssues:"MAINTENANCE ISSUES (OPTIONAL)",carWash:"Car Wash",lightIssue:"Light Issue",puncture:"Puncture",mechanical:"Mechanical",accident:"Accident/Dent",other:"Other",otherRemarks:"Other Issues/Remarks",explainOptional:"Explain (Optional)",remarksAdmin:"REMARKS FOR ADMIN",enterRemarks:"Enter remarks",submitPunchIn:"Submit Punch-In",submitPunchOut:"Submit Punch-Out",modalTakeSelfie:"Take Selfie",modalCaptureKm:"Capture KM Meter",modalTakeCarSelfie:"Take Car Selfie",modalFuelSlip:"Refill Slip Photo",modalParkingSlip:"Parking Slip Photo",modalCapturePhoto:"Capture Photo",mandatoryFields:"KM, Selfie, KM Photo, and Car Selfie are mandatory",fuelValidation:"All fuel entries must have amount, KM and slip photo",parkingValidation:"All parking entries must have amount and receipt",punchInSuccess:"Successfully Punched In!",punchOutSuccess:"Successfully Punched Out!",requestSent:"Request sent to Admin. Waiting for approval.",requestFailed:"Failed to send request",cameraError:"Could not access camera. Please ensure you have given permission or are using HTTPS."},hi:{logout:"à¤²à¥‰à¤—à¤†à¤‰à¤Ÿ",yes:"à¤¹à¤¾à¤",no:"à¤¨à¤¹à¥€à¤‚",processing:"à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤—...",submit:"à¤¸à¤¬à¤®à¤¿à¤Ÿ à¤•à¤°à¥‡à¤‚",save:"à¤¸à¤¹à¥‡à¤œà¥‡à¤‚",capture:"à¤«à¥‹à¤Ÿà¥‹ à¤²à¥‡à¤‚",noVehicle:"à¤•à¥‹à¤ˆ à¤µà¤¾à¤¹à¤¨ à¤¸à¤•à¥à¤°à¤¿à¤¯ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ",startDutyMessage:"à¤µà¤¾à¤¹à¤¨ à¤šà¥à¤¨à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¥€ à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚à¥¤",assignedVehicle:"à¤†à¤ªà¤•à¤¾ à¤†à¤µà¤‚à¤Ÿà¤¿à¤¤ à¤µà¤¾à¤¹à¤¨",punchIn:"à¤ªà¤‚à¤š à¤‡à¤¨",punchOut:"à¤ªà¤‚à¤š à¤†à¤‰à¤Ÿ",dutyCompleted:"à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤ªà¥‚à¤°à¥€ à¤¹à¥à¤ˆ",offDutyMessage:"à¤†à¤ªà¤•à¥€ à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ à¤¸à¤¬à¤®à¤¿à¤Ÿ à¤¹à¥‹ à¤—à¤ˆ à¤¹à¥ˆà¥¤ à¤…à¤¬ à¤†à¤ª à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤ªà¤° à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆà¤‚à¥¤",startNewDuty:"à¤¨à¤ˆ à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚",waitingAdmin:"à¤à¤¡à¤®à¤¿à¤¨ à¤•à¤¾ à¤‡à¤‚à¤¤à¤œà¤¼à¤¾à¤° à¤¹à¥ˆ",reviewMessage:"à¤†à¤ªà¤•à¤¾ à¤…à¤¨à¥à¤°à¥‹à¤§ à¤µà¤¿à¤šà¤¾à¤°à¤¾à¤§à¥€à¤¨ à¤¹à¥ˆà¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤°à¤¤à¥€à¤•à¥à¤·à¤¾ à¤•à¤°à¥‡à¤‚à¥¤",onDuty:"à¤†à¤ª à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤ªà¤° à¤¹à¥ˆà¤‚",driveSafely:"à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤¡à¥à¤°à¤¾à¤‡à¤µ à¤•à¤°à¥‡à¤‚! à¤ªà¤¾à¤°à¥à¤•à¤¿à¤‚à¤— à¤¸à¥à¤¥à¤² à¤ªà¤° à¤ªà¤¹à¥à¤à¤šà¤¨à¥‡ à¤•à¥‡ à¤¬à¤¾à¤¦ à¤¹à¥€ à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚à¥¤",submitReports:"à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ à¤¸à¤¬à¤®à¤¿à¤Ÿ à¤•à¤°à¥‡à¤‚ à¤”à¤° à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤¸à¤®à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚",dutyPunchIn:"à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤ªà¤‚à¤š-à¤‡à¤¨",dutyPunchOut:"à¤¡à¥à¤¯à¥‚à¤Ÿà¥€ à¤ªà¤‚à¤š-à¤†à¤‰à¤Ÿ",start:"à¤¶à¥à¤°à¥‚",end:"à¤¸à¤®à¤¾à¤ªà¥à¤¤",currentKm:"à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ KM à¤®à¥€à¤Ÿà¤° à¤°à¥€à¤¡à¤¿à¤‚à¤—",enterKm:"KM à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚",selectVehicle:"à¤†à¤µà¤‚à¤Ÿà¤¿à¤¤ à¤µà¤¾à¤¹à¤¨ à¤šà¥à¤¨à¥‡à¤‚",selectCar:"-- à¤‰à¤ªà¤²à¤¬à¥à¤§ à¤—à¤¾à¤¡à¤¼à¥€ à¤šà¥à¤¨à¥‡à¤‚ --",driverSelfie:"1. à¤¡à¥à¤°à¤¾à¤‡à¤µà¤° à¤¸à¥‡à¤²à¥à¤«à¥€",takeSelfie:"à¤¸à¥‡à¤²à¥à¤«à¥€ à¤²à¥‡à¤‚",kmPhoto:"2. KM à¤«à¥‹à¤Ÿà¥‹",takeKmPhoto:"KM à¤«à¥‹à¤Ÿà¥‹ à¤²à¥‡à¤‚",carSelfie:"3. à¤—à¤¾à¤¡à¤¼à¥€ à¤•à¥€ à¤¸à¥‡à¤²à¥à¤«à¥€",takeCarPhoto:"à¤—à¤¾à¤¡à¤¼à¥€ à¤•à¥€ à¤«à¥‹à¤Ÿà¥‹ à¤²à¥‡à¤‚",expenditureDetails:"à¤–à¤°à¥à¤š à¤”à¤° à¤¯à¤¾à¤¤à¥à¤°à¤¾ à¤µà¤¿à¤µà¤°à¤£",fuelQuestion:"1. à¤•à¥à¤¯à¤¾ à¤†à¤ªà¤¨à¥‡ à¤ªà¥‡à¤Ÿà¥à¤°à¥‹à¤²/à¤¡à¥€à¤œà¤² à¤­à¤°à¤µà¤¾à¤¯à¤¾?",refillNo:"à¤°à¥€à¤«à¤¿à¤² à¤¨à¤‚à¤¬à¤°",amount:"à¤°à¤¾à¤¶à¤¿ (â‚¹)",meterKm:"à¤®à¥€à¤Ÿà¤° KM",captureSlip:"à¤°à¤¸à¥€à¤¦ à¤•à¥€ à¤«à¥‹à¤Ÿà¥‹ à¤²à¥‡à¤‚",addAnotherBill:"à¤à¤• à¤”à¤° à¤¬à¤¿à¤² à¤œà¥‹à¤¡à¤¼à¥‡à¤‚",parkingQuestion:"2. à¤•à¥à¤¯à¤¾ à¤†à¤ªà¤¨à¥‡ à¤ªà¤¾à¤°à¥à¤•à¤¿à¤‚à¤— à¤•à¤¾ à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤•à¤¿à¤¯à¤¾?",receipt:"à¤°à¤¸à¥€à¤¦",addAnotherParking:"à¤à¤• à¤”à¤° à¤ªà¤¾à¤°à¥à¤•à¤¿à¤‚à¤— à¤œà¥‹à¤¡à¤¼à¥‡à¤‚",outsideCityQuestion:"3. à¤•à¥à¤¯à¤¾ à¤†à¤ª à¤¶à¤¹à¤° à¤•à¥‡ à¤¬à¤¾à¤¹à¤° à¤—à¤ à¤¥à¥‡?",sameDay:"à¤‰à¤¸à¥€ à¤¦à¤¿à¤¨ à¤µà¤¾à¤ªà¤¸à¥€ (+100)",nightStay:"à¤°à¤¾à¤¤ à¤•à¤¾ à¤ à¤¹à¤°à¤¾à¤µ (+500)",maintenanceIssues:"à¤…à¤¨à¥à¤°à¤•à¥à¤·à¤£ à¤®à¥à¤¦à¥à¤¦à¥‡ (à¤µà¥ˆà¤•à¤²à¥à¤ªà¤¿à¤•)",carWash:"à¤—à¤¾à¤¡à¤¼à¥€ à¤§à¥à¤²à¤¾à¤ˆ",lightIssue:"à¤²à¤¾à¤‡à¤Ÿ à¤•à¥€ à¤¸à¤®à¤¸à¥à¤¯à¤¾",puncture:"à¤ªà¤‚à¤šà¤°",mechanical:"à¤®à¥ˆà¤•à¥‡à¤¨à¤¿à¤•à¤²",accident:"à¤¦à¥à¤°à¥à¤˜à¤Ÿà¤¨à¤¾/à¤¡à¥‡à¤‚à¤Ÿ",other:"à¤…à¤¨à¥à¤¯",otherRemarks:"à¤…à¤¨à¥à¤¯ à¤®à¥à¤¦à¥à¤¦à¥‡/à¤Ÿà¤¿à¤ªà¥à¤ªà¤£à¤¿à¤¯à¤¾à¤‚",explainOptional:"à¤¸à¤®à¤à¤¾à¤à¤‚ (à¤µà¥ˆà¤•à¤²à¥à¤ªà¤¿à¤•)",remarksAdmin:"à¤à¤¡à¤®à¤¿à¤¨ à¤•à¥‡ à¤²à¤¿à¤ à¤Ÿà¤¿à¤ªà¥à¤ªà¤£à¤¿à¤¯à¤¾à¤‚",enterRemarks:"à¤Ÿà¤¿à¤ªà¥à¤ªà¤£à¤¿à¤¯à¤¾à¤‚ à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚",submitPunchIn:"à¤ªà¤‚à¤š-à¤‡à¤¨ à¤¸à¤¬à¤®à¤¿à¤Ÿ à¤•à¤°à¥‡à¤‚",submitPunchOut:"à¤ªà¤‚à¤š-à¤†à¤‰à¤Ÿ à¤¸à¤¬à¤®à¤¿à¤Ÿ à¤•à¤°à¥‡à¤‚",modalTakeSelfie:"à¤¸à¥‡à¤²à¥à¤«à¥€ à¤²à¥‡à¤‚",modalCaptureKm:"KM à¤®à¥€à¤Ÿà¤° à¤•à¥ˆà¤ªà¥à¤šà¤° à¤•à¤°à¥‡à¤‚",modalTakeCarSelfie:"à¤—à¤¾à¤¡à¤¼à¥€ à¤•à¥€ à¤¸à¥‡à¤²à¥à¤«à¥€ à¤²à¥‡à¤‚",modalFuelSlip:"à¤ˆà¤‚à¤§à¤¨ à¤°à¤¸à¥€à¤¦ à¤«à¥‹à¤Ÿà¥‹",modalParkingSlip:"à¤ªà¤¾à¤°à¥à¤•à¤¿à¤‚à¤— à¤°à¤¸à¥€à¤¦ à¤«à¥‹à¤Ÿà¥‹",modalCapturePhoto:"à¤«à¥‹à¤Ÿà¥‹ à¤•à¥ˆà¤ªà¥à¤šà¤° à¤•à¤°à¥‡à¤‚",mandatoryFields:"KM, à¤¸à¥‡à¤²à¥à¤«à¥€, KM à¤«à¥‹à¤Ÿà¥‹ à¤”à¤° à¤—à¤¾à¤¡à¤¼à¥€ à¤•à¥€ à¤¸à¥‡à¤²à¥à¤«à¥€ à¤…à¤¨à¤¿à¤µà¤¾à¤°à¥à¤¯ à¤¹à¥ˆà¤‚",fuelValidation:"à¤¸à¤­à¥€ à¤ˆà¤‚à¤§à¤¨ à¤ªà¥à¤°à¤µà¤¿à¤·à¥à¤Ÿà¤¿à¤¯à¥‹à¤‚ à¤®à¥‡à¤‚ à¤°à¤¾à¤¶à¤¿, KM à¤”à¤° à¤°à¤¸à¥€à¤¦ à¤«à¥‹à¤Ÿà¥‹ à¤¹à¥‹à¤¨à¥€ à¤šà¤¾à¤¹à¤¿à¤",parkingValidation:"à¤¸à¤­à¥€ à¤ªà¤¾à¤°à¥à¤•à¤¿à¤‚à¤— à¤ªà¥à¤°à¤µà¤¿à¤·à¥à¤Ÿà¤¿à¤¯à¥‹à¤‚ à¤®à¥‡à¤‚ à¤°à¤¾à¤¶à¤¿ à¤”à¤° à¤°à¤¸à¥€à¤¦ à¤¹à¥‹à¤¨à¥€ à¤šà¤¾à¤¹à¤¿à¤",punchInSuccess:"à¤¸à¤«à¤²à¤¤à¤¾à¤ªà¥‚à¤°à¥à¤µà¤• à¤ªà¤‚à¤š-à¤‡à¤¨ à¤¹à¥‹ à¤—à¤¯à¤¾!",punchOutSuccess:"à¤¸à¤«à¤²à¤¤à¤¾à¤ªà¥‚à¤°à¥à¤µà¤• à¤ªà¤‚à¤š-à¤†à¤‰à¤Ÿ à¤¹à¥‹ à¤—à¤¯à¤¾!",requestSent:"à¤à¤¡à¤®à¤¿à¤¨ à¤•à¥‹ à¤…à¤¨à¥à¤°à¥‹à¤§ à¤­à¥‡à¤œ à¤¦à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤ à¤…à¤¨à¥à¤®à¥‹à¤¦à¤¨ à¤•à¥€ à¤ªà¥à¤°à¤¤à¥€à¤•à¥à¤·à¤¾ à¤¹à¥ˆà¥¤",requestFailed:"à¤…à¤¨à¥à¤°à¥‹à¤§ à¤­à¥‡à¤œà¤¨à¥‡ à¤®à¥‡à¤‚ à¤µà¤¿à¤«à¤²",cameraError:"à¤•à¥ˆà¤®à¤°à¤¾ à¤à¤•à¥à¤¸à¥‡à¤¸ à¤¨à¤¹à¥€à¤‚ à¤•à¤¿à¤¯à¤¾ à¤œà¤¾ à¤¸à¤•à¤¾à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¸à¥à¤¨à¤¿à¤¶à¥à¤šà¤¿à¤¤ à¤•à¤°à¥‡à¤‚ à¤•à¤¿ à¤†à¤ªà¤¨à¥‡ à¤…à¤¨à¥à¤®à¤¤à¤¿ à¤¦à¥€ à¤¹à¥ˆ à¤¯à¤¾ HTTPS à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤° à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚à¥¤"}},Mt=({children:t})=>{const[x,c]=a.useState(localStorage.getItem("language")||"en");a.useEffect(()=>{localStorage.setItem("language",x)},[x]);const i=s=>Ft[x][s]||s;return e.jsx(Ge.Provider,{value:{language:x,setLanguage:c,t:i},children:t})},Qe=()=>a.useContext(Ge),$t=t=>[{id:"wash",label:t("carWash"),value:"Car Wash",icon:dt,color:"#3cc7f5"},{id:"light",label:t("lightIssue"),value:"Light Issue",icon:ct,color:"#f59e0b"},{id:"tyre",label:t("puncture"),value:"Puncture",icon:pt,color:"#f43f5e"},{id:"mechanic",label:t("mechanical"),value:"Mechanical",icon:xt,color:"#10b981"},{id:"dent",label:t("accident"),value:"Accident/Dent",icon:ht,color:"#9f1239"},{id:"other",label:t("other"),value:"Other",icon:ut,color:"#94a3b8"}],_t=({side:t,onCapture:x,onClose:c})=>{const{t:i}=Qe(),s=a.useRef(null),d=a.useRef(null),f=a.useRef(null),[b,k]=a.useState(null);a.useEffect(()=>(p(),()=>n()),[]);const p=async()=>{try{const h={video:{facingMode:t==="selfie"?"user":"environment",width:{ideal:1280},height:{ideal:720}}},S=await navigator.mediaDevices.getUserMedia(h);f.current=S,s.current&&(s.current.srcObject=S)}catch(h){console.error("Camera error:",h),k(i("cameraError"))}},n=()=>{f.current&&(f.current.getTracks().forEach(h=>{h.stop(),console.log("Track stopped:",h.label)}),f.current=null)},C=()=>{const h=s.current,S=d.current;h&&S&&(S.width=h.videoWidth,S.height=h.videoHeight,S.getContext("2d").drawImage(h,0,0,S.width,S.height),S.toBlob(g=>{const P=new File([g],`${t}.jpg`,{type:"image/jpeg"});x(P,S.toDataURL("image/jpeg")),n(),c()},"image/jpeg",.8))};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content glass-card",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"modal-title",children:i(t==="selfie"?"modalTakeSelfie":t==="km"?"modalCaptureKm":t==="car"?"modalTakeCarSelfie":t==="fuel"?"modalFuelSlip":t==="parking"?"modalParkingSlip":"modalCapturePhoto")}),e.jsx("button",{onClick:()=>{n(),c()},className:"modal-close-btn",children:e.jsx(ne,{size:20})})]}),b?e.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#f43f5e"},children:b}):e.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,style:{width:"100%",borderRadius:"12px",background:"#000"}}),e.jsx("canvas",{ref:d,style:{display:"none"}}),!b&&e.jsxs("button",{onClick:C,className:"btn-primary",style:{width:"100%",marginTop:"20px",padding:"16px"},children:[e.jsx(ge,{size:20,style:{display:"inline",marginRight:"8px"}}),i("capture")]})]})})},Kt=()=>{const{user:t,logout:x}=ze(),{language:c,setLanguage:i,t:s}=Qe(),[d,f]=a.useState(null),[b,k]=a.useState(!0),[p,n]=a.useState(""),[C,h]=a.useState(null),[S,A]=a.useState(null),[g,P]=a.useState(null),[z,F]=a.useState(null),[U,I]=a.useState(null),[L,_]=a.useState(null),[v,y]=a.useState(!1),[w,B]=a.useState([{amount:"",km:"",slip:null,preview:null}]),[u,D]=a.useState(!1),[m,M]=a.useState([{amount:"",slip:null,preview:null}]),[O,K]=a.useState(0),[$,V]=a.useState(!1),[r,W]=a.useState([]),[l,H]=a.useState(""),[oe,J]=a.useState(!1),[pe,Ie]=a.useState(!1),[fe,ye]=a.useState(""),[ve,xe]=a.useState(""),[te,ae]=a.useState(null),[o,T]=a.useState(!1),[se,Te]=a.useState(!1),[Se,ie]=a.useState({type:"",text:""}),[We,Le]=a.useState("");a.useEffect(()=>{De()},[]);const De=async()=>{try{const{data:j}=await R.get("/api/driver/dashboard",{headers:{Authorization:`Bearer ${t.token}`}});f(j),j.vehicle?._id&&Le(j.vehicle._id)}catch(j){console.error("Error fetching dashboard",j)}finally{k(!1)}},Ze=async j=>{if(!p||!C||!g||!U){ie({type:"error",text:s("mandatoryFields")});return}if(j==="punch-out"){if(v&&w.some(q=>!q.amount||!q.slip||!q.km)){ie({type:"error",text:s("fuelValidation")});return}if(u&&m.some(q=>!q.amount||!q.slip)){ie({type:"error",text:s("parkingValidation")});return}}T(!0),ie({type:"",text:""});const N=new FormData;N.append("km",p),N.append("selfie",C),N.append("kmPhoto",g),N.append("carSelfie",U),N.append("latitude",0),N.append("longitude",0),N.append("address","Location Disabled"),j==="punch-in"&&N.append("vehicleId",We),j==="punch-out"&&(N.append("remarks",ve),N.append("otherRemarks",fe),N.append("fuelFilled",v),v&&w.forEach(E=>{N.append("fuelAmounts",E.amount),N.append("fuelKMs",E.km),N.append("fuelSlips",E.slip)}),N.append("parkingPaid",u),u&&m.forEach(E=>{N.append("parkingAmounts",E.amount),N.append("parkingSlips",E.slip)}),N.append("outsideTripOccurred",$),$&&N.append("outsideTripType",r.join(",")));try{await R.post(`/api/driver/${j}`,N,{headers:{Authorization:`Bearer ${t.token}`,"Content-Type":"multipart/form-data"}}),ie({type:"success",text:s(j==="punch-in"?"punchInSuccess":"punchOutSuccess")}),n(""),h(null),A(null),P(null),F(null),I(null),_(null),y(!1),B([{amount:"",km:"",slip:null,preview:null}]),D(!1),M([{amount:"",slip:null,preview:null}]),K(0),V(!1),xe(""),ye(""),Te(!1),De()}catch(E){ie({type:"error",text:E.response?.data?.message||"Submission failed"})}finally{T(!1)}},et=async()=>{T(!0);try{await R.post("/api/driver/request-trip",{},{headers:{Authorization:`Bearer ${t.token}`}}),ie({type:"success",text:s("requestSent")}),De()}catch{ie({type:"error",text:s("requestFailed")})}finally{T(!1)}};if(b)return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:e.jsx("div",{className:"spinner"})});const we=d?.todayAttendance,Ee=!!we?.punchIn?.time,Fe=!!we?.punchOut?.time,he=d?.driver?.tripStatus,ue=he==="approved",de=he==="active";return e.jsxs("div",{className:"admin-layout-wrapper",children:[e.jsx(ee,{title:"Driver Portal"}),e.jsx("div",{className:"main-content",children:e.jsxs("div",{className:"container-fluid",children:[e.jsxs("header",{className:"dashboard-header",style:{marginBottom:"24px"},children:[e.jsxs("div",{className:"header-logo-section",children:[e.jsx("div",{className:"header-logo-container",children:e.jsx(Q,{size:24,color:"#0f172a"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title",children:d?.driver?.company?.name}),e.jsx("p",{className:"header-subtitle",children:t.name})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsxs("div",{className:"language-switcher",style:{background:"rgba(255,255,255,0.05)",borderRadius:"10px",padding:"4px",display:"flex"},children:[e.jsx("button",{onClick:()=>i("en"),style:{padding:"6px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:"700",background:c==="en"?"var(--primary)":"transparent",color:c==="en"?"white":"var(--text-muted)"},children:"EN"}),e.jsx("button",{onClick:()=>i("hi"),style:{padding:"6px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:"700",background:c==="hi"?"var(--primary)":"transparent",color:c==="hi"?"white":"var(--text-muted)"},children:"à¤¹à¤¿à¤¨à¥à¤¦à¥€"})]}),e.jsxs("button",{onClick:x,style:{background:"rgba(244,63,94,0.1)",color:"#f43f5e",padding:"10px 20px",borderRadius:"10px",fontWeight:"700",fontSize:"13px",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(He,{size:16})," ",s("logout")]})]})]}),!d?.vehicle&&!ue&&he!=="completed"&&he!=="pending_approval"?e.jsxs("div",{className:"glass-card",style:{padding:"40px",textAlign:"center"},children:[e.jsx(nt,{size:48,color:"#f59e0b",style:{margin:"0 auto 16px"}}),e.jsx("h2",{style:{color:"white",marginBottom:"8px"},children:s("noVehicle")}),e.jsx("p",{style:{color:"var(--text-muted)"},children:s("startDutyMessage")})]}):e.jsxs("div",{className:"form-section-wrapper",children:[d?.vehicle&&e.jsx("div",{className:"glass-card",style:{padding:"clamp(16px, 4vw, 24px)"},children:e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("p",{className:"section-subtitle",children:s("assignedVehicle")}),e.jsx("h2",{style:{fontSize:"clamp(18px, 4.5vw, 24px)",color:"white",fontWeight:"800",marginBottom:"6px"},children:d.vehicle.carNumber}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"clamp(12px, 3vw, 14px)"},children:d.vehicle.model})]})}),e.jsx("div",{className:"glass-card",style:{padding:"clamp(16px, 4vw, 24px)"},children:e.jsxs("div",{className:"modal-grid-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"section-subtitle",children:s("punchIn")}),e.jsx("p",{style:{fontSize:"clamp(20px, 5vw, 28px)",fontWeight:"800",color:Ee?"#10b981":"var(--text-muted)"},children:Ee?new Date(we.punchIn.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"section-subtitle",children:s("punchOut")}),e.jsx("p",{style:{fontSize:"clamp(20px, 5vw, 28px)",fontWeight:"800",color:Fe?"#f43f5e":"var(--text-muted)"},children:Fe?new Date(we.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"})]})]})}),he==="completed"&&e.jsxs("div",{className:"glass-card",style:{padding:"clamp(24px, 6vw, 40px)",textAlign:"center"},children:[e.jsx(Ce,{size:56,color:"#10b981",style:{margin:"0 auto 16px"}}),e.jsx("h2",{style:{color:"white",fontSize:"clamp(18px, 4.5vw, 22px)",marginBottom:"8px",fontWeight:"800"},children:s("dutyCompleted")}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"24px",fontSize:"clamp(13px, 3.2vw, 14px)"},children:s("offDutyMessage")}),e.jsx("button",{onClick:et,disabled:o,className:"btn-primary",style:{width:"100%",maxWidth:"300px",margin:"0 auto",display:"block"},children:s(o?"processing":"startNewDuty")})]}),he==="pending_approval"&&e.jsxs("div",{className:"glass-card",style:{padding:"clamp(24px, 6vw, 40px)",textAlign:"center"},children:[e.jsx(lt,{size:56,color:"#0ea5e9",style:{margin:"0 auto 16px"},className:"spinner"}),e.jsx("h2",{style:{color:"white",fontSize:"clamp(18px, 4.5vw, 22px)",marginBottom:"8px",fontWeight:"800"},children:s("waitingAdmin")}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"clamp(13px, 3.2vw, 14px)"},children:s("reviewMessage")})]}),de&&!se&&e.jsxs("div",{className:"glass-card",style:{padding:"clamp(24px, 6vw, 40px)",textAlign:"center"},children:[e.jsx(Q,{size:56,color:"#10b981",style:{margin:"0 auto 16px"}}),e.jsx("h2",{style:{color:"white",fontSize:"clamp(18px, 4.5vw, 22px)",marginBottom:"8px",fontWeight:"800"},children:s("onDuty")}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"24px",fontSize:"clamp(13px, 3.2vw, 14px)"},children:s("driveSafely")}),e.jsx("button",{onClick:()=>Te(!0),className:"btn-primary",style:{width:"100%",background:"var(--accent)",padding:"14px",boxShadow:"0 8px 20px rgba(244, 63, 94, 0.2)"},children:s("submitReports")})]}),(ue||de&&se)&&e.jsxs("div",{className:"glass-card",style:{padding:"clamp(16px, 4vw, 24px)"},children:[e.jsxs("div",{className:"modal-header",style:{marginBottom:"clamp(16px, 4vw, 24px)"},children:[de&&e.jsx("button",{onClick:()=>Te(!1),style:{background:"rgba(255,255,255,0.08)",color:"white",padding:"6px",borderRadius:"8px"},children:e.jsx(ot,{size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"modal-title",children:s(ue?"dutyPunchIn":"dutyPunchOut")}),e.jsx("p",{className:"section-subtitle",children:s(ue?"start":"end")})]})]}),e.jsxs("div",{className:"input-wrapper-full",style:{marginBottom:"clamp(16px, 4vw, 20px)"},children:[e.jsx("label",{className:"input-label",children:s("currentKm")}),e.jsx("input",{type:"number",className:"input-field",placeholder:s("enterKm"),value:p,onChange:j=>n(j.target.value)})]}),ue&&e.jsxs("div",{className:"input-wrapper-full",style:{marginBottom:"clamp(16px, 4vw, 20px)"},children:[e.jsx("label",{className:"input-label",children:s("selectVehicle")}),e.jsxs("select",{className:"input-field",value:We,onChange:j=>Le(j.target.value),style:{background:"rgba(255,255,255,0.05)",color:"white",cursor:"pointer",fontWeight:"700",fontSize:"14px",padding:"12px"},children:[e.jsx("option",{value:"",children:s("selectCar")}),d?.availableVehicles?.map(j=>e.jsxs("option",{value:j._id,children:[j.carNumber," (",j.model,")"]},j._id))]})]}),e.jsxs("div",{className:"photo-capture-grid",style:{marginBottom:"clamp(20px, 5vw, 28px)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"input-label",style:{marginBottom:"8px"},children:s("driverSelfie")}),S?e.jsxs("div",{className:"photo-preview-container",children:[e.jsx("img",{src:S,alt:"Selfie",className:"photo-preview-image"}),e.jsx("button",{onClick:()=>{h(null),A(null)},className:"photo-delete-button",children:e.jsx(ne,{size:14})})]}):e.jsxs("div",{onClick:()=>ae("selfie"),className:"photo-capture-button",children:[e.jsx(ge,{size:24,color:"var(--primary)"}),e.jsx("span",{style:{fontSize:"clamp(10px, 2.5vw, 11px)",color:"var(--text-muted)",fontWeight:"700"},children:s("takeSelfie")})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"input-label",style:{marginBottom:"8px"},children:s("kmPhoto")}),z?e.jsxs("div",{className:"photo-preview-container",children:[e.jsx("img",{src:z,alt:"KM",className:"photo-preview-image"}),e.jsx("button",{onClick:()=>{P(null),F(null)},className:"photo-delete-button",children:e.jsx(ne,{size:14})})]}):e.jsxs("div",{onClick:()=>ae("km"),className:"photo-capture-button",children:[e.jsx(ge,{size:24,color:"var(--primary)"}),e.jsx("span",{style:{fontSize:"clamp(10px, 2.5vw, 11px)",color:"var(--text-muted)",fontWeight:"700"},children:s("takeKmPhoto")})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"input-label",style:{marginBottom:"8px"},children:s("carSelfie")}),L?e.jsxs("div",{className:"photo-preview-container",children:[e.jsx("img",{src:L,alt:"Car",className:"photo-preview-image"}),e.jsx("button",{onClick:()=>{I(null),_(null)},className:"photo-delete-button",children:e.jsx(ne,{size:14})})]}):e.jsxs("div",{onClick:()=>ae("car"),className:"photo-capture-button",children:[e.jsx(ge,{size:24,color:"var(--primary)"}),e.jsx("span",{style:{fontSize:"clamp(10px, 2.5vw, 11px)",color:"var(--text-muted)",fontWeight:"700"},children:s("takeCarPhoto")})]})]})]}),de&&e.jsxs("div",{style:{marginBottom:"clamp(20px, 5vw, 28px)"},children:[e.jsx("h3",{className:"section-title",children:s("expenditureDetails")}),e.jsxs("div",{style:{marginBottom:"clamp(16px, 4vw, 20px)"},children:[e.jsx("p",{className:"input-label",style:{marginBottom:"10px"},children:s("fuelQuestion")}),e.jsxs("div",{className:"yes-no-button-group",children:[e.jsx("button",{onClick:()=>y(!0),className:"yes-no-button",style:{background:v?"var(--primary)":"rgba(255,255,255,0.1)",color:"white"},children:s("yes")}),e.jsx("button",{onClick:()=>{y(!1),B([{amount:"",km:"",slip:null,preview:null}])},className:"yes-no-button",style:{background:v?"rgba(255,255,255,0.1)":"var(--primary)",color:"white"},children:s("no")})]}),v&&e.jsxs("div",{style:{marginTop:"16px",display:"grid",gap:"clamp(12px, 3vw, 16px)"},children:[w.map((j,N)=>e.jsxs("div",{className:"entry-card",children:[e.jsxs("div",{className:"entry-card-header",children:[e.jsxs("p",{className:"entry-card-title",children:[s("refillNo")," ",N+1]}),N>0&&e.jsx("button",{onClick:()=>B(w.filter((E,q)=>q!==N)),style:{color:"#f43f5e",background:"none",padding:"4px"},children:e.jsx(me,{size:16})})]}),e.jsxs("div",{className:"input-grid-2",children:[e.jsxs("div",{className:"input-wrapper-full",children:[e.jsx("label",{className:"input-label",children:s("amount")}),e.jsx("input",{type:"number",className:"input-field",placeholder:"â‚¹",value:j.amount,onChange:E=>{const q=[...w];q[N].amount=E.target.value,B(q)},style:{marginBottom:0,fontSize:"13px",padding:"10px"}})]}),e.jsxs("div",{className:"input-wrapper-full",children:[e.jsx("label",{className:"input-label",children:s("meterKm")}),e.jsx("input",{type:"number",className:"input-field",placeholder:"KM",value:j.km,onChange:E=>{const q=[...w];q[N].km=E.target.value,B(q)},style:{marginBottom:0,fontSize:"13px",padding:"10px"}})]})]}),e.jsx("div",{onClick:()=>{K(N),ae("fuel")},className:"photo-capture-button",style:{minHeight:"70px"},children:j.preview?e.jsx("img",{src:j.preview,alt:"Fuel Slip",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"8px"}}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:20,color:"var(--primary)"}),e.jsx("span",{style:{fontSize:"clamp(10px, 2.5vw, 11px)",color:"var(--text-muted)",fontWeight:"700"},children:s("captureSlip")})]})})]},N)),e.jsxs("button",{onClick:()=>B([...w,{amount:"",km:"",slip:null,preview:null}]),className:"add-another-button",children:[e.jsx(G,{size:16})," ",s("addAnotherBill")]})]})]}),e.jsxs("div",{style:{marginBottom:"clamp(16px, 4vw, 20px)"},children:[e.jsx("p",{className:"input-label",style:{marginBottom:"10px"},children:s("parkingQuestion")}),e.jsxs("div",{className:"yes-no-button-group",children:[e.jsx("button",{onClick:()=>D(!0),className:"yes-no-button",style:{background:u?"var(--primary)":"rgba(255,255,255,0.1)",color:"white"},children:s("yes")}),e.jsx("button",{onClick:()=>{D(!1),M([{amount:"",slip:null,preview:null}])},className:"yes-no-button",style:{background:u?"rgba(255,255,255,0.1)":"var(--primary)",color:"white"},children:s("no")})]}),u&&e.jsxs("div",{style:{marginTop:"16px",display:"grid",gap:"clamp(12px, 3vw, 16px)"},children:[m.map((j,N)=>e.jsx("div",{className:"entry-card",children:e.jsxs("div",{className:"modal-grid-2",style:{alignItems:"end"},children:[e.jsxs("div",{className:"input-wrapper-full",children:[e.jsx("label",{className:"input-label",children:s("amount")}),e.jsx("input",{type:"number",className:"input-field",placeholder:"â‚¹",value:j.amount,onChange:E=>{const q=[...m];q[N].amount=E.target.value,M(q)}})]}),e.jsx("div",{onClick:()=>{K(N),ae("parking")},className:"photo-capture-button",style:{width:"100%",minHeight:"50px"},children:j.preview?e.jsx("img",{src:j.preview,alt:"Parking",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"6px"}}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:18,color:"var(--primary)"}),e.jsx("span",{style:{fontSize:"9px",color:"var(--text-muted)",fontWeight:"700"},children:s("receipt")})]})}),m.length>1&&e.jsx("button",{onClick:()=>M(m.filter((E,q)=>q!==N)),style:{color:"#f43f5e",background:"rgba(244,63,94,0.1)",width:"30px",height:"30px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(me,{size:14})})]})},N)),e.jsxs("button",{onClick:()=>M([...m,{amount:"",slip:null,preview:null}]),className:"add-another-button",children:[e.jsx(G,{size:16})," ",s("addAnotherParking")]})]})]}),e.jsxs("div",{style:{marginBottom:"clamp(16px, 4vw, 20px)"},children:[e.jsx("p",{className:"input-label",style:{marginBottom:"10px"},children:s("outsideCityQuestion")}),e.jsxs("div",{className:"yes-no-button-group",children:[e.jsx("button",{onClick:()=>V(!0),className:"yes-no-button",style:{background:$?"var(--primary)":"rgba(255,255,255,0.1)",color:"white"},children:s("yes")}),e.jsx("button",{onClick:()=>V(!1),className:"yes-no-button",style:{background:$?"rgba(255,255,255,0.1)":"var(--primary)",color:"white"},children:s("no")})]}),$&&e.jsxs("div",{className:"checkbox-group",style:{marginTop:"12px"},children:[e.jsxs("div",{className:"checkbox-item",children:[e.jsx("input",{type:"checkbox",className:"checkbox-input",checked:r.includes("Same Day"),onChange:j=>{j.target.checked?W([...r,"Same Day"]):W(r.filter(N=>N!=="Same Day"))}}),e.jsx("label",{className:"checkbox-label",children:s("sameDay")})]}),e.jsxs("div",{className:"checkbox-item",children:[e.jsx("input",{type:"checkbox",className:"checkbox-input",checked:r.includes("Night Stay"),onChange:j=>{j.target.checked?W([...r,"Night Stay"]):W(r.filter(N=>N!=="Night Stay"))}}),e.jsx("label",{className:"checkbox-label",children:s("nightStay")})]})]})]})]}),de&&e.jsxs("div",{style:{marginBottom:"clamp(20px, 5vw, 28px)"},children:[e.jsx("h3",{className:"section-title",children:s("maintenanceIssues")}),e.jsx("div",{className:"quick-issues-grid",children:$t(s).map(j=>{const N=fe.split(",").map(q=>q.trim()).includes(j.value),E=j.icon;return e.jsxs("div",{onClick:()=>{ye(q=>{const Ae=q?q.split(",").map(Be=>Be.trim()).filter(Boolean):[];return Ae.includes(j.value)?Ae.filter(Be=>Be!==j.value).join(", "):[...Ae,j.value].join(", ")})},className:"quick-issue-button",style:{background:N?"rgba(255,255,255,0.1)":"rgba(255,255,255,0.03)",border:N?`1.5px solid ${j.color}`:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx(E,{className:"quick-issue-icon",color:j.color}),e.jsx("span",{children:j.label})]},j.id)})}),e.jsxs("div",{className:"input-wrapper-full",style:{marginTop:"16px"},children:[e.jsx("label",{className:"input-label",children:s("remarksAdmin")}),e.jsx("textarea",{className:"input-field",placeholder:s("enterRemarks"),value:ve,onChange:j=>xe(j.target.value),style:{marginBottom:"15px",resize:"vertical",minHeight:"60px"}})]}),e.jsxs("div",{className:"input-wrapper-full",style:{marginTop:"4px"},children:[e.jsx("label",{className:"input-label",children:s("otherRemarks")}),e.jsx("textarea",{className:"input-field",placeholder:s("explainOptional"),value:fe,onChange:j=>ye(j.target.value),style:{fontSize:"14px",resize:"vertical",minHeight:"60px"}})]})]}),Se.text&&e.jsx("div",{style:{padding:"12px",background:Se.type==="error"?"rgba(244,63,94,0.1)":"rgba(16,185,129,0.1)",borderRadius:"10px",marginBottom:"16px"},children:e.jsx("p",{style:{color:Se.type==="error"?"#f43f5e":"#10b981",fontSize:"clamp(12px, 3vw, 13px)",fontWeight:"600",margin:0},children:Se.text})}),e.jsx("button",{onClick:()=>{if(ue&&!We)return ie({type:"error",text:"Please select a vehicle"});Ze(de?"punch-out":"punch-in")},disabled:o,className:"btn-primary",style:{width:"100%",padding:"16px",fontSize:"clamp(14px, 3.5vw, 16px)",fontWeight:"800"},children:o?s("processing").toUpperCase():de?s("submitPunchOut").toUpperCase():s("submitPunchIn").toUpperCase()})]})]})]})}),te&&e.jsx(_t,{side:te,onCapture:(j,N)=>{if(te==="selfie")h(j),A(N);else if(te==="km")P(j),F(N);else if(te==="car")I(j),_(N);else if(te==="fuel"){const E=[...w];E[O].slip=j,E[O].preview=N,B(E)}else if(te==="parking"){const E=[...m];E[O].slip=j,E[O].preview=N,M(E)}},onClose:()=>ae(null)})]})},Ut=()=>{const{selectedCompany:t}=le(),[x,c]=a.useState([]),[i,s]=a.useState(!0),[d,f]=a.useState(!1),[b,k]=a.useState(""),[p,n]=a.useState(""),[C,h]=a.useState(""),[S,A]=a.useState(""),[g,P]=a.useState(""),[z,F]=a.useState(500),[U,I]=a.useState(!1),[L,_]=a.useState(!1),[v,y]=a.useState(null),[w,B]=a.useState({name:"",mobile:"",username:"",password:"",licenseNumber:"",dailyWage:500}),u={YatreeDestination:"/logos/YD.Logo.webp",GoGetGo:"/logos/gogetgo.webp"};a.useEffect(()=>{t&&D()},[t]);const D=async()=>{if(t?._id){s(!0);try{const l=JSON.parse(localStorage.getItem("userInfo"));if(!l)return;const{data:H}=await R.get(`/api/admin/drivers/${t._id}`,{headers:{Authorization:`Bearer ${l.token}`}});c(H.drivers||[]),console.log("Fetched Drivers:",H.drivers)}catch(l){console.error(l)}finally{s(!1)}}},m=async l=>{l.preventDefault();try{await R.post("/api/admin/drivers",{name:b,mobile:p,username:C,password:S,licenseNumber:g,companyId:t._id,isFreelancer:U,dailyWage:z},{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),f(!1),k(""),n(""),h(""),A(""),P(""),I(!1),F(500),D()}catch(H){alert(H.response?.data?.message||"Error creating driver")}},M=async(l,H)=>{const oe=H==="active"?"blocked":"active";try{await R.patch(`/api/admin/drivers/${l}/status`,{status:oe},{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),D()}catch(J){console.error(J)}},O=async l=>{if(window.confirm("Are you sure you want to delete this driver? All assignments will be cleared."))try{await R.delete(`/api/admin/drivers/${l}`,{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),D()}catch(H){alert(H.response?.data?.message||"Error deleting driver")}},K=async l=>{l.preventDefault();try{const H={name:w.name,mobile:w.mobile,username:w.username,licenseNumber:w.licenseNumber,dailyWage:w.dailyWage};w.password&&(H.password=w.password),await R.put(`/api/admin/drivers/${v._id}`,H,{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),_(!1),y(null),B({name:"",mobile:"",password:"",licenseNumber:"",dailyWage:500}),D(),alert("Driver updated successfully")}catch(H){alert(H.response?.data?.message||"Error updating driver")}},$=l=>{y(l),B({name:l.name,mobile:l.mobile,username:l.username||"",licenseNumber:l.licenseNumber||"",dailyWage:l.dailyWage||500,password:""}),_(!0)},[V,r]=a.useState(""),W=x.filter(l=>!l.isFreelancer&&(l.name?.toLowerCase().includes(V.toLowerCase())||l.mobile?.includes(V)||l.username?.toLowerCase().includes(V.toLowerCase())));return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(ee,{title:"Manage Drivers",description:"View and manage all registered drivers in your fleet management system."}),e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"30px 0",gap:"20px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"50px",height:"50px",background:"white",borderRadius:"12px",padding:"6px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 4px 15px rgba(0,0,0,0.1)"},children:e.jsx("img",{src:u[t?.name],alt:"Logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{color:"white",fontSize:"28px",fontWeight:"800",margin:0,letterSpacing:"-0.5px"},children:"Fleet Drivers"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:"4px 0 0 0",fontSize:"13px"},children:["Managing personnel for ",t?.name||"..."]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"15px",flex:"1",justifyContent:"flex-end",flexWrap:"wrap",minWidth:"300px"},children:[e.jsxs("div",{style:{position:"relative",flex:"1",maxWidth:"350px",minWidth:"200px"},children:[e.jsx(Z,{size:18,style:{position:"absolute",left:"12px",top:"15px",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search name or mobile...",value:V,onChange:l=>r(l.target.value),className:"input-field",style:{paddingLeft:"40px",marginBottom:0,height:"48px",fontSize:"14px"}})]}),e.jsxs("button",{className:"btn-primary",onClick:()=>f(!0),style:{display:"flex",alignItems:"center",gap:"8px",height:"48px",padding:"0 25px",borderRadius:"12px"},children:[e.jsx(G,{size:20})," ",e.jsx("span",{className:"mobile-hide",children:"Register Driver"}),e.jsx("span",{className:"mobile-only",children:"Add"})]})]})]}),e.jsx("div",{className:"glass-card",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"700px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Personnel"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Contact"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"License No"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Account Status"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Actions"})]})}),e.jsxs("tbody",{children:[W.map(l=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)",transition:"background 0.2s"},className:"hover-row",children:[e.jsxs("td",{style:{padding:"18px 25px"},children:[e.jsxs("div",{style:{fontWeight:"700",fontSize:"15px",color:"white",display:"flex",alignItems:"center",gap:"8px"},children:[l.name,l.isFreelancer&&e.jsx("span",{style:{fontSize:"9px",background:"rgba(99, 102, 241, 0.1)",color:"#6366f1",padding:"2px 6px",borderRadius:"4px",border:"1px solid rgba(99, 102, 241, 0.2)",fontWeight:"800",textTransform:"uppercase"},children:"Freelancer"})]}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--primary)",fontWeight:"600",opacity:.8},children:["@",l.username||"no-username"]})]}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{color:"white",fontSize:"14px",fontWeight:"600"},children:l.mobile})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{color:"white",fontSize:"13px",opacity:.8},children:l.licenseNumber||"Not Provided"})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 12px",borderRadius:"20px",fontSize:"11px",fontWeight:"700",textTransform:"uppercase",background:l.status==="active"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)",color:l.status==="active"?"#10b981":"#f43f5e"},children:[e.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:l.status==="active"?"#10b981":"#f43f5e"}}),l.status]})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[e.jsx("button",{onClick:()=>$(l),style:{background:"rgba(14, 165, 233, 0.1)",color:"var(--primary)",padding:"8px",borderRadius:"8px",border:"1px solid rgba(14, 165, 233, 0.1)"},title:"Edit Info",children:e.jsx(gt,{size:16})}),e.jsx("button",{onClick:()=>M(l._id,l.status),style:{background:l.status==="active"?"rgba(245, 158, 11, 0.1)":"rgba(16, 185, 129, 0.1)",color:l.status==="active"?"#f59e0b":"#10b981",fontSize:"11px",fontWeight:"700",padding:"8px 12px",borderRadius:"8px",border:`1px solid ${l.status==="active"?"rgba(245, 158, 11, 0.1)":"rgba(16, 185, 129, 0.1)"}`,textTransform:"uppercase"},children:l.status==="active"?"Block":"Unblock"}),e.jsx("button",{onClick:()=>O(l._id),style:{background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",padding:"8px",borderRadius:"8px",border:"1px solid rgba(244, 63, 94, 0.1)"},title:"Remove Driver",children:e.jsx(me,{size:16})})]})})]},l._id)),W.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",style:{padding:"60px",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.02)",width:"60px",height:"60px",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto 15px"},children:e.jsx(Z,{size:24,style:{opacity:.3}})}),e.jsx("p",{style:{fontSize:"14px",margin:0},children:"No drivers matching your search."})]})})]})]})}),d&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"15px"},children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"glass-card modal-content",style:{padding:"25px",width:"100%",maxWidth:"550px",maxHeight:"95vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",fontWeight:"800"},children:"Add New Driver"}),e.jsx("button",{onClick:()=>f(!1),style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(G,{size:20,style:{transform:"rotate(45deg)"}})})]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Full Name *"}),e.jsx("input",{className:"input-field",placeholder:"John Doe",value:b,onChange:l=>k(l.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Mobile Number *"}),e.jsx("input",{className:"input-field",placeholder:"10 Digit Mobile",value:p,onChange:l=>n(l.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Login Username"}),e.jsx("input",{className:"input-field",placeholder:"unique_username (optional)",value:C,onChange:l=>h(l.target.value)})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Login Password *"}),e.jsx("input",{type:"password",className:"input-field",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:S,onChange:l=>A(l.target.value),required:!0})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Driving License No"}),e.jsx("input",{className:"input-field",value:g,onChange:l=>P(l.target.value),placeholder:"DL-XXX-XXXX"})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Daily Salary (Rate)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},children:[[300,400,500].map(l=>e.jsxs("button",{type:"button",onClick:()=>F(l),style:{padding:"10px",borderRadius:"10px",border:"1px solid "+(z===l?"var(--primary)":"rgba(255,255,255,0.1)"),background:z===l?"rgba(14, 165, 233, 0.1)":"transparent",color:"white",fontWeight:"800"},children:["â‚¹",l]},l)),e.jsx("input",{type:"number",placeholder:"Custom",className:"input-field",style:{marginBottom:0,padding:"10px",height:"auto",textAlign:"center"},value:[300,400,500].includes(z)?"":z,onChange:l=>F(Number(l.target.value))})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{type:"button",className:"glass-card",style:{flex:1,padding:"14px",color:"white",fontWeight:"700"},onClick:()=>f(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,padding:"14px"},children:"Register Driver"})]})]})]})}),e.jsx(ce,{children:L&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"15px"},children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"glass-card modal-content",style:{padding:"25px",width:"100%",maxWidth:"550px",maxHeight:"95vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",fontWeight:"800",margin:0},children:"Edit Driver"}),e.jsx("p",{style:{color:"var(--primary)",fontSize:"13px",margin:0,fontWeight:"600"},children:v?.name})]}),e.jsx("button",{onClick:()=>{_(!1),y(null)},style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(G,{size:20,style:{transform:"rotate(45deg)"}})})]}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Full Name *"}),e.jsx("input",{className:"input-field",value:w.name,onChange:l=>B({...w,name:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Mobile Number *"}),e.jsx("input",{className:"input-field",value:w.mobile,onChange:l=>B({...w,mobile:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Login Username"}),e.jsx("input",{className:"input-field",value:w.username,onChange:l=>B({...w,username:l.target.value})})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"New Password"}),e.jsx("input",{type:"password",className:"input-field",value:w.password,onChange:l=>B({...w,password:l.target.value}),placeholder:"Leave blank to keep current"})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"License Number"}),e.jsx("input",{className:"input-field",value:w.licenseNumber,onChange:l=>B({...w,licenseNumber:l.target.value}),placeholder:"DL-XXX-XXXX"})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Daily Salary (Rate)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},children:[[300,400,500].map(l=>e.jsxs("button",{type:"button",onClick:()=>B({...w,dailyWage:l}),style:{padding:"10px",borderRadius:"10px",border:"1px solid "+(w.dailyWage===l?"var(--primary)":"rgba(255,255,255,0.1)"),background:w.dailyWage===l?"rgba(14, 165, 233, 0.1)":"transparent",color:"white",fontWeight:"800"},children:["â‚¹",l]},l)),e.jsx("input",{type:"number",placeholder:"Custom",className:"input-field",style:{marginBottom:0,padding:"10px",height:"auto",textAlign:"center"},value:[300,400,500].includes(w.dailyWage)?"":w.dailyWage,onChange:l=>B({...w,dailyWage:Number(l.target.value)})})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{type:"button",className:"glass-card",style:{flex:1,padding:"14px",color:"white",fontWeight:"700"},onClick:()=>{_(!1),y(null)},children:"Discard"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,padding:"14px"},children:"Save Changes"})]})]})]})})})]})},Vt=()=>{const{selectedCompany:t}=le(),[x,c]=a.useState([]),[i,s]=a.useState([]),[d,f]=a.useState(!0),[b,k]=a.useState(!1),[p,n]=a.useState(""),[C,h]=a.useState(""),[S,A]=a.useState("All India"),[g,P]=a.useState([]),[z,F]=a.useState("SUV"),[U,I]=a.useState(""),[L,_]=a.useState(""),[v,y]=a.useState(""),[w,B]=a.useState(""),[u,D]=a.useState(!1),[m,M]=a.useState({rc:null,insurance:null,puc:null,fitness:null,permit:null}),[O,K]=a.useState({rc:"",insurance:"",puc:"",fitness:"",permit:""}),[$,V]=a.useState(null),[r,W]=a.useState({type:"",file:null,expiry:""}),[l,H]=a.useState(!1),oe={YatreeDestination:"/logos/YD.Logo.webp",GoGetGo:"/logos/gogetgo.webp"};a.useEffect(()=>{t&&(J(),pe(),Ie())},[t]);const J=async()=>{if(t?._id){f(!0);try{const o=JSON.parse(localStorage.getItem("userInfo"));if(!o)return;const{data:T}=await R.get(`/api/admin/vehicles/${t._id}`,{headers:{Authorization:`Bearer ${o.token}`}});c(T.vehicles||[])}catch(o){console.error(o)}finally{f(!1)}}},pe=async()=>{if(t?._id)try{const o=JSON.parse(localStorage.getItem("userInfo"));if(!o)return;const{data:T}=await R.get(`/api/admin/drivers/${t._id}`,{headers:{Authorization:`Bearer ${o.token}`}});s(T.drivers||[])}catch(o){console.error(o)}},Ie=async()=>{if(t?._id)try{const o=JSON.parse(localStorage.getItem("userInfo")),{data:T}=await R.get(`/api/admin/dashboard/${t._id}`,{headers:{Authorization:`Bearer ${o.token}`}});P(T.expiringAlerts||[])}catch(o){console.error(o)}},fe=async o=>{o.preventDefault(),D(!0);try{const T=new FormData;T.append("carNumber",p),T.append("model",C),T.append("permitType",S),T.append("companyId",t._id),T.append("carType",z),T.append("isOutsideCar",!1),T.append("dutyAmount",U||0),T.append("fastagNumber",L),T.append("fastagBalance",v||0),T.append("fastagBank",w),Object.keys(m).forEach(se=>{m[se]&&(T.append(se,m[se]),O[se]&&T.append(`expiry_${se}`,O[se]))}),await R.post("/api/admin/vehicles",T,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),k(!1),n(""),h(""),F("SUV"),I(""),_(""),y(""),B(""),M({rc:null,insurance:null,puc:null,fitness:null,permit:null}),K({rc:"",insurance:"",puc:"",fitness:"",permit:""}),J(),Ie()}catch(T){alert(T.response?.data?.message||"Error creating vehicle")}finally{D(!1)}},ye=async o=>{if(!r.type||!r.file)return alert("Please select document type and file");H(!0);try{const T=new FormData;T.append("documentType",r.type.toUpperCase()),T.append("expiryDate",r.expiry),T.append("document",r.file),await R.post(`/api/admin/vehicles/${o}/documents`,T,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),W({type:"",file:null,expiry:""}),J(),alert("Document uploaded successfully")}catch(T){alert(T.response?.data?.message||"Error uploading document")}finally{H(!1)}},ve=async o=>{if(window.confirm("Are you sure you want to delete this vehicle? Driver assignments will be cleared."))try{await R.delete(`/api/admin/vehicles/${o}`,{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),J()}catch(T){alert(T.response?.data?.message||"Error deleting vehicle")}},[xe,te]=a.useState(""),ae=x.filter(o=>!o.isOutsideCar&&(o.carNumber?.toLowerCase().includes(xe.toLowerCase())||o.model?.toLowerCase().includes(xe.toLowerCase())));return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(ee,{title:"Manage Vehicles",description:"Track and manage all vehicles in your fleet, including document status and assignments."}),g.length>0&&e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#f59e0b",marginBottom:"15px"},children:[e.jsx(be,{size:18}),e.jsx("h2",{style:{fontSize:"16px",fontWeight:"700",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Critical Expiry Alerts"})]}),e.jsx("div",{style:{display:"flex",gap:"15px",overflowX:"auto",paddingBottom:"10px",scrollbarWidth:"none"},children:g.map((o,T)=>e.jsxs("div",{className:"glass-card",style:{minWidth:"260px",padding:"16px",borderLeft:`4px solid ${o.daysLeft<0?"#f43f5e":o.daysLeft===0?"#0ea5e9":"#f59e0b"}`,background:o.daysLeft<0?"rgba(244, 63, 94, 0.05)":"rgba(245, 158, 11, 0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",color:"var(--text-muted)",fontWeight:"700"},children:o.identifier}),e.jsx("span",{style:{fontSize:"10px",color:"white",padding:"2px 8px",borderRadius:"4px",background:o.daysLeft<0?"#f43f5e":o.daysLeft===0?"#0ea5e9":"#f59e0b",fontWeight:"800",textTransform:"uppercase"},children:o.daysLeft<0?`${Math.abs(o.daysLeft)} Days Ago`:o.daysLeft===0?"Today":`${o.daysLeft} Days Left`})]}),e.jsx("p",{style:{color:"white",fontWeight:"800",margin:"0 0 4px 0",fontSize:"15px"},children:o.documentType}),e.jsxs("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:["Expires on: ",e.jsx("span",{style:{color:"white"},children:new Date(o.expiryDate).toLocaleDateString("en-IN")})]})]},T))})]}),e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"30px 0",gap:"20px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"50px",height:"50px",background:"white",borderRadius:"12px",padding:"6px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 4px 15px rgba(0,0,0,0.1)"},children:e.jsx("img",{src:oe[t?.name],alt:"Logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{color:"white",fontSize:"28px",fontWeight:"800",margin:0,letterSpacing:"-0.5px"},children:"Fleet Vehicles"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:"4px 0 0 0",fontSize:"13px"},children:["Managing primary assets for ",t?.name||"..."]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"15px",flex:"1",justifyContent:"flex-end",flexWrap:"wrap",minWidth:"300px"},children:[e.jsxs("div",{style:{position:"relative",flex:"1",maxWidth:"350px",minWidth:"200px"},children:[e.jsx(Z,{size:18,style:{position:"absolute",left:"12px",top:"15px",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by car number or model...",value:xe,onChange:o=>te(o.target.value),className:"input-field",style:{paddingLeft:"40px",marginBottom:0,height:"48px",fontSize:"14px"}})]}),e.jsxs("button",{className:"btn-primary",onClick:()=>k(!0),style:{display:"flex",alignItems:"center",gap:"8px",height:"48px",padding:"0 25px",borderRadius:"12px"},children:[e.jsx(G,{size:20})," ",e.jsx("span",{className:"mobile-hide",children:"Add Vehicle"}),e.jsx("span",{className:"mobile-only",children:"Add"})]})]})]}),e.jsx("div",{className:"grid-responsive",style:{gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px",paddingBottom:"40px"},children:ae.length>0?ae.map(o=>e.jsxs(Y.div,{whileHover:{y:-5},className:"glass-card",style:{padding:"20px",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px",alignItems:"flex-start"},children:[e.jsx("div",{style:{background:"rgba(14, 165, 233, 0.1)",border:"1px solid rgba(14, 165, 233, 0.2)",padding:"10px",borderRadius:"12px",color:"var(--primary)"},children:e.jsx(Q,{size:22})}),e.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"10px",color:"var(--text-muted)",border:"1px solid var(--border)",padding:"3px 8px",borderRadius:"6px",fontWeight:"700",textTransform:"uppercase"},children:o.permitType}),e.jsx("button",{onClick:()=>ve(o._id),style:{background:"rgba(244, 63, 94, 0.05)",color:"#f43f5e",padding:"6px",borderRadius:"8px",border:"1px solid rgba(244, 63, 94, 0.1)"},children:e.jsx(me,{size:16})})]})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{color:"white",fontSize:"18px",fontWeight:"800",margin:"0 0 2px 0"},children:o.carNumber}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"13px",marginBottom:"20px"},children:o.model})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(255,255,255,0.02)",padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.03)"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"2px"},children:"Current Driver"}),e.jsx("p",{style:{color:o.currentDriver?"#10b981":"white",fontSize:"13px",fontWeight:"700",margin:0},children:o.currentDriver?.name||"In Yard"})]}),e.jsx("button",{onClick:()=>V(o),style:{background:"rgba(14, 165, 233, 0.1)",color:"var(--primary)",border:"1px solid rgba(14, 165, 233, 0.2)",padding:"6px 14px",borderRadius:"8px",fontSize:"12px",fontWeight:"700"},children:"Docs"})]})]},o._id)):e.jsxs("div",{className:"glass-card",style:{gridColumn:"1/-1",padding:"60px 20px",textAlign:"center"},children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.02)",width:"80px",height:"80px",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto 20px"},children:e.jsx(Q,{size:32,style:{color:"var(--text-muted)",opacity:.5}})}),e.jsx("h3",{style:{color:"white",marginBottom:"8px",fontSize:"20px"},children:"No vehicles found"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"25px",maxWidth:"400px",margin:"0 auto 25px"},children:"Create your first vehicle entry to start tracking documents and attendance."}),e.jsx("button",{className:"btn-primary",onClick:()=>k(!0),children:"Add Your First Vehicle"})]})}),b&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"15px"},children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"glass-card modal-content",style:{padding:"25px",width:"100%",maxWidth:"750px",maxHeight:"95vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",fontWeight:"700"},children:"Add New Vehicle"}),e.jsx("button",{onClick:()=>k(!1),style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(G,{size:20,style:{transform:"rotate(45deg)"}})})]}),e.jsxs("form",{onSubmit:fe,children:[e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Car Number *"}),e.jsx("input",{className:"input-field",placeholder:"DL-01-AB-1234",value:p,onChange:o=>n(o.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Model Name *"}),e.jsx("input",{className:"input-field",placeholder:"Toyota Innova",value:C,onChange:o=>h(o.target.value),required:!0})]})]}),e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Permit Category"}),e.jsxs("select",{className:"input-field",value:S,onChange:o=>A(o.target.value),children:[e.jsx("option",{value:"All India",children:"All India (National)"}),e.jsx("option",{value:"State Only",children:"State Only"}),e.jsx("option",{value:"Local",children:"Local Trip"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Car Segment"}),e.jsxs("select",{className:"input-field",value:z,onChange:o=>F(o.target.value),children:[e.jsx("option",{value:"SUV",children:"SUV / MUV"}),e.jsx("option",{value:"Sedan",children:"Sedan"}),e.jsx("option",{value:"Hatchback",children:"Hatchback"}),e.jsx("option",{value:"Other",children:"Luxury / Other"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Fastag ID"}),e.jsx("input",{className:"input-field",placeholder:"ID Number",value:L,onChange:o=>_(o.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Fastag Bank"}),e.jsx("input",{className:"input-field",placeholder:"Bank Name",value:w,onChange:o=>B(o.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Current Bal"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"0.00",value:v,onChange:o=>y(o.target.value)})]})]}),e.jsxs("div",{style:{marginBottom:"25px"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Duty / Rental Amount"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"Daily or Fixed Amount",value:U,onChange:o=>I(o.target.value)})]}),e.jsxs("div",{style:{padding:"20px",background:"rgba(255,255,255,0.01)",borderRadius:"16px",border:"1px solid rgba(255,255,255,0.05)",marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"white",fontSize:"15px",fontWeight:"700",marginBottom:"15px"},children:"Initial Documents (Optional)"}),e.jsx("div",{style:{display:"grid",gap:"12px"},children:["rc","insurance","puc","fitness","permit"].map(o=>e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"100px 1.5fr 1fr",gap:"15px",alignItems:"center"},children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:o}),e.jsx("input",{type:"file",onChange:T=>M({...m,[o]:T.target.files[0]}),style:{fontSize:"11px",color:"var(--text-muted)"}}),e.jsx("input",{type:"date",className:"input-field",style:{marginBottom:0,padding:"8px 12px",fontSize:"12px"},value:O[o],onChange:T=>K({...O,[o]:T.target.value})})]},o))})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{type:"button",className:"glass-card",style:{flex:1,padding:"14px",color:"white",fontWeight:"700"},onClick:()=>k(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,padding:"14px"},disabled:u,children:u?"Processing...":"Create Vehicle"})]})]})]})}),$&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.9)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"15px"},children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"glass-card modal-content",style:{padding:"25px",width:"100%",maxWidth:"850px",maxHeight:"95vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",fontWeight:"800",margin:0},children:"Documents"}),e.jsx("p",{style:{color:"var(--primary)",fontSize:"13px",margin:0,fontWeight:"600"},children:$.carNumber})]}),e.jsx("button",{onClick:()=>V(null),style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(G,{size:20,style:{transform:"rotate(45deg)"}})})]}),e.jsxs("div",{className:"grid-responsive",style:{gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"20px",marginBottom:"35px"},children:[$.documents?.map((o,T)=>e.jsxs("div",{className:"glass-card",style:{padding:"12px",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800",textTransform:"uppercase",margin:0},children:o.documentType}),e.jsx("span",{style:{fontSize:"10px",padding:"2px 8px",borderRadius:"4px",background:new Date(o.expiryDate)<new Date?"rgba(244, 63, 94, 0.1)":"rgba(16, 185, 129, 0.1)",color:new Date(o.expiryDate)<new Date?"#f43f5e":"#10b981",fontWeight:"700"},children:new Date(o.expiryDate)<new Date?"Expired":"Valid"})]}),e.jsxs("div",{className:"img-container",style:{position:"relative",height:"140px",borderRadius:"10px",overflow:"hidden",marginBottom:"10px",cursor:"pointer"},onClick:()=>window.open(o.imageUrl),children:[e.jsx("img",{src:o.imageUrl,style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsx("div",{className:"img-overlay",style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",justifyContent:"center",alignItems:"center",opacity:0,transition:"0.3s"},children:e.jsx(mt,{size:20,color:"white"})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"},children:[e.jsxs("div",{style:{fontSize:"11px",color:"var(--text-muted)",fontWeight:"500"},children:["Expiry: ",e.jsx("span",{style:{color:"white",fontWeight:"700"},children:new Date(o.expiryDate).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsx("a",{href:`https://wa.me/91${JSON.parse(localStorage.getItem("userInfo"))?.mobile||"9660953135"}?text=${encodeURIComponent(`ALERT: Vehicle ${$.carNumber} document (${o.documentType}) is expiring on ${new Date(o.expiryDate).toLocaleDateString()}. Please take action.`)}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#25D366",opacity:.8},title:"Send WhatsApp Reminder",children:"ðŸ’¬"})]})]},T)),(!$.documents||$.documents.length===0)&&e.jsx("div",{style:{gridColumn:"1/-1",padding:"40px",border:"1px dashed rgba(255,255,255,0.1)",borderRadius:"16px",textAlign:"center"},children:e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"14px",margin:0},children:"No documents uploaded for this vehicle."})})]}),e.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.05)",paddingTop:"25px"},children:[e.jsx("h3",{style:{color:"white",fontSize:"16px",fontWeight:"700",marginBottom:"15px"},children:"Quick Upload"}),e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"15px",alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"10px",color:"var(--text-muted)",fontWeight:"800",textTransform:"uppercase",marginBottom:"6px"},children:"Type"}),e.jsxs("select",{className:"input-field",value:r.type,onChange:o=>W({...r,type:o.target.value}),style:{marginBottom:0,height:"42px",fontSize:"13px",fontWeight:"600"},children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"RC",children:"RC"}),e.jsx("option",{value:"INSURANCE",children:"Insurance"}),e.jsx("option",{value:"PUC",children:"PUC"}),e.jsx("option",{value:"FITNESS",children:"Fitness"}),e.jsx("option",{value:"PERMIT",children:"Permit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"10px",color:"var(--text-muted)",fontWeight:"800",textTransform:"uppercase",marginBottom:"6px"},children:"Expiry Date"}),e.jsx("input",{type:"date",className:"input-field",value:r.expiry,onChange:o=>W({...r,expiry:o.target.value}),style:{marginBottom:0,height:"42px",fontSize:"13px"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{style:{display:"block",fontSize:"10px",color:"var(--text-muted)",fontWeight:"800",textTransform:"uppercase",marginBottom:"6px"},children:"File"}),e.jsx("input",{type:"file",onChange:o=>W({...r,file:o.target.files[0]}),style:{color:"white",fontSize:"11px",marginBottom:0,width:"100%"}})]}),e.jsx("button",{className:"btn-primary",onClick:()=>ye($._id),disabled:l,style:{height:"42px",padding:"0 25px"},children:l?"Saving...":"Upload"})]})]})]})})]})},qt="modulepreload",Ht=function(t){return"/"+t},Ke={},Yt=function(x,c,i){let s=Promise.resolve();if(c&&c.length>0){let k=function(p){return Promise.all(p.map(n=>Promise.resolve(n).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),b=f?.nonce||f?.getAttribute("nonce");s=k(c.map(p=>{if(p=Ht(p),p in Ke)return;Ke[p]=!0;const n=p.endsWith(".css"),C=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${C}`))return;const h=document.createElement("link");if(h.rel=n?"stylesheet":qt,n||(h.as="script"),h.crossOrigin="",h.href=p,b&&h.setAttribute("nonce",b),document.head.appendChild(h),n)return new Promise((S,A)=>{h.addEventListener("load",S),h.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${p}`)))})}))}function d(f){const b=new Event("vite:preloadError",{cancelable:!0});if(b.payload=f,window.dispatchEvent(b),!b.defaultPrevented)throw f}return s.then(f=>{for(const b of f||[])b.status==="rejected"&&d(b.reason);return x().catch(d)})},Jt=({item:t,onClose:x,borderTaxRecords:c})=>e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.9)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:2e3,padding:"15px"},children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"glass-card modal-content",style:{width:"100%",maxWidth:"900px",maxHeight:"95vh",overflowY:"auto",padding:"25px",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px",position:"sticky",top:0,background:"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(10px)",zIndex:10,padding:"10px 0"},children:[e.jsxs("h2",{style:{color:"white",fontSize:"20px",fontWeight:"800",margin:0},children:["Report Detail: ",t.driver?.name]}),e.jsx("button",{onClick:x,style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(ne,{size:20})})]}),e.jsxs("div",{className:"grid-responsive",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"30px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{borderLeft:"4px solid #10b981",paddingLeft:"12px",color:"white",marginBottom:"20px",fontSize:"15px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Punch In Details"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"6px",fontWeight:"800"},children:"SELFIE"}),e.jsx("img",{src:t.punchIn?.selfie,style:{width:"100%",borderRadius:"10px",height:"100px",objectFit:"cover",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)"}})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"6px",fontWeight:"800"},children:"KM METER"}),e.jsx("img",{src:t.punchIn?.kmPhoto,style:{width:"100%",borderRadius:"10px",height:"100px",objectFit:"cover",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)"}})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"6px",fontWeight:"800"},children:"CAR PHOTO"}),e.jsx("img",{src:t.punchIn?.carSelfie,style:{width:"100%",borderRadius:"10px",height:"100px",objectFit:"cover",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)"}})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{borderLeft:"4px solid #f43f5e",paddingLeft:"12px",color:"white",marginBottom:"20px",fontSize:"15px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Punch Out Details"}),t.punchOut?.time?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"6px",fontWeight:"800"},children:"SELFIE"}),e.jsx("img",{src:t.punchOut?.selfie,style:{width:"100%",borderRadius:"10px",height:"100px",objectFit:"cover",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)"}})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"6px",fontWeight:"800"},children:"KM METER"}),e.jsx("img",{src:t.punchOut?.kmPhoto,style:{width:"100%",borderRadius:"10px",height:"100px",objectFit:"cover",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)"}})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"6px",fontWeight:"800"},children:"CAR PHOTO"}),e.jsx("img",{src:t.punchOut?.carSelfie,style:{width:"100%",borderRadius:"10px",height:"100px",objectFit:"cover",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)"}})]})]}):e.jsxs("div",{style:{height:"100px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"var(--text-muted)",background:"rgba(255,255,255,0.02)",border:"1px dashed rgba(255,255,255,0.1)",borderRadius:"12px",gap:"8px"},children:[e.jsx("div",{className:"pulse-dot"}),e.jsx("p",{style:{fontSize:"12px",margin:0,fontWeight:"600"},children:"Driver currently on road..."})]})]})]}),e.jsxs("div",{className:"grid-responsive",style:{marginTop:"30px",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:[e.jsxs("div",{className:"glass-card",style:{padding:"20px",background:"rgba(255,255,255,0.02)"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",marginBottom:"15px",fontWeight:"800",textTransform:"uppercase"},children:"Fuel Management"}),t.fuel?.filled?e.jsxs("div",{style:{display:"grid",gap:"15px"},children:[t.fuel.entries&&t.fuel.entries.length>0?t.fuel.entries.map((i,s)=>e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",background:"rgba(255,255,255,0.03)",padding:"10px",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("img",{src:i.slipPhoto,onClick:()=>window.open(i.slipPhoto),style:{width:"45px",height:"45px",borderRadius:"8px",objectFit:"cover",cursor:"pointer"}}),e.jsx("div",{style:{flex:1},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"15px",margin:0},children:["â‚¹",i.amount]}),e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700",fontSize:"11px",margin:0},children:[i.km," KM"]})]})})]},s)):e.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[t.fuel.slipPhoto?e.jsx("img",{src:t.fuel.slipPhoto,onClick:()=>window.open(t.fuel.slipPhoto),style:{width:"60px",height:"60px",borderRadius:"8px",objectFit:"cover",border:"1px solid rgba(255,255,255,0.1)",cursor:"pointer"}}):null,e.jsx("div",{style:{flex:1},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"18px",margin:0},children:["â‚¹",t.fuel.amount]}),e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700",fontSize:"12px",margin:0},children:[t.fuel.km||"--"," KM"]})]})})]}),t.fuel.entries?.length>1&&e.jsxs("p",{style:{margin:0,fontSize:"12px",color:"#10b981",fontWeight:"900",textAlign:"right",borderTop:"1px solid rgba(255,255,255,0.05)",paddingTop:"10px"},children:["TOTAL FUEL: â‚¹",t.fuel.amount]})]}):e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"13px",margin:0},children:"No fuel entries recorded"})]}),e.jsxs("div",{className:"glass-card",style:{padding:"20px",background:"rgba(255,255,255,0.02)"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",marginBottom:"15px",fontWeight:"800",textTransform:"uppercase"},children:"Tolls & Parking"}),t.punchOut?.tollParkingAmount>0?e.jsxs("div",{children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"18px",margin:0},children:["â‚¹",t.punchOut.tollParkingAmount]}),t.parking&&t.parking.length>0&&e.jsx("div",{style:{display:"flex",gap:"6px",marginTop:"12px",flexWrap:"wrap"},children:t.parking.map((i,s)=>e.jsx("img",{src:i.slipPhoto,style:{width:"35px",height:"35px",borderRadius:"6px",objectFit:"cover",border:"1px solid rgba(255,255,255,0.1)"}},s))})]}):t.parking&&t.parking.length>0?e.jsxs("div",{style:{display:"grid",gap:"8px"},children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"18px",margin:0},children:["â‚¹",t.parking.reduce((i,s)=>i+(s.amount||0),0)]}),e.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:t.parking.map((i,s)=>e.jsx("img",{src:i.slipPhoto,title:`Amount: â‚¹${i.amount}`,style:{width:"35px",height:"35px",borderRadius:"6px",objectFit:"cover",border:"1px solid rgba(255,255,255,0.1)"}},s))})]}):e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"13px",margin:0},children:"None reported"})]}),e.jsxs("div",{className:"glass-card",style:{padding:"20px",background:"rgba(255,255,255,0.02)"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",marginBottom:"15px",fontWeight:"800",textTransform:"uppercase"},children:"Incentives & Taxes"}),t.punchOut?.allowanceTA>0||t.punchOut?.nightStayAmount>0?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t.punchOut.allowanceTA>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"13px"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"TA:"})," ",e.jsxs("span",{style:{color:"#10b981",fontWeight:"800"},children:["+â‚¹",t.punchOut.allowanceTA]})]}),t.punchOut.nightStayAmount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"13px"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Stay:"})," ",e.jsxs("span",{style:{color:"#10b981",fontWeight:"800"},children:["+â‚¹",t.punchOut.nightStayAmount]})]})]}):t.outsideTrip?.occurred?e.jsxs("div",{children:[e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"800",fontSize:"18px",margin:0},children:["+â‚¹",t.outsideTrip.bonusAmount]}),e.jsx("p",{style:{fontSize:"11px",color:"white",marginTop:"4px",textTransform:"uppercase",fontWeight:"700"},children:t.outsideTrip.tripType})]}):null,c.filter(i=>i.date===t.date&&i.vehicle?._id===t.vehicle?._id).map((i,s)=>e.jsxs("div",{style:{marginTop:"10px",padding:"10px",background:"rgba(16, 185, 129, 0.08)",borderRadius:"10px",border:"1px solid rgba(16, 185, 129, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{color:"white",fontSize:"12px",fontWeight:"700"},children:i.borderName}),e.jsxs("span",{style:{color:"#10b981",fontSize:"14px",fontWeight:"900"},children:["â‚¹",i.amount]})]}),i.remarks&&e.jsxs("p",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",margin:"4px 0 0 0",fontStyle:"italic"},children:['"',i.remarks,'"']})]},s)),!(t.punchOut?.allowanceTA>0||t.punchOut?.nightStayAmount>0||t.outsideTrip?.occurred||c.filter(i=>i.date===t.date&&i.vehicle?._id===t.vehicle?._id).length>0)&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"13px",margin:0},children:"No extra expenses"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px",marginTop:"20px"},children:[t.punchOut?.otherRemarks&&e.jsxs("div",{className:"glass-card",style:{padding:"20px",border:"1px solid rgba(244, 63, 94, 0.2)",background:"rgba(244, 63, 94, 0.02)"},children:[e.jsx("p",{style:{fontSize:"10px",color:"#f43f5e",marginBottom:"10px",fontWeight:"900",textTransform:"uppercase"},children:"Reported Issues / Remarks"}),e.jsx("p",{style:{color:"white",fontSize:"14px",lineHeight:"1.6",margin:0,fontWeight:"500"},children:t.punchOut.otherRemarks})]}),t.punchOut?.remarks&&e.jsxs("div",{className:"glass-card",style:{padding:"20px",background:"rgba(255,255,255,0.02)"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",marginBottom:"10px",fontWeight:"800",textTransform:"uppercase"},children:"Trip Route / Details"}),e.jsx("p",{style:{color:"white",fontSize:"14px",lineHeight:"1.6",margin:0},children:t.punchOut.remarks})]})]}),e.jsxs("div",{style:{marginTop:"20px",display:"flex",flexWrap:"wrap",gap:"15px"},children:[e.jsxs("div",{className:"glass-card",style:{padding:"20px",flex:"1",minWidth:"150px",textAlign:"center",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1), transparent)"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",marginBottom:"8px",fontWeight:"800"},children:"DAILY SALARY"}),e.jsxs("h3",{style:{color:"#10b981",margin:0,fontSize:"24px",fontWeight:"900"},children:["â‚¹",(t.dailyWage||t.driver?.dailyWage||t.vehicle?.dutyAmount||500).toLocaleString()]})]}),e.jsxs("div",{className:"glass-card",style:{padding:"20px",flex:"1",minWidth:"150px",textAlign:"center",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1), transparent)"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",marginBottom:"8px",fontWeight:"800"},children:"NET TRIP DISTANCE"}),e.jsxs("h3",{style:{color:"#10b981",margin:0,fontSize:"24px",fontWeight:"900"},children:[t.totalKM||"0"," KM"]})]})]})]})}),Xt=()=>{const{selectedCompany:t}=le(),x=()=>new Date().toISOString().split("T")[0],c=()=>{const v=new Date,y=v.getFullYear(),w=String(v.getMonth()+1).padStart(2,"0");return`${y}-${w}-01`},[i,s]=a.useState(c()),[d,f]=a.useState(x()),b={YatreeDestination:"/logos/YD.Logo.webp",GoGetGo:"/logos/gogetgo.webp"},[k,p]=a.useState([]),[n,C]=a.useState([]),[h,S]=a.useState([]),[A,g]=a.useState(!0),[P,z]=a.useState(null),[F,U]=a.useState("");a.useEffect(()=>{t&&I()},[t,i,d]);const I=async()=>{if(t?._id){g(!0);try{const v=JSON.parse(localStorage.getItem("userInfo"));if(!v)return;const{data:y}=await R.get(`/api/admin/reports/${t._id}?from=${i}&to=${d}`,{headers:{Authorization:`Bearer ${v.token}`}});p(y.attendance||[]),C(y.fastagRecharges||[]),S(y.borderTax||[])}catch(v){console.error("Error fetching reports",v)}finally{g(!1)}}},L=async()=>{const v=await Yt(()=>import("./vendor-BA3etXaY.js").then(m=>m.x),__vite__mapDeps([0,1]));if(k.length===0&&n.length===0&&h.length===0)return alert("No records to export for this date range.");const y=v.utils.book_new(),w=new Set,B=k.map(m=>{const M=m.punchIn?.time?new Date(m.punchIn.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--",O=m.punchOut?.time?new Date(m.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--",K=m.date||"Unknown",[$,V,r]=K.split("-"),W=`${r}-${V}-${$}`;h.filter(J=>J.date===K&&J.vehicle?._id?.toString()===m.vehicle?._id?.toString()).reduce((J,pe)=>J+(Number(pe.amount)||0),0);const H=`${m.driver?._id}_${K}`;let oe=0;return m.driver&&!w.has(H)&&(oe=m.dailyWage||m.driver?.dailyWage||m.vehicle?.dutyAmount||500,w.add(H)),{Date:W,Name:m.driver?.name||"Unknown",Car:m.vehicle?.carNumber?m.vehicle.carNumber.slice(-4):"",In:M,Out:O,KM:m.totalKM||0,Route:m.punchOut?.remarks||m.punchIn?.remarks||"",Daily:oe,"T/P":m.punchOut?.tollParkingAmount||(m.parking||[]).reduce((J,pe)=>J+(pe.amount||0),0),Night:m.punchOut?.nightStayAmount||(m.outsideTrip?.tripType==="Night Stay"?500:0),"T/A":m.punchOut?.allowanceTA||(m.outsideTrip?.tripType==="Same Day"?100:0),Fuel:m.fuel?.amount||0,"Fuel KM":m.fuel?.entries&&m.fuel.entries.length>0?m.fuel.entries.map(J=>J.km).join(", "):m.fuel?.km||0,Company:m.vehicle?.isOutsideCar||m.driver?.isFreelancer?"FREELANCER":t.name,Remarks:m.punchOut?.otherRemarks||""}}),u=v.utils.json_to_sheet(B);if(v.utils.book_append_sheet(y,u,"Daily Reports"),h.length>0){const m=h.map(O=>{const[K,$,V]=O.date.split("-");return{Date:`${V}-${$}-${K}`,Vehicle:O.vehicle?.carNumber||"N/A","Border Name":O.borderName,Amount:O.amount,Remarks:O.remarks||""}}),M=v.utils.json_to_sheet(m);v.utils.book_append_sheet(y,M,"Border Tax")}if(n.length>0){const m=n.map(O=>{const K=new Date(O.date);return{Date:`${String(K.getDate()).padStart(2,"0")}-${String(K.getMonth()+1).padStart(2,"0")}-${K.getFullYear()}`,Time:K.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"Car Number":O.carNumber||"N/A",Amount:Number(O.amount)||0,"Bank/Method":O.method||"Not Specified",Remarks:O.remarks||""}}),M=v.utils.json_to_sheet(m);v.utils.book_append_sheet(y,M,"Fastag Recharges")}const D=m=>{if(!m["!ref"])return;const M=v.utils.decode_range(m["!ref"]),O=[];for(let K=M.s.c;K<=M.e.c;++K){let $=10;for(let V=M.s.r;V<=M.e.r;++V){const r=v.utils.encode_cell({r:V,c:K}),W=m[r];if(!W||(W.s={alignment:{horizontal:"center",vertical:"center",wrapText:!0},font:{name:"Arial",sz:10}},V===0&&(W.s.font.bold=!0,W.s.fill={fgColor:{rgb:"E9E9E9"}}),!W.v))continue;const l=W.v.toString();$=Math.max($,l.length+2)}O.push({wch:$})}m["!cols"]=O};Object.values(y.Sheets).forEach(D),v.writeFile(y,`Fleet_Report_${t.name}_${i}_to_${d}.xlsx`)},_=k.filter(v=>v.driver?.name?.toLowerCase().includes(F.toLowerCase())||v.vehicle?.carNumber?.toLowerCase().includes(F.toLowerCase()));return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(ee,{title:"Operational Reports",description:"Detailed daily fleet reports, attendance logs, and expenditure history for your taxi business."}),e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"30px 0",gap:"20px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"45px",height:"45px",background:"white",borderRadius:"12px",padding:"6px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:e.jsx("img",{src:b[t?.name],alt:"Logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"800",color:"white",margin:0,letterSpacing:"-0.5px"},children:"Daily Reports"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"12px"},children:["Operational logs for ",t?.name]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:"-18px",left:"0",fontSize:"9px",fontWeight:"800",color:"var(--text-muted)",textTransform:"uppercase"},children:"From"}),e.jsx("input",{type:"date",value:i,onChange:v=>s(v.target.value),className:"input-field",style:{height:"45px",marginBottom:0,width:"140px",padding:"0 12px"}})]}),e.jsx("span",{style:{color:"rgba(255,255,255,0.2)",marginTop:"4px"},children:"-"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:"-18px",left:"0",fontSize:"9px",fontWeight:"800",color:"var(--text-muted)",textTransform:"uppercase"},children:"To"}),e.jsx("input",{type:"date",value:d,onChange:v=>f(v.target.value),className:"input-field",style:{height:"45px",marginBottom:0,width:"140px",padding:"0 12px"}})]})]}),e.jsxs("button",{onClick:L,className:"btn-primary",style:{height:"45px",padding:"0 20px",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[e.jsx(ft,{size:18})," ",e.jsx("span",{className:"tablet-hide",children:"Export Excel"}),e.jsx("span",{className:"mobile-only",children:"Excel"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"30px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"250px"},children:[e.jsx("input",{type:"text",placeholder:"Search by driver name or car number...",value:F,onChange:v=>U(v.target.value),className:"input-field",style:{width:"100%",paddingLeft:"45px",marginBottom:0,height:"50px"}}),e.jsx(Z,{size:20,style:{position:"absolute",left:"16px",top:"15px",color:"var(--text-muted)"}})]}),e.jsx("button",{className:"glass-card",style:{width:"50px",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",color:"var(--text-muted)",borderRadius:"12px"},children:e.jsx(yt,{size:20})})]}),e.jsx("div",{className:"glass-card",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"1000px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Fleet Personnel"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Vehicle Insight"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Start Duty"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"End Duty"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Base Pay"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Trip Distance"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right"},children:"Details"})]})}),e.jsx("tbody",{children:(()=>{const v=new Set;return A?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{padding:"80px",textAlign:"center"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",color:"var(--text-muted)"},children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Parsing fleet logs..."})]})})}):_.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",style:{padding:"80px",textAlign:"center"},children:[e.jsx("div",{style:{opacity:.2,marginBottom:"15px"},children:e.jsx(Ye,{size:40,style:{margin:"0 auto"}})}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"14px",margin:0},children:"No transaction history found for the selected period."})]})}):_.map(y=>{const w=`${y.driver?._id}_${y.date}`;let B=0;return y.driver&&!v.has(w)&&(B=y.dailyWage||y.driver?.dailyWage||y.vehicle?.dutyAmount||500,v.add(w)),e.jsxs(Y.tr,{initial:{opacity:0},animate:{opacity:1},style:{borderBottom:"1px solid rgba(255,255,255,0.03)",transition:"background 0.2s"},className:"hover-row",children:[e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"38px",height:"38px",borderRadius:"12px",background:"rgba(14, 165, 233, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(jt,{size:18,color:"var(--primary)"})}),e.jsxs("div",{children:[e.jsx("p",{style:{fontWeight:"800",fontSize:"14px",margin:0},children:y.driver?.name||"Unknown"}),e.jsx("p",{style:{fontSize:"11px",color:"var(--text-muted)",margin:"2px 0 0 0"},children:y.driver?.mobile||"N/A"})]})]})}),e.jsxs("td",{style:{padding:"18px 25px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"white",fontWeight:"700",fontSize:"14px"},children:[e.jsx(Q,{size:16,style:{color:"var(--primary)"}}),e.jsx("span",{children:y.vehicle?.carNumber})]}),e.jsx("span",{style:{fontSize:"9px",color:y.vehicle?.isOutsideCar?"#f59e0b":y.driver?.isFreelancer?"#f43f5e":"#10b981",background:y.vehicle?.isOutsideCar?"rgba(245, 158, 11, 0.1)":y.driver?.isFreelancer?"rgba(244, 63, 94, 0.1)":"rgba(16, 185, 129, 0.1)",padding:"3px 8px",borderRadius:"6px",fontWeight:"800",marginTop:"6px",display:"inline-block",textTransform:"uppercase",letterSpacing:"0.4px"},children:y.vehicle?.isOutsideCar?"OUTSIDE":y.driver?.isFreelancer?"FREELANCER":"STAFF"})]}),e.jsxs("td",{style:{padding:"18px 25px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#10b981",fontWeight:"800"},children:[e.jsx(bt,{size:14}),e.jsx("span",{children:new Date(y.punchIn?.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("p",{style:{fontSize:"11px",color:"var(--text-muted)",margin:"4px 0 0 0",fontWeight:"600"},children:[y.punchIn?.km?.toLocaleString()," KM"]})]}),e.jsx("td",{style:{padding:"18px 25px"},children:y.punchOut?.time?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#f43f5e",fontWeight:"800"},children:[e.jsx(vt,{size:14}),e.jsx("span",{children:new Date(y.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("p",{style:{fontSize:"11px",color:"var(--text-muted)",margin:"4px 0 0 0",fontWeight:"600"},children:[y.punchOut.km?.toLocaleString()," KM"]})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(14, 165, 233, 0.1)",color:"var(--primary)",padding:"4px 10px",borderRadius:"6px",fontSize:"10px",fontWeight:"800",width:"fit-content"},children:[e.jsx("div",{className:"pulse-dot"}),"ON DUTY"]})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("span",{style:{color:B>0?"#10b981":"rgba(255,255,255,0.1)",fontWeight:"900",fontSize:"15px"},children:B>0?`â‚¹${B.toLocaleString()}`:"--"})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("span",{style:{fontWeight:"900",fontSize:"18px",color:y.totalKM?"#10b981":"rgba(255,255,255,0.1)",letterSpacing:"-0.5px"},children:y.totalKM?`${y.totalKM.toLocaleString()} KM`:"--"})}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsxs("button",{onClick:()=>z(y),className:"glass-card",style:{padding:"10px 18px",color:"var(--primary)",border:"1px solid rgba(14, 165, 233, 0.1)",display:"inline-flex",alignItems:"center",gap:"8px",fontSize:"12px",fontWeight:"800",textTransform:"uppercase"},children:[e.jsx(St,{size:16})," ",e.jsx("span",{className:"tablet-hide",children:"View Logs"}),e.jsx("span",{className:"mobile-only",children:"Log"})]})})]},y._id)})})()})]})}),e.jsx(ce,{children:P&&e.jsx(Jt,{item:P,onClose:()=>z(null),borderTaxRecords:h})})]})},Gt=()=>{const{selectedCompany:t}=le(),[x,c]=a.useState([]),[i,s]=a.useState([]),[d,f]=a.useState(!0),[b,k]=a.useState(""),[p,n]=a.useState(!1),[C,h]=a.useState(!1),[S,A]=a.useState(!1),[g,P]=a.useState(null),[z,F]=a.useState({name:"",mobile:"",licenseNumber:""}),[U,I]=a.useState({vehicleId:"",km:"",time:new Date().toISOString().slice(0,16)}),[L,_]=a.useState({km:"",time:new Date().toISOString().slice(0,16),fuelAmount:"0",parkingAmount:"0",review:""}),[v,y]=a.useState(!1),[w,B]=a.useState({type:"",text:""});a.useEffect(()=>{t&&(u(),D())},[t]);const u=async()=>{if(t?._id){f(!0);try{const r=JSON.parse(localStorage.getItem("userInfo")),{data:W}=await R.get(`/api/admin/drivers/${t._id}`,{headers:{Authorization:`Bearer ${r.token}`}});c(W.drivers?.filter(l=>l.isFreelancer)||[])}catch(r){console.error(r)}finally{f(!1)}}},D=async()=>{if(t?._id)try{const r=JSON.parse(localStorage.getItem("userInfo")),{data:W}=await R.get(`/api/admin/vehicles/${t._id}?usePagination=false`,{headers:{Authorization:`Bearer ${r.token}`}});s(W.vehicles||[])}catch(r){console.error(r)}},m=async r=>{r.preventDefault(),y(!0);try{const W=JSON.parse(localStorage.getItem("userInfo"));await R.post("/api/admin/drivers",{...z,companyId:t._id,isFreelancer:!0},{headers:{Authorization:`Bearer ${W.token}`}}),B({type:"success",text:"Freelancer added successfully!"}),setTimeout(()=>{n(!1),F({name:"",mobile:"",licenseNumber:""}),B({type:"",text:""}),u()},1e3)}catch(W){B({type:"error",text:W.response?.data?.message||"Failed"})}finally{y(!1)}},M=async r=>{r.preventDefault(),y(!0);try{const W=JSON.parse(localStorage.getItem("userInfo"));await R.post("/api/admin/freelancers/punch-in",{...U,driverId:g._id},{headers:{Authorization:`Bearer ${W.token}`}}),h(!1),I({vehicleId:"",km:"",time:new Date().toISOString().slice(0,16)}),u(),D()}catch(W){alert(W.response?.data?.message||"Error")}finally{y(!1)}},O=async r=>{r.preventDefault(),y(!0);try{const W=JSON.parse(localStorage.getItem("userInfo"));await R.post("/api/admin/freelancers/punch-out",{...L,driverId:g._id},{headers:{Authorization:`Bearer ${W.token}`}}),A(!1),_({km:"",time:new Date().toISOString().slice(0,16),fuelAmount:"0",parkingAmount:"0",review:""}),u(),D()}catch(W){alert(W.response?.data?.message||"Error")}finally{y(!1)}},K=async r=>{if(window.confirm("Delete this freelancer?"))try{const W=JSON.parse(localStorage.getItem("userInfo"));await R.delete(`/api/admin/drivers/${r}`,{headers:{Authorization:`Bearer ${W.token}`}}),u()}catch{alert("Error deleting")}},$=x.filter(r=>r.tripStatus==="active"),V=x.filter(r=>r.tripStatus!=="active").filter(r=>r.name?.toLowerCase().includes(b.toLowerCase())||r.mobile?.includes(b)||r.licenseNumber?.toLowerCase().includes(b.toLowerCase()));return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(ee,{title:"Freelancer Fleet Network",description:"Onboard and manage freelance drivers for temporary duties and peak demand management."}),e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"24px 0",gap:"15px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{minWidth:"200px"},children:[e.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"800",margin:0,letterSpacing:"-0.5px"},children:"Freelancer Net"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"13px"},children:"External personnel management"})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",flex:"1",justifyContent:"flex-end",flexWrap:"wrap",width:"100%",minWidth:"300px"},children:[e.jsxs("div",{style:{position:"relative",flex:"1",maxWidth:"300px",minWidth:"180px"},children:[e.jsx("input",{type:"text",placeholder:"Quick find...",value:b,onChange:r=>k(r.target.value),className:"input-field",style:{paddingLeft:"40px",marginBottom:0,height:"42px",fontSize:"14px"}}),e.jsx(Z,{size:16,style:{position:"absolute",left:"14px",top:"13px",color:"var(--text-muted)"}})]}),e.jsxs("button",{onClick:()=>n(!0),className:"btn-primary",style:{display:"flex",alignItems:"center",gap:"8px",height:"42px",padding:"0 16px",fontSize:"14px"},children:[e.jsx(G,{size:18})," ",e.jsx("span",{children:"Add Freelancer"})]})]})]}),$.length>0&&e.jsxs("div",{style:{marginBottom:"40px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#f43f5e",boxShadow:"0 0 10px #f43f5e"}}),e.jsxs("h2",{style:{color:"white",fontSize:"16px",fontWeight:"800",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Currently On Duty (",$.length,")"]})]}),e.jsx("div",{className:"glass-card",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(244, 63, 94, 0.2)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"700px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(244, 63, 94, 0.05)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Driver"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Contact"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Assigned Vehicle"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Start Odo"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right"},children:"Action"})]})}),e.jsx("tbody",{children:$.map(r=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"18px 25px",fontWeight:"700",fontSize:"15px"},children:r.name}),e.jsx("td",{style:{padding:"18px 25px",fontSize:"14px"},children:r.mobile}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{color:"var(--primary)",fontWeight:"800",fontSize:"14px"},children:r.assignedVehicle?.carNumber})}),e.jsxs("td",{style:{padding:"18px 25px",fontSize:"14px",color:"var(--text-muted)"},children:[r.activeAttendance?.punchIn?.km||"-"," KM"]}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsx("button",{onClick:()=>{P(r),A(!0)},className:"btn-primary",style:{background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",border:"1px solid rgba(244, 63, 94, 0.1)",padding:"8px 16px",fontSize:"12px",fontWeight:"800",textTransform:"uppercase"},children:"Punch Out"})})]},r._id))})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#10b981"}}),e.jsxs("h2",{style:{color:"white",fontSize:"16px",fontWeight:"800",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:["Available Freelancers (",V.length,")"]})]}),e.jsx("div",{className:"glass-card",style:{padding:"0",overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"700px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Name"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Mobile"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"License"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:d?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",style:{textAlign:"center",padding:"60px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",color:"var(--text-muted)"},children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Syncing available records..."})]})})}):V.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"4",style:{textAlign:"center",padding:"60px",color:"var(--text-muted)"},children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.02)",width:"60px",height:"60px",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto 15px"},children:e.jsx(Z,{size:22,style:{opacity:.3}})}),e.jsx("p",{style:{fontSize:"14px",margin:0},children:"No available freelancers found."})]})}):V.map(r=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)"},children:[e.jsx("td",{style:{padding:"18px 25px",fontWeight:"700",fontSize:"15px"},children:r.name}),e.jsx("td",{style:{padding:"18px 25px",fontSize:"14px"},children:r.mobile}),e.jsx("td",{style:{padding:"18px 25px",fontSize:"13px",color:"var(--text-muted)"},children:r.licenseNumber||"Not Provided"}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{P(r),h(!0)},className:"btn-primary",style:{background:"rgba(16, 185, 129, 0.1)",color:"#10b981",border:"1px solid rgba(16, 185, 129, 0.1)",padding:"8px 16px",fontSize:"12px",fontWeight:"800",textTransform:"uppercase"},children:"Assign Duty"}),e.jsx("button",{onClick:()=>K(r._id),style:{color:"#f43f5e",background:"rgba(244, 63, 94, 0.05)",padding:"8px",borderRadius:"8px",border:"1px solid rgba(244, 63, 94, 0.1)"},children:e.jsx(me,{size:16})})]})})]},r._id))})]})})]}),e.jsxs(ce,{children:[p&&e.jsx(Re,{title:"Add New Freelancer",onClose:()=>n(!1),children:e.jsxs("form",{onSubmit:m,style:{display:"grid",gap:"20px"},children:[e.jsx(re,{label:"Full Name *",value:z.name,onChange:r=>F({...z,name:r}),required:!0}),e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsx(re,{label:"Mobile Number *",value:z.mobile,onChange:r=>F({...z,mobile:r}),required:!0}),e.jsx(re,{label:"License Number",value:z.licenseNumber,onChange:r=>F({...z,licenseNumber:r})})]}),e.jsx(Pe,{disabled:v,text:"Register Freelancer",message:w})]})}),C&&e.jsx(Re,{title:`Assign Duty: ${g?.name}`,onClose:()=>h(!1),children:e.jsxs("form",{onSubmit:M,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Select Vehicle *"}),e.jsxs("select",{className:"input-field",required:!0,value:U.vehicleId,onChange:r=>I({...U,vehicleId:r.target.value}),style:{height:"45px"},children:[e.jsx("option",{value:"",children:"Choose available vehicle..."}),i.filter(r=>!r.currentDriver).map(r=>e.jsxs("option",{value:r._id,style:{background:"#0f172a"},children:[r.carNumber," - ",r.model]},r._id))]})]}),e.jsx(re,{label:"Starting KM *",type:"number",value:U.km,onChange:r=>I({...U,km:r}),required:!0}),e.jsx(re,{label:"Assignment Time",type:"datetime-local",value:U.time,onChange:r=>I({...U,time:r})}),e.jsx(Pe,{disabled:v,text:"Start Duty"})]})}),S&&e.jsx(Re,{title:`Duty Completion: ${g?.name}`,onClose:()=>A(!1),children:e.jsxs("form",{onSubmit:O,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsx(re,{label:"Closing KM *",type:"number",value:L.km,onChange:r=>_({...L,km:r}),required:!0}),e.jsx(re,{label:"Completion Time",type:"datetime-local",value:L.time,onChange:r=>_({...L,time:r})})]}),e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsx(re,{label:"Fuel Spent (â‚¹)",type:"number",value:L.fuelAmount,onChange:r=>_({...L,fuelAmount:r})}),e.jsx(re,{label:"Parking/Toll (â‚¹)",type:"number",value:L.parkingAmount,onChange:r=>_({...L,parkingAmount:r})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Admin Remarks / Performance Review"}),e.jsx("textarea",{className:"input-field",style:{height:"80px",paddingTop:"12px"},placeholder:"Note any issues or positive feedback...",value:L.review,onChange:r=>_({...L,review:r.target.value})})]}),e.jsx(Pe,{disabled:v,text:"Finish Duty & Release Vehicle"})]})})]})]})},Re=({title:t,onClose:x,children:c})=>e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center",padding:"15px"},children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"glass-card modal-content",style:{width:"100%",maxWidth:"550px",padding:"25px",maxHeight:"95vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",margin:0,fontWeight:"800"},children:t}),e.jsx("button",{onClick:x,style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(ne,{size:20})})]}),c]})}),re=({label:t,value:x,onChange:c,type:i="text",required:s=!1})=>e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:t}),e.jsx("input",{type:i,className:"input-field",required:s,value:x,onChange:d=>c(d.target.value)})]}),Pe=({disabled:t,text:x,message:c})=>e.jsxs("div",{style:{marginTop:"10px"},children:[c?.text&&e.jsxs("div",{style:{padding:"12px",borderRadius:"12px",fontSize:"14px",marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px",background:c.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)",color:c.type==="success"?"#10b981":"#f43f5e",border:`1px solid ${c.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)"}`},children:[c.type==="success"?e.jsx(Ce,{size:18}):e.jsx(be,{size:18}),c.text]}),e.jsx("button",{type:"submit",disabled:t,className:"btn-primary",style:{width:"100%",padding:"15px",fontWeight:"800",textTransform:"uppercase"},children:t?"Processing...":x})]}),Qt=()=>{const{selectedCompany:t}=le(),[x,c]=a.useState([]),[i,s]=a.useState(!0),[d,f]=a.useState(""),[b,k]=a.useState(!1),[p,n]=a.useState({carNumber:"",model:"",driverName:"",dutyType:"",ownerName:"",dutyAmount:""});a.useEffect(()=>{t&&C()},[t]);const C=async()=>{if(t?._id){s(!0);try{const g=JSON.parse(localStorage.getItem("userInfo")),{data:P}=await R.get(`/api/admin/vehicles/${t._id}`,{headers:{Authorization:`Bearer ${g.token}`}});c(P.vehicles?.filter(z=>z.isOutsideCar)||[])}catch(g){console.error(g)}finally{s(!1)}}},h=async g=>{if(window.confirm("Delete this outside car?"))try{await R.delete(`/api/admin/vehicles/${g}`,{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("userInfo")).token}`}}),C()}catch{alert("Error deleting")}},S=async g=>{g.preventDefault();try{const P=JSON.parse(localStorage.getItem("userInfo")),z=new FormData;z.append("carNumber",p.carNumber),z.append("model",p.model),z.append("driverName",p.driverName),z.append("dutyType",p.dutyType),z.append("ownerName",p.ownerName),z.append("dutyAmount",p.dutyAmount),z.append("companyId",t._id),z.append("isOutsideCar","true"),z.append("permitType","Contract"),z.append("carType","Other"),await R.post("/api/admin/vehicles",z,{headers:{Authorization:`Bearer ${P.token}`,"Content-Type":"multipart/form-data"}}),k(!1),n({carNumber:"",model:"",driverName:"",dutyType:"",ownerName:"",dutyAmount:""}),C()}catch(P){alert(P.response?.data?.message||"Error adding vehicle")}},A=x.filter(g=>g.carNumber?.toLowerCase().includes(d.toLowerCase())||g.model?.toLowerCase().includes(d.toLowerCase())||g.ownerName?.toLowerCase().includes(d.toLowerCase())||g.driverName?.toLowerCase().includes(d.toLowerCase()));return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(ee,{title:"Outside Fleet Management",description:"Manage external vehicles and freelancer drivers for specific duties and trips."}),e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"24px 0",gap:"15px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{minWidth:"200px"},children:[e.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"800",margin:0,letterSpacing:"-0.5px"},children:"Outside Fleet"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"13px"},children:"External vehicle management"})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",flex:"1",justifyContent:"flex-end",flexWrap:"wrap",width:"100%",minWidth:"300px"},children:[e.jsxs("div",{style:{position:"relative",flex:"1",maxWidth:"300px",minWidth:"180px"},children:[e.jsx("input",{type:"text",placeholder:"Quick find...",value:d,onChange:g=>f(g.target.value),className:"input-field",style:{paddingLeft:"40px",marginBottom:0,height:"42px",fontSize:"14px"}}),e.jsx(Z,{size:16,style:{position:"absolute",left:"14px",top:"13px",color:"var(--text-muted)"}})]}),e.jsxs("button",{onClick:()=>k(!0),className:"btn-primary",style:{display:"flex",alignItems:"center",gap:"8px",height:"42px",padding:"0 16px",fontSize:"14px"},children:[e.jsx(G,{size:18})," ",e.jsx("span",{children:"Add Car"})]})]})]}),e.jsx("div",{className:"glass-card",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"850px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Vehicle No"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Model / Type"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Driver Details"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Assignment"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Proprietor"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Net Pay"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Action"})]})}),e.jsx("tbody",{children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{textAlign:"center",padding:"60px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",color:"var(--text-muted)"},children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Syncing external fleet..."})]})})}):A.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",style:{padding:"80px",textAlign:"center"},children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.02)",width:"70px",height:"70px",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto 20px"},children:e.jsx(Q,{size:30,style:{color:"var(--text-muted)",opacity:.3}})}),e.jsx("h3",{style:{color:"white",margin:"0 0 10px 0",fontSize:"18px"},children:"No outside cars listed"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"14px",maxWidth:"350px",margin:"0 auto"},children:"External vehicles managed for specific duties will appear here once added."})]})}):A.map(g=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)",transition:"background 0.2s"},className:"hover-row",children:[e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{fontWeight:"800",fontSize:"15px",color:"white"},children:g.carNumber})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"white"},children:g.model})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"white"},children:g.driverName||"N/A"})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("span",{style:{fontSize:"11px",background:"rgba(14, 165, 233, 0.1)",color:"var(--primary)",padding:"4px 10px",borderRadius:"6px",fontWeight:"700",textTransform:"uppercase"},children:g.dutyType||"Standard"})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("div",{style:{fontSize:"14px",color:"var(--text-muted)"},children:g.ownerName||"Unknown"})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{fontWeight:"800",color:"#10b981",fontSize:"15px"},children:["â‚¹",g.dutyAmount?.toLocaleString("en-IN")||"0"]})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsx("button",{onClick:()=>h(g._id),style:{background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",padding:"8px",borderRadius:"8px",border:"1px solid rgba(244, 63, 94, 0.1)"},title:"Remove Record",children:e.jsx(me,{size:16})})})]},g._id))})]})}),e.jsx(ce,{children:b&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center",padding:"15px"},children:e.jsxs(Y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"glass-card modal-content",style:{width:"100%",maxWidth:"550px",padding:"25px",maxHeight:"95vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",margin:0,fontWeight:"800"},children:"Register Outside Car"}),e.jsx("button",{onClick:()=>k(!1),style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"8px",borderRadius:"50%"},children:e.jsx(ne,{size:20})})]}),e.jsxs("form",{onSubmit:S,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Vehicle Number *"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"DL XX XX XXXX",required:!0,value:p.carNumber,onChange:g=>n({...p,carNumber:g.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Car Name / Model *"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"e.g. Innova / Dzire",required:!0,value:p.model,onChange:g=>n({...p,model:g.target.value})})]})]}),e.jsxs("div",{className:"modal-grid-2",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Operator / Driver *"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Driver's Full Name",required:!0,value:p.driverName,onChange:g=>n({...p,driverName:g.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Service Category *"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"e.g. Local / Airport / Rental",required:!0,value:p.dutyType,onChange:g=>n({...p,dutyType:g.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Owner / Agency Name *"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Name of Proprietor or Fleet Provider",required:!0,value:p.ownerName,onChange:g=>n({...p,ownerName:g.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",display:"block"},children:"Settlement Amount (Rate)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"Punctuation-free amount",value:p.dutyAmount,onChange:g=>n({...p,dutyAmount:g.target.value})})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"10px"},children:[e.jsx("button",{type:"button",className:"glass-card",style:{flex:1,padding:"14px",color:"white",fontWeight:"700"},onClick:()=>k(!1),children:"Discard"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,padding:"14px"},children:"Confirm Registration"})]})]})]})})})]})},Zt=()=>{const{selectedCompany:t}=le(),[x,c]=a.useState([]),[i,s]=a.useState(!0),[d,f]=a.useState(""),[b,k]=a.useState(!1),[p,n]=a.useState(null),[C,h]=a.useState({amount:"",method:"",remarks:""}),[S,A]=a.useState(!1),[g,P]=a.useState({type:"",text:""});a.useEffect(()=>{t&&z()},[t]);const z=async()=>{if(t?._id){s(!0);try{const I=JSON.parse(localStorage.getItem("userInfo")),{data:L}=await R.get(`/api/admin/vehicles/${t._id}`,{headers:{Authorization:`Bearer ${I.token}`}});c(L.vehicles||[])}catch(I){console.error(I)}finally{s(!1)}}},F=async I=>{I.preventDefault(),A(!0),P({type:"",text:""});try{const L=JSON.parse(localStorage.getItem("userInfo"));await R.post(`/api/admin/vehicles/${p._id}/fastag-recharge`,C,{headers:{Authorization:`Bearer ${L.token}`}}),P({type:"success",text:"Recharge successful!"}),setTimeout(()=>{k(!1),h({amount:"",method:"",remarks:""}),P({type:"",text:""}),z()},1e3)}catch(L){P({type:"error",text:L.response?.data?.message||"Failed to recharge"})}finally{A(!1)}},U=x.filter(I=>I.carNumber?.toLowerCase().includes(d.toLowerCase())||I.fastagNumber?.toLowerCase().includes(d.toLowerCase()));return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(ee,{title:"Fastag Wallet & Tracking",description:"Monitor and recharge Fastag balances for your entire taxi fleet. Stay operational without toll delays."}),e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"30px 0",flexWrap:"wrap",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{color:"white",fontSize:"28px",margin:0,fontWeight:"800",letterSpacing:"-0.5px"},children:"Fastag Management"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:"4px 0 0 0",fontSize:"14px"},children:["Tracking and recharging operational balances for ",t?.name]})]}),e.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"350px",minWidth:"250px"},children:[e.jsx(Z,{size:18,style:{position:"absolute",left:"12px",top:"15px",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by car or fastag...",value:d,onChange:I=>f(I.target.value),className:"input-field",style:{paddingLeft:"40px",width:"100%",marginBottom:0,height:"48px"}})]})]}),e.jsx("div",{className:"glass-card",style:{padding:"0",overflowX:"auto",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"900px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Vehicle Identification"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Internal Fastag No."}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Fleet Credit"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Operational Status"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right"},children:"Management"})]})}),e.jsx("tbody",{children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",style:{textAlign:"center",padding:"80px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",color:"var(--text-muted)"},children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Syncing vehicle data..."})]})})}):U.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",style:{textAlign:"center",padding:"80px",color:"var(--text-muted)"},children:[e.jsx(Ve,{size:40,style:{margin:"0 auto 15px",opacity:.2}}),e.jsx("p",{style:{margin:0,fontSize:"14px"},children:"No vehicle records with fastag configuration found."})]})}):U.map(I=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.03)",transition:"background 0.3s"},className:"hover-row",children:[e.jsx("td",{style:{padding:"18px 25px",fontWeight:"800",fontSize:"15px"},children:I.carNumber}),e.jsx("td",{style:{padding:"18px 25px",fontSize:"14px"},children:I.fastagNumber||e.jsx("span",{style:{color:"rgba(255,255,255,0.2)"},children:"Unconfigured"})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{className:"pulse-dot",style:{background:(I.fastagBalance||0)<200?"#f43f5e":"#10b981",boxShadow:`0 0 10px ${(I.fastagBalance||0)<200?"#f43f5e":"#10b981"}`}}),e.jsxs("span",{style:{fontSize:"18px",fontWeight:"900",letterSpacing:"-0.5px"},children:["â‚¹ ",I.fastagBalance?.toLocaleString()||0]})]})}),e.jsx("td",{style:{padding:"18px 25px"},children:(I.fastagBalance||0)<200?e.jsx("span",{style:{color:"#f43f5e",fontSize:"10px",fontWeight:"900",background:"rgba(244, 63, 94, 0.1)",padding:"5px 12px",borderRadius:"8px",border:"1px solid rgba(244, 63, 94, 0.2)",textTransform:"uppercase"},children:"Low Credit"}):e.jsx("span",{style:{color:"#10b981",fontSize:"10px",fontWeight:"900",background:"rgba(16, 185, 129, 0.1)",padding:"5px 12px",borderRadius:"8px",border:"1px solid rgba(16, 185, 129, 0.2)",textTransform:"uppercase"},children:"Operational"})}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsxs("button",{onClick:()=>{n(I),k(!0)},className:"btn-primary",style:{padding:"8px 16px",fontSize:"12px",borderRadius:"10px",fontWeight:"800"},children:[e.jsx(G,{size:16})," ",e.jsx("span",{className:"mobile-hide",children:"Top Up"})]})})]},I._id))})]})}),e.jsx(ce,{children:b&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(10px)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:e.jsxs(Y.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass-card",style:{width:"100%",maxWidth:"450px",padding:"30px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"25px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",margin:0,fontWeight:"700"},children:"Fastag Recharge"}),e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"14px",margin:"5px 0 0 0"},children:["Vehicle: ",p?.carNumber]})]}),e.jsx("button",{onClick:()=>k(!1),style:{color:"var(--text-muted)",background:"none"},children:e.jsx(ne,{})})]}),e.jsxs("form",{onSubmit:F,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Recharge Amount (â‚¹)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"Enter amount",required:!0,autoFocus:!0,value:C.amount,onChange:I=>h({...C,amount:I.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Payment Method / Bank"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"e.g. ICICI Bank, Paytm, UPI",value:C.method,onChange:I=>h({...C,method:I.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Remarks (Optional)"}),e.jsx("textarea",{className:"input-field",placeholder:"Add any notes...",rows:"2",value:C.remarks,onChange:I=>h({...C,remarks:I.target.value}),style:{resize:"none"}})]}),g.text&&e.jsxs("div",{style:{padding:"12px",borderRadius:"10px",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",background:g.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)",color:g.type==="success"?"#10b981":"#f43f5e",border:`1px solid ${g.type==="success"?"rgba(16, 185, 129, 0.2)":"rgba(244, 63, 94, 0.2)"}`},children:[g.type==="success"?e.jsx(Ce,{size:16}):e.jsx(be,{size:16}),g.text]}),e.jsx("button",{type:"submit",disabled:S,className:"btn-primary",style:{padding:"15px",fontWeight:"700"},children:S?"Processing...":"Add Payment"})]})]})})})]})},ea=()=>{const{selectedCompany:t}=le(),[x,c]=a.useState([]),[i,s]=a.useState([]),[d,f]=a.useState({vehicleId:"",borderName:"",amount:"",date:new Date().toISOString().split("T")[0],remarks:"",driverId:""}),[b,k]=a.useState(null),[p,n]=a.useState(null),[C,h]=a.useState([]),[S,A]=a.useState(!1),[g,P]=a.useState(!1),[z,F]=a.useState({type:"",text:""}),[U,I]=a.useState("");a.useEffect(()=>{t&&(L(),_())},[t]);const L=async()=>{try{const u=JSON.parse(localStorage.getItem("userInfo")).token,D=await R.get(`/api/admin/vehicles/${t._id}`,{headers:{Authorization:`Bearer ${u}`}}),m=await R.get(`/api/admin/drivers/${t._id}`,{headers:{Authorization:`Bearer ${u}`}});c(D.data.vehicles||[]),s(m.data.drivers||[])}catch(u){console.error("Error fetching data",u)}},_=async()=>{A(!0);try{const u=JSON.parse(localStorage.getItem("userInfo")).token,{data:D}=await R.get(`/api/admin/border-tax/${t._id}`,{headers:{Authorization:`Bearer ${u}`}});h(D)}catch(u){console.error("Error fetching border tax entries",u)}finally{A(!1)}},v=u=>{const D=u.target.files[0];D&&(k(D),n(URL.createObjectURL(D)))},y=async u=>{u.preventDefault(),P(!0),F({type:"",text:""});try{const D=JSON.parse(localStorage.getItem("userInfo")).token,m=new FormData;Object.keys(d).forEach(M=>m.append(M,d[M])),m.append("companyId",t._id),b&&m.append("receiptPhoto",b),await R.post("/api/admin/border-tax",m,{headers:{Authorization:`Bearer ${D}`,"Content-Type":"multipart/form-data"}}),F({type:"success",text:"Border Tax recorded successfully!"}),f({vehicleId:"",borderName:"",amount:"",date:new Date().toISOString().split("T")[0],remarks:""}),k(null),n(null),_()}catch(D){F({type:"error",text:D.response?.data?.message||"Failed to record entry"})}finally{P(!1)}},w=async u=>{if(window.confirm("Are you sure you want to delete this entry?"))try{const D=JSON.parse(localStorage.getItem("userInfo")).token;await R.delete(`/api/admin/border-tax/${u}`,{headers:{Authorization:`Bearer ${D}`}}),F({type:"success",text:"Entry deleted successfully"}),_()}catch{F({type:"error",text:"Failed to delete entry"})}},B=C.filter(u=>u.borderName.toLowerCase().includes(U.toLowerCase())||u.vehicle?.carNumber.toLowerCase().includes(U.toLowerCase()));return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(ee,{title:"Border Tax Records",description:"Maintain accurate records of border crossing taxes and receipts for all fleet vehicles."}),e.jsxs("header",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"30px 0",marginBottom:"10px"},children:[e.jsx("h1",{style:{fontSize:"28px",fontWeight:"800",color:"white",margin:0,letterSpacing:"-0.5px"},children:"Border Tax Management"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"14px"},children:["Record and manage border crossing expenses for ",t?.name]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"30px",alignItems:"start"},children:[e.jsxs(Y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"glass-card",style:{padding:"30px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("h2",{style:{color:"white",fontSize:"18px",fontWeight:"700",marginBottom:"25px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ke,{size:20,color:"var(--primary)"}),"Record New Entry"]}),e.jsxs("form",{onSubmit:y,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Select Vehicle"}),e.jsxs("select",{className:"input-field",required:!0,value:d.vehicleId,onChange:u=>f({...d,vehicleId:u.target.value}),children:[e.jsx("option",{value:"",children:"Select Car"}),x.map(u=>e.jsx("option",{value:u._id,children:u.carNumber},u._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Border Crossed"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"e.g. Delhi-UP Border",required:!0,value:d.borderName,onChange:u=>f({...d,borderName:u.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Select Driver (Optional)"}),e.jsxs("select",{className:"input-field",value:d.driverId,onChange:u=>f({...d,driverId:u.target.value}),children:[e.jsx("option",{value:"",children:"Select Driver"}),i.map(u=>e.jsx("option",{value:u._id,children:u.name},u._id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Amount (â‚¹)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"Amount",required:!0,value:d.amount,onChange:u=>f({...d,amount:u.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Date"}),e.jsx("input",{type:"date",className:"input-field",required:!0,value:d.date,onChange:u=>f({...d,date:u.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Remarks / Notes (Optional)"}),e.jsx("textarea",{className:"input-field",style:{height:"70px",paddingTop:"10px"},placeholder:"Any additional information...",value:d.remarks,onChange:u=>f({...d,remarks:u.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"var(--text-muted)",fontSize:"12px",display:"block",marginBottom:"8px"},children:"Receipt Photo (Optional)"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:"file",accept:"image/*",onChange:v,style:{position:"absolute",inset:0,opacity:0,cursor:"pointer",zIndex:2}}),e.jsx("div",{style:{border:"2px dashed rgba(255,255,255,0.1)",borderRadius:"12px",padding:"20px",textAlign:"center",background:"rgba(255,255,255,0.02)"},children:p?e.jsx("img",{src:p,style:{height:"80px",borderRadius:"8px",margin:"0 auto"}}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{size:24,color:"var(--primary)",style:{margin:"0 auto 10px"}}),e.jsx("p",{style:{color:"white",fontSize:"13px"},children:"Click to upload receipt"})]})})]})]}),z.text&&e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",background:z.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(244, 63, 94, 0.1)",color:z.type==="success"?"#10b981":"#f43f5e"},children:[z.type==="success"?e.jsx(Ce,{size:16}):e.jsx(be,{size:16}),z.text]}),e.jsx("button",{type:"submit",disabled:g,className:"btn-primary",style:{width:"100%",padding:"15px"},children:g?"Recording...":"Record Border Tax Entry"})]})]}),e.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card",style:{padding:"25px",border:"1px solid rgba(255,255,255,0.05)",minHeight:"600px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",flexWrap:"wrap",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",fontWeight:"800",margin:0},children:"Recent Entries"}),e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"13px",marginTop:"4px"},children:["Last ",B.length," operational records"]})]}),e.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"350px",minWidth:"200px"},children:[e.jsx(Z,{size:18,style:{position:"absolute",left:"12px",top:"15px",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search border or car...",className:"input-field",value:U,onChange:u=>I(u.target.value),style:{paddingLeft:"40px",width:"100%",height:"48px",fontSize:"14px",marginBottom:0}})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:S?e.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"100px 0"},children:[e.jsx("div",{className:"spinner",style:{margin:"0 auto 20px"}}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"Fetching records..."})]}):B.length===0?e.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"100px 0",background:"rgba(255,255,255,0.01)",borderRadius:"20px",border:"1px dashed rgba(255,255,255,0.05)"},children:[e.jsx(ke,{size:64,style:{opacity:.1,margin:"0 auto 20px",color:"var(--primary)"}}),e.jsx("h3",{style:{color:"white",fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:"No records found"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"14px"},children:"Try adjusting your search or add a new entry."})]}):B.map(u=>e.jsxs(Y.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"glass-card",style:{padding:"20px",background:"linear-gradient(145deg, rgba(30, 41, 59, 0.4), rgba(15, 23, 42, 0.4))",border:"1px solid rgba(255,255,255,0.08)",transition:"transform 0.2s ease",cursor:"default"},whileHover:{transform:"translateY(-4px)",borderColor:"rgba(14, 165, 233, 0.3)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{background:"rgba(14, 165, 233, 0.15)",color:"var(--primary)",padding:"4px 10px",borderRadius:"6px",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"0.5px"},children:u.vehicle?.carNumber||"N/A"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"8px"},children:[e.jsx(Ye,{size:13,color:"var(--text-muted)"}),e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"12px",fontWeight:"500"},children:new Date(u.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]})]}),u.receiptPhoto?e.jsxs("a",{href:u.receiptPhoto,target:"_blank",rel:"noreferrer",style:{position:"relative",display:"block"},children:[e.jsx("img",{src:u.receiptPhoto,alt:"Receipt",style:{width:"60px",height:"60px",borderRadius:"10px",objectFit:"cover",border:"2px solid rgba(255,255,255,0.1)",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},onError:D=>{D.target.src="https://via.placeholder.com/60?text=Err"}}),e.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"10px",opacity:0,transition:"opacity 0.2s"},className:"img-overlay",children:e.jsx(Z,{size:14,color:"white"})})]}):e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"10px",background:"rgba(255,255,255,0.03)",border:"1px dashed rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Me,{size:18,style:{opacity:.2}})})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{color:"white",fontWeight:"700",fontSize:"16px",marginBottom:"6px",letterSpacing:"-0.2px"},children:u.borderName}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[e.jsxs("div",{children:[u.remarks&&e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"12px",margin:0,fontStyle:"italic",maxWidth:"180px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:['"',u.remarks,'"']}),e.jsxs("p",{style:{color:"rgba(255,255,255,0.4)",fontSize:"11px",marginTop:"4px"},children:["ID: ",u._id.toString().slice(-6).toUpperCase()]})]}),e.jsxs("p",{style:{color:"#10b981",fontWeight:"900",fontSize:"22px",margin:0,letterSpacing:"-1px"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:"600",verticalAlign:"middle",marginRight:"2px"},children:"â‚¹"}),u.amount.toLocaleString("en-IN")]})]}),e.jsx("button",{onClick:()=>w(u._id),style:{marginTop:"15px",color:"#f43f5e",fontSize:"11px",display:"flex",alignItems:"center",gap:"4px",opacity:.5,background:"none",border:"none",cursor:"pointer"},onMouseEnter:D=>D.target.style.opacity=1,onMouseLeave:D=>D.target.style.opacity=.5,children:"Delete Record"})]})]},u._id))})]})]})]})},ta=({isOpen:t,onClose:x})=>{const{logout:c,user:i}=ze(),{companies:s,selectedCompany:d,setSelectedCompany:f}=le(),b=[{path:"/admin",icon:Ct,label:"Dashboard"},{path:"/admin/drivers",icon:Ne,label:"Drivers"},{path:"/admin/freelancers",icon:Ne,label:"Freelancers"},{path:"/admin/vehicles",icon:Q,label:"Vehicles"},{path:"/admin/outside-cars",icon:Q,label:"Outside Cars"},{path:"/admin/border-tax",icon:ke,label:"Border Tax"},{path:"/admin/fastag",icon:$e,label:"Fastag"},{path:"/admin/reports",icon:$e,label:"Daily Reports"}],k={YatreeDestination:"/logos/YD.Logo.webp",GoGetGo:"/logos/gogetgo.webp"};return e.jsxs("div",{className:"sidebar",style:{width:"280px",height:"100vh",position:"fixed",left:t?"0":"-280px",top:0,padding:"30px 20px",display:"flex",flexDirection:"column",borderRight:"1px solid var(--border)",background:"var(--bg-dark)",backdropFilter:"blur(20px)",zIndex:100,transition:"left 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:t?"20px 0 50px rgba(0,0,0,0.5)":"none"},children:[e.jsx("style",{children:`
                    @media (min-width: 1025px) {
                        .sidebar {
                            left: 0 !important;
                            box-shadow: none !important;
                        }
                    }
                `}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[e.jsxs("div",{style:{padding:"0 10px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",background:"white",borderRadius:"8px",padding:"4px",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:e.jsx("img",{src:k[d?.name]||"/vite.svg",alt:"Logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"800",color:"white",letterSpacing:"-0.5px",margin:0},children:"FleetCRM"}),e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",margin:0},children:"Professional Edition"})]})]}),e.jsx("button",{onClick:x,className:"mobile-only",style:{background:"none",color:"var(--text-muted)"},children:e.jsx(wt,{style:{transform:"rotate(180deg)"}})})]}),e.jsxs("div",{style:{marginBottom:"35px",padding:"0 5px"},children:[e.jsx("label",{style:{fontSize:"11px",fontWeight:"700",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"1px",marginBottom:"10px",display:"block"},children:"Active Company"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("select",{value:d?._id||"",onChange:p=>{f(s.find(n=>n._id===p.target.value)),window.innerWidth<1025&&x()},style:{width:"100%",appearance:"none",background:"rgba(255,255,255,0.05)",border:"1px solid var(--border)",borderRadius:"12px",padding:"12px 15px 12px 40px",color:"white",fontSize:"14px",fontWeight:"600",cursor:"pointer",outline:"none"},children:s.map(p=>e.jsx("option",{value:p._id,style:{background:"#1e293b"},children:p.name},p._id))}),k[d?.name]?e.jsx("div",{style:{position:"absolute",left:"12px",top:"12px",width:"20px",height:"20px",background:"white",borderRadius:"4px",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("img",{src:k[d?.name],style:{width:"80%",height:"80%",objectFit:"contain"}})}):e.jsx(Nt,{size:16,style:{position:"absolute",left:"15px",top:"15px",color:"var(--primary)"}}),e.jsx(kt,{size:16,style:{position:"absolute",right:"15px",top:"15px",color:"var(--text-muted)",pointerEvents:"none"}})]})]}),e.jsx("nav",{style:{flex:1,overflowY:"auto",paddingRight:"5px"},className:"sidebar-nav-scroll",children:b.map(p=>e.jsxs(zt,{to:p.path,end:p.path==="/admin",onClick:()=>{window.innerWidth<1025&&x()},style:({isActive:n})=>({display:"flex",alignItems:"center",gap:"12px",padding:"12px 14px",borderRadius:"12px",marginBottom:"6px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",background:n?"rgba(14, 165, 233, 0.12)":"transparent",color:n?"var(--primary)":"var(--text-muted)",border:n?"1px solid rgba(14, 165, 233, 0.25)":"1px solid transparent"}),children:[e.jsx(p.icon,{size:20}),e.jsx("span",{style:{fontWeight:"600",fontSize:"15px"},children:p.label})]},p.path))}),e.jsxs("div",{style:{marginTop:"auto",borderTop:"1px solid var(--border)",paddingTop:"20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px",padding:"10px",background:"rgba(255,255,255,0.03)",borderRadius:"16px"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"12px",background:"linear-gradient(135deg, #0ea5e9, #6366f1)",display:"flex",justifyContent:"center",alignItems:"center",color:"white",fontWeight:"800",fontSize:"18px",boxShadow:"0 4px 12px rgba(14, 165, 233, 0.3)"},children:i.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"15px",fontWeight:"700",color:"white"},children:i.name}),e.jsx("p",{style:{fontSize:"12px",color:"var(--text-muted)",fontWeight:"500"},children:i.role})]})]}),e.jsxs("button",{onClick:c,style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 14px",width:"100%",borderRadius:"12px",color:"#f43f5e",background:"rgba(244, 63, 94, 0.08)",border:"1px solid rgba(244, 63, 94, 0.15)",transition:"all 0.3s ease",cursor:"pointer"},children:[e.jsx(He,{size:20}),e.jsx("span",{style:{fontWeight:"700",fontSize:"15px"},children:"Logout"})]})]})]})},Ue=({children:t,role:x})=>{const{user:c,loading:i}=ze();return i?e.jsx("div",{style:{color:"white",padding:"20px"},children:"Loading..."}):c?x&&c.role!==x?e.jsx(Oe,{to:c.role==="Admin"?"/admin":"/driver"}):t:e.jsx(Oe,{to:"/login"})},aa=({children:t})=>{const[x,c]=Tt.useState(!1);return e.jsxs("div",{className:"with-sidebar",style:{display:"flex",minHeight:"100vh",position:"relative"},children:[e.jsxs("div",{style:{display:"none",position:"fixed",top:0,left:0,right:0,height:"50px",background:"rgba(15, 23, 42, 0.8)",backdropFilter:"blur(15px)",borderBottom:"1px solid var(--border)",zIndex:90,padding:"0 15px",alignItems:"center",justifyContent:"space-between"},className:"mobile-only-flex",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"24px",height:"24px",background:"var(--primary)",borderRadius:"6px"}}),e.jsx("h2",{style:{fontSize:"16px",fontWeight:"800",color:"white",letterSpacing:"-0.5px"},children:"FleetCRM"})]}),e.jsx("button",{onClick:()=>c(!x),style:{background:"rgba(255,255,255,0.05)",color:"white",padding:"6px",borderRadius:"8px"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})})]}),e.jsx(ta,{isOpen:x,onClose:()=>c(!1)}),x&&e.jsx("div",{onClick:()=>c(!1),className:"mobile-only",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:95}}),e.jsx("main",{className:"main-content",style:{transition:"margin 0.3s ease"},children:e.jsx("div",{style:{padding:"0"},children:t})})]})};function sa(){return e.jsx(It,{children:e.jsx(Mt,{children:e.jsx(Rt,{children:e.jsxs(_e,{children:[e.jsx(X,{path:"/login",element:e.jsx(Pt,{})}),e.jsx(X,{path:"/admin/*",element:e.jsx(Ue,{role:"Admin",children:e.jsx(Ot,{children:e.jsx(aa,{children:e.jsxs(_e,{children:[e.jsx(X,{index:!0,element:e.jsx(Et,{})}),e.jsx(X,{path:"drivers",element:e.jsx(Ut,{})}),e.jsx(X,{path:"freelancers",element:e.jsx(Gt,{})}),e.jsx(X,{path:"vehicles",element:e.jsx(Vt,{})}),e.jsx(X,{path:"outside-cars",element:e.jsx(Qt,{})}),e.jsx(X,{path:"fastag",element:e.jsx(Zt,{})}),e.jsx(X,{path:"border-tax",element:e.jsx(ea,{})}),e.jsx(X,{path:"reports",element:e.jsx(Xt,{})})]})})})})}),e.jsx(X,{path:"/driver/*",element:e.jsx(Ue,{role:"Driver",children:e.jsx(Kt,{})})}),e.jsx(X,{path:"/",element:e.jsx(Oe,{to:"/login"})})]})})})})}Wt.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(Dt,{children:e.jsx(sa,{})})}));
