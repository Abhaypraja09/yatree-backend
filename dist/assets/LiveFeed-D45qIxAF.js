import{b as n,j as e,A as R,o as W,p as D,q as L,U as d,C as p,$ as T,x as h,m as l,a9 as E,O as F,k as P,P as A,F as v,ak as O}from"./vendor-nIdkBVEz.js";import{u as N,b as $,i as U}from"./index-CXRpMsiQ.js";import{S as M}from"./SEO-CVNlN_yc.js";const _=()=>{const{user:V}=N(),{selectedCompany:c,selectedDate:a,setSelectedDate:x}=$(),[s,S]=n.useState(null),[B,u]=n.useState(!0),[i,I]=n.useState("drivers"),[o,w]=n.useState(""),f=n.useRef(null),k=t=>new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),y=async()=>{if(c){u(!0);try{const t=localStorage.getItem("userInfo"),r=JSON.parse(t),{data:b}=await U.get(`/api/admin/dashboard/${c._id}?date=${a}`,{headers:{Authorization:`Bearer ${r.token}`}});S(b)}catch(t){console.error("Error fetching feed",t)}finally{u(!1)}}};n.useEffect(()=>{y();const t=setInterval(y,6e4);return()=>clearInterval(t)},[c,a]);const C=s?.liveDriversFeed?.filter(t=>t.name.toLowerCase().includes(o.toLowerCase())||t.mobile.includes(o))||[],z=s?.liveVehiclesFeed?.filter(t=>t.carNumber.toLowerCase().includes(o.toLowerCase())||t.model.toLowerCase().includes(o.toLowerCase()))||[],m=s?.attendanceDetails||[],g=({id:t,label:r,icon:b,count:j})=>e.jsxs("button",{onClick:()=>I(t),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 24px",borderRadius:"14px",border:"none",background:i===t?"rgba(255, 255, 255, 0.1)":"transparent",color:i===t?"white":"rgba(255, 255, 255, 0.5)",fontWeight:"800",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:[e.jsx(b,{size:18,strokeWidth:i===t?2.5:2}),e.jsx("span",{style:{fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:r}),j!==void 0&&e.jsx("span",{style:{background:i===t?"#0ea5e9":"rgba(255,255,255,0.1)",color:i===t?"white":"rgba(255,255,255,0.4)",padding:"2px 8px",borderRadius:"8px",fontSize:"11px",marginLeft:"4px"},children:j}),i===t&&e.jsx(l.div,{layoutId:"activeTab",style:{position:"absolute",bottom:0,left:"20%",right:"20%",height:"3px",background:"#0ea5e9",borderRadius:"10px 10px 0 0"}})]});return e.jsxs("div",{style:{padding:"clamp(15px, 4vw, 40px)",minHeight:"100vh",background:"radial-gradient(circle at top right, #1e293b, #0f172a)"},children:[e.jsx(M,{title:"Live Fleet Control",description:"Real-time mission control for drivers and vehicles."}),e.jsx("header",{style:{marginBottom:"30px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"24px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"18px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",background:"linear-gradient(135deg, #0ea5e9, #6366f1)",borderRadius:"18px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 10px 25px rgba(14, 165, 233, 0.3)",border:"1px solid rgba(255,255,255,0.2)"},children:e.jsx(R,{size:30,color:"white"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#10b981",boxShadow:"0 0 10px #10b981"}}),e.jsx("span",{style:{fontSize:"10px",fontWeight:"900",color:"rgba(255,255,255,0.5)",letterSpacing:"1.5px",textTransform:"uppercase"},children:"REAL-TIME MISSION CONTROL"})]}),e.jsxs("h1",{style:{color:"white",fontSize:"clamp(28px, 6vw, 40px)",fontWeight:"950",margin:0,letterSpacing:"-2px"},children:["Live ",e.jsx("span",{style:{color:"#0ea5e9"},children:"Feed"})," Hub"]})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"6px",borderRadius:"16px",display:"flex",gap:"4px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("button",{onClick:()=>{const t=new Date(a);t.setDate(t.getDate()-1),x(t.toISOString().split("T")[0])},style:{width:"36px",height:"36px",borderRadius:"12px",background:"rgba(255,255,255,0.05)",border:"none",color:"white",cursor:"pointer"},children:e.jsx(W,{size:20})}),e.jsxs("div",{onClick:()=>f.current?.showPicker(),style:{height:"36px",padding:"0 16px",borderRadius:"12px",background:"rgba(255,255,255,0.08)",display:"flex",alignItems:"center",gap:"10px",color:"white",fontWeight:"800",fontSize:"13px",cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(D,{size:16,color:"#0ea5e9"}),k(a),e.jsx("input",{type:"date",ref:f,value:a,onChange:t=>x(t.target.value),style:{visibility:"hidden",width:0,position:"absolute"}})]}),e.jsx("button",{onClick:()=>{const t=new Date(a);t.setDate(t.getDate()+1),x(t.toISOString().split("T")[0])},style:{width:"36px",height:"36px",borderRadius:"12px",background:"rgba(255,255,255,0.05)",border:"none",color:"white",cursor:"pointer"},children:e.jsx(L,{size:20})})]})})]})}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"30px"},children:[{label:"PRESENT DRIVERS",value:s?.countPunchIns||0,total:s?.liveDriversFeed?.length||0,icon:d,color:"#10b981"},{label:"VEHICLES IN USE",value:s?.liveVehiclesFeed?.filter(t=>t.status==="In Use").length||0,total:s?.totalVehicles||0,icon:p,color:"#0ea5e9"},{label:"COMPLETED DUTIES",value:s?.countPunchOuts||0,icon:T,color:"#8b5cf6"},{label:"IDLE FLEET",value:s?.liveVehiclesFeed?.filter(t=>t.status==="Idle").length||0,icon:h,color:"rgba(255,255,255,0.4)"}].map((t,r)=>e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},className:"glass-card",style:{padding:"20px",display:"flex",alignItems:"center",gap:"15px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",background:`${t.color}15`,display:"flex",justifyContent:"center",alignItems:"center",border:`1px solid ${t.color}25`},children:e.jsx(t.icon,{size:22,color:t.color})}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontSize:"10px",fontWeight:"900",color:"rgba(255,255,255,0.4)",letterSpacing:"0.5px"},children:t.label}),e.jsxs("h3",{style:{margin:"2px 0 0 0",color:"white",fontSize:"20px",fontWeight:"900"},children:[t.value,t.total?e.jsxs("span",{style:{fontSize:"13px",opacity:.3,fontWeight:"700"},children:[" / ",t.total]}):""]})]})]},r))}),e.jsxs("div",{className:"glass-card",style:{padding:"0",background:"rgba(30, 41, 59, 0.4)",borderRadius:"24px",border:"1px solid rgba(255,255,255,0.05)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"15px 25px",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"20px",background:"rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(g,{id:"drivers",label:"Drivers",icon:d,count:s?.liveDriversFeed?.length}),e.jsx(g,{id:"vehicles",label:"Fleet",icon:p,count:s?.totalVehicles}),e.jsx(g,{id:"history",label:"Activity Logs",icon:E})]}),e.jsxs("div",{style:{position:"relative",flex:"1",maxWidth:"300px"},children:[e.jsx(F,{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"rgba(255,255,255,0.3)"},size:16}),e.jsx("input",{type:"text",placeholder:`Search ${i}...`,value:o,onChange:t=>w(t.target.value),style:{width:"100%",padding:"10px 15px 10px 40px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"12px",color:"white",fontSize:"13px",fontWeight:"600"}})]})]}),e.jsx("div",{style:{padding:"25px",maxHeight:"70vh",overflowY:"auto"},className:"custom-scrollbar",children:e.jsxs(P,{mode:"wait",children:[i==="drivers"&&e.jsx(l.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px"},children:C.sort((t,r)=>t.status==="Present"?-1:1).map(t=>e.jsxs("div",{style:{padding:"16px",background:t.status==="Present"?"rgba(16, 185, 129, 0.05)":t.status==="Completed"?"rgba(139, 92, 246, 0.05)":"rgba(255,255,255,0.02)",borderRadius:"20px",border:`1px solid ${t.status==="Present"?"rgba(16, 185, 129, 0.15)":t.status==="Completed"?"rgba(139, 92, 246, 0.15)":"rgba(255,255,255,0.05)"}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"14px",background:t.isFreelancer?"rgba(129, 140, 248, 0.1)":"rgba(255,255,255,0.05)",display:"flex",justifyContent:"center",alignItems:"center",border:`1px solid ${t.isFreelancer?"rgba(129, 140, 248, 0.2)":"rgba(255,255,255,0.1)"}`},children:e.jsx(d,{size:24,color:t.status==="Present"?"#10b981":t.status==="Completed"?"#8b5cf6":t.isFreelancer?"#818cf8":"rgba(255,255,255,0.3)"})}),e.jsx("div",{style:{position:"absolute",bottom:"-2px",right:"-2px",width:"14px",height:"14px",borderRadius:"50%",background:t.status==="Present"?"#10b981":t.status==="Completed"?"#8b5cf6":"#334155",border:"3px solid #1e293b",boxShadow:t.status==="Present"?"0 0 10px #10b981":t.status==="Completed"?"0 0 10px #8b5cf6":"none"}})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("h4",{style:{margin:0,color:"white",fontSize:"15px",fontWeight:"900"},children:t.name}),!t.isFreelancer&&e.jsx("span",{style:{fontSize:"8px",background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.4)",padding:"2px 6px",borderRadius:"4px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"0.5px"},children:"CO."})]}),t.isFreelancer&&e.jsx("div",{style:{fontSize:"9px",fontWeight:"900",color:"#818cf8",textTransform:"uppercase",marginTop:"1px"},children:"Freelancer"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"2px"},children:[e.jsx(A,{size:10,color:"rgba(255,255,255,0.3)"}),e.jsx("span",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700"},children:t.mobile})]})]})]}),e.jsx("div",{style:{textAlign:"right"},children:["Present","Completed","Lapsed"].includes(t.status)?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",alignItems:"flex-end"},children:[t.fuelAmount>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",background:"rgba(245, 158, 11, 0.1)",padding:"2px 8px",borderRadius:"4px",border:"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsx(v,{size:12,color:"#f59e0b"}),e.jsxs("span",{style:{fontSize:"11px",color:"#f59e0b",fontWeight:"950"},children:["â‚¹",t.fuelAmount]})]}),e.jsx("span",{style:{fontSize:"10px",background:t.status==="Present"?"#10b98120":t.status==="Lapsed"?"#f59e0b20":t.status==="Completed"?"#8b5cf620":"rgba(255,255,255,0.05)",color:t.status==="Present"?"#10b981":t.status==="Lapsed"?"#f59e0b":t.status==="Completed"?"#8b5cf6":"rgba(255,255,255,0.3)",padding:"3px 10px",borderRadius:"8px",fontWeight:"900",border:`1px solid ${t.status==="Present"?"rgba(16, 185, 129, 0.2)":t.status==="Completed"?"rgba(139, 92, 246, 0.2)":"rgba(255,255,255,0.1)"}`},children:t.status==="Present"?"ON DUTY":t.status==="Lapsed"?"LAPSED":t.status==="Completed"?"COMPLETED":"OFF DUTY"}),t.currentAttendance?.vehicle?.carNumber&&e.jsxs("div",{style:{fontSize:"12px",color:"#0ea5e9",fontWeight:"900",background:"rgba(14, 165, 233, 0.1)",padding:"2px 6px",borderRadius:"6px"},children:["#",t.currentAttendance.vehicle.carNumber.split("#")[0].slice(-4)]})]}):e.jsx("span",{style:{fontSize:"10px",color:"rgba(255,255,255,0.15)",fontWeight:"800",textTransform:"uppercase",letterSpacing:"1px"},children:"Off Duty"})})]},t._id))},"drivers"),i==="vehicles"&&e.jsx(l.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px"},children:z.sort((t,r)=>t.status!=="Idle"?-1:1).map(t=>e.jsxs("div",{style:{padding:"16px",background:t.status!=="Idle"?"rgba(14, 165, 233, 0.05)":"rgba(255,255,255,0.02)",borderRadius:"20px",border:`1px solid ${t.status!=="Idle"?"rgba(14, 165, 233, 0.15)":"rgba(255,255,255,0.05)"}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"14px",background:"rgba(255,255,255,0.05)",display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsx(p,{size:24,color:t.status!=="Idle"?"#0ea5e9":"rgba(255,255,255,0.3)"})}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:0,color:"white",fontSize:"15px",fontWeight:"900"},children:t.carNumber.split("#")[0]}),e.jsx("span",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700"},children:t.model})]})]}),e.jsx("div",{style:{textAlign:"right"},children:t.status!=="Idle"?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",alignItems:"flex-end"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.fuelAmount>0&&e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",padding:"3px 8px",borderRadius:"6px",display:"flex",alignItems:"center",border:"1px solid rgba(245, 158, 11, 0.2)",gap:"4px"},children:[e.jsx(v,{size:12,color:"#f59e0b"}),e.jsxs("span",{style:{fontSize:"10px",color:"#f59e0b",fontWeight:"950"},children:["â‚¹",t.fuelAmount]})]}),e.jsx("span",{style:{fontSize:"10px",background:t.status==="In Use"?"#0ea5e920":t.status==="Lapsed"?"#f59e0b20":"#8b5cf620",color:t.status==="In Use"?"#0ea5e9":t.status==="Lapsed"?"#f59e0b":"#8b5cf6",padding:"3px 10px",borderRadius:"8px",fontWeight:"900",border:`1px solid ${t.status==="In Use"?"rgba(14, 165, 233, 0.3)":t.status==="Lapsed"?"rgba(245, 158, 11, 0.3)":"rgba(139, 92, 246, 0.3)"}`},children:t.status.toUpperCase()})]}),t.currentDriver&&e.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.5)",fontWeight:"800"},children:["ðŸ‘¤ ",t.currentDriver.name]})]}):e.jsx("span",{style:{fontSize:"11px",color:"rgba(255,255,255,0.2)",fontWeight:"800"},children:"IDLE"})})]},t._id))},"vehicles"),i==="history"&&e.jsx(l.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},style:{display:"flex",flexDirection:"column",gap:"10px"},children:m.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"rgba(255,255,255,0.2)"},children:[e.jsx(h,{size:40,style:{marginBottom:"10px",opacity:.5}}),e.jsx("p",{style:{fontWeight:"700"},children:"No activity logs for this date."})]}):m.map(t=>e.jsxs("div",{style:{padding:"20px",background:"rgba(255,255,255,0.02)",borderRadius:"20px",border:"1px solid rgba(255,255,255,0.05)",display:"grid",gridTemplateColumns:"1.2fr 1fr 1fr 1fr 0.5fr",alignItems:"center",gap:"20px"},children:[e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"rgba(139, 92, 246, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(d,{size:20,color:"#8b5cf6"})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"900",fontSize:"14px"},children:t.driver?.name}),e.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700"},children:t.driver?.mobile})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"rgba(14, 165, 233, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(p,{size:20,color:"#0ea5e9"})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"900",fontSize:"14px"},children:t.vehicle?.carNumber}),e.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700"},children:t.vehicle?.model})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"rgba(16, 185, 129, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(O,{size:20,color:"#10b981"})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"900",fontSize:"14px"},children:new Date(t.punchIn?.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700"},children:[t.punchIn?.km," KM START"]})]})]}),e.jsx("div",{children:t.punchOut?.time?e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"rgba(244, 63, 94, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{size:20,color:"#f43f5e"})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"900",fontSize:"14px"},children:new Date(t.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",fontWeight:"700"},children:[t.punchOut.km," KM END"]})]})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#38bdf8"},children:[e.jsx(l.div,{animate:{opacity:[.3,1,.3]},transition:{repeat:1/0,duration:2},style:{width:"10px",height:"10px",borderRadius:"50%",background:"#38bdf8"}}),e.jsx("span",{style:{fontSize:"11px",fontWeight:"900",textTransform:"uppercase"},children:"In Progress..."})]})}),e.jsx("div",{style:{textAlign:"right"},children:t.totalKM&&e.jsxs("div",{style:{fontSize:"16px",fontWeight:"950",color:"white"},children:[t.totalKM," ",e.jsx("span",{style:{fontSize:"10px",opacity:.4},children:"KM"})]})})]},t._id))},"history")]})})]}),e.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); borderRadius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }
                .glass-card { backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); }
            `})]})};export{_ as default};
