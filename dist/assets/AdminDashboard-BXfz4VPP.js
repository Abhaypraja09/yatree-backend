import{u as H,b as d,j as e,o as G,p as K,m as f,X as Y,l as q,U as v,q as E,F as Q,W as _,s as J,d as X,C as D,B as Z,I as ee,A as te,T as ae,S as ie,t as z}from"./vendor-CsmMgo9Y.js";import{u as re,a as ne,b as oe,i as se}from"./index-BEMTMdP-.js";import{S as le}from"./SEO-CazPvYqc.js";const n=({icon:u,label:i,value:k,color:s,loading:y,trend:T,onClick:a})=>e.jsxs(f.div,{whileHover:{y:-8,scale:1.02},whileTap:{scale:.98},onClick:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`stat-card glass-card ${y?"stale-card":""}`,style:{background:"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.9) 100%)",border:"1px solid rgba(255,255,255,0.08)",position:"relative",overflow:"hidden",padding:"clamp(15px, 2.5vw, 24px)",cursor:"pointer",boxShadow:"0 20px 40px -15px rgba(0,0,0,0.5)",borderRadius:"24px"},children:[e.jsx("div",{style:{position:"absolute",top:"-20%",left:"-10%",width:"140px",height:"140px",background:s,filter:"blur(70px)",opacity:.1,pointerEvents:"none"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px",position:"relative",zIndex:1},children:[e.jsx("div",{style:{width:"46px",height:"46px",borderRadius:"14px",background:`linear-gradient(135deg, ${s}30, ${s}10)`,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${s}40`,color:s,boxShadow:`0 8px 16px -4px ${s}30`},children:e.jsx(u,{size:22,strokeWidth:2.5})}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"10px",fontWeight:"900",color:"rgba(255,255,255,0.4)",textTransform:"uppercase",letterSpacing:"1.8px",marginBottom:"6px"},children:i}),e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"10px"},children:[e.jsx("h3",{style:{fontSize:"clamp(22px, 3vw, 28px)",fontWeight:"900",color:"white",letterSpacing:"-1px",margin:0,textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:y?"...":k||0}),T&&e.jsxs("span",{style:{fontSize:"9px",color:"#10b981",background:"rgba(16, 185, 129, 0.1)",padding:"2px 8px",borderRadius:"20px",fontWeight:"900",display:"flex",alignItems:"center",gap:"3px",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[e.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:"#10b981",boxShadow:"0 0 5px #10b981"}}),"LIVE"]})]})]})]})]}),ge=()=>{const{user:u}=re(),i=H(),{t:k}=ne(),{selectedCompany:s,selectedDate:y,setSelectedDate:T}=oe(),[a,N]=d.useState(null),[r,C]=d.useState(!0),[R,m]=d.useState(!1),[p,j]=d.useState("month"),[x,W]=d.useState(""),[g,$]=d.useState(""),[l,S]=d.useState({from:null,to:null});d.useRef(null);const O=()=>{const t=new Date,o=t.getTimezoneOffset();return new Date(t.getTime()-o*60*1e3).toISOString().split("T")[0]},I=t=>t?new Date(t).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"",M=t=>t.from&&t.to?`fromDate=${t.from}&toDate=${t.to}`:`date=${y}`,A=async(t=l)=>{const o=localStorage.getItem("userInfo");if(!(!o||!s)){C(!0);try{const c=JSON.parse(o),b=M(t),{data:w}=await se.get(`/api/admin/dashboard/${s._id}?${b}`,{headers:{Authorization:`Bearer ${c.token}`}});N(w)}catch(c){console.error("Error fetching stats",c)}finally{C(!1)}}};d.useEffect(()=>{A(l);const t=setInterval(()=>A(l),6e4);return()=>clearInterval(t)},[s,l]);const L=t=>{const o=O(),c=new Date(o);let b=new Date(o);if(t==="month"){b=new Date(c.getFullYear(),c.getMonth(),1);const U=b.toISOString().split("T")[0],V=new Date(c.getFullYear(),c.getMonth()+1,0).toISOString().split("T")[0];S({from:U,to:V}),j("month"),m(!1);return}const w=t==="1m"?1:t==="3m"?3:5;b.setMonth(b.getMonth()-w);const P={from:b.toISOString().split("T")[0],to:o};S(P),j(t),m(!1)},F=()=>{!x||!g||(S({from:x,to:g}),j("custom"),m(!1))};d.useEffect(()=>{L("month")},[s]);const B=()=>{if(!l.from||!l.to)return"Select Range";const t=I(l.from),o=I(l.to);return l.from===l.to?t:`${t} â†’ ${o}`},h=()=>p==="month"?"THIS MONTH":p==="1m"?"LAST 1 MO":p==="3m"?"LAST 3 MO":p==="5m"?"LAST 5 MO":"CUSTOM";return e.jsxs("div",{className:"admin-dashboard-container",style:{background:"radial-gradient(circle at 50% 0%, rgba(14, 165, 233, 0.08) 0%, transparent 60%), radial-gradient(circle at 0% 100%, rgba(99, 102, 241, 0.05) 0%, transparent 40%)",minHeight:"100vh",padding:"clamp(15px, 4vw, 40px)",color:"white"},children:[e.jsx(le,{title:"Admin Dashboard",description:"Overview of fleet operations, driver attendance, and financial metrics."}),e.jsx("style",{children:`
                .admin-dashboard-container { overflow-x: hidden; }
                .glass-card {
                    backdrop-filter: blur(16px);
                    -webkit-backdrop-filter: blur(16px);
                    box-shadow: 0 10px 30px -5px rgba(0,0,0,0.3);
                }
                .status-pill { border-radius: 20px; letter-spacing: 0.5px; }
                .vehicle-badge { letter-spacing: 0.5px; }
            `}),e.jsx("div",{className:"glass-card dashboard-header",style:{background:"rgba(30, 41, 59, 0.4)",borderRadius:"32px",padding:"clamp(20px, 4vw, 32px)",border:"1px solid rgba(255,255,255,0.08)",marginBottom:"40px",width:"100%",boxSizing:"border-box"},children:e.jsxs("header",{className:"mobile-stack",style:{justifyContent:"space-between",width:"100%"},children:[e.jsx("div",{className:"header-logo-section",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{className:"header-logo-container",style:{background:"linear-gradient(135deg, white, #f8fafc)",borderRadius:"16px",padding:"8px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:e.jsx(G,{size:28,color:"#fbbf24"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#fbbf24",boxShadow:"0 0 8px #fbbf24"}}),e.jsx("span",{style:{fontSize:"clamp(9px,2.5vw,10px)",fontWeight:"800",color:"rgba(255,255,255,0.5)",letterSpacing:"1px",textTransform:"uppercase"},children:"Fleet Control Center"})]}),e.jsxs("h1",{className:"header-title",style:{color:"white",fontWeight:"900",margin:0,letterSpacing:"-1.5px"},children:["Executive ",e.jsx("span",{className:"text-gradient-yellow",children:"Dashboard"})]})]})]})}),e.jsxs("div",{className:"date-selector-wrapper",style:{flexShrink:0,position:"relative"},children:[e.jsxs("button",{onClick:()=>m(!R),style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px 18px",background:"rgba(251, 191, 36, 0.1)",border:"1px solid rgba(251, 191, 36, 0.25)",borderRadius:"14px",color:"white",cursor:"pointer",fontWeight:"800",fontSize:"13px",transition:"all 0.2s"},children:[e.jsx(K,{size:16,color:"#fbbf24"}),e.jsx("span",{style:{maxWidth:"220px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B()}),e.jsx("span",{style:{fontSize:"9px",background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"2px 7px",borderRadius:"6px",fontWeight:"900"},children:h()})]}),R&&e.jsxs(f.div,{initial:{opacity:0,y:-10,scale:.96},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10},style:{position:"absolute",top:"54px",right:0,zIndex:100,background:"#1e293b",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"20px",padding:"20px",minWidth:"300px",boxShadow:"0 25px 50px rgba(0,0,0,0.5)"},children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"900",color:"rgba(255,255,255,0.4)",letterSpacing:"1.5px",marginBottom:"12px"},children:"QUICK PRESETS"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"20px"},children:[{key:"month",label:"This Month"},{key:"1m",label:"Last 1 Month"},{key:"3m",label:"Last 3 Months"},{key:"5m",label:"Last 5 Months"}].map(t=>e.jsx("button",{onClick:()=>L(t.key),style:{padding:"10px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"800",background:p===t.key?"rgba(14,165,233,0.2)":"rgba(255,255,255,0.05)",color:p===t.key?"#0ea5e9":"rgba(255,255,255,0.7)",border:p===t.key?"1px solid rgba(14,165,233,0.4)":"1px solid rgba(255,255,255,0.08)",cursor:"pointer",transition:"all 0.2s"},children:t.label},t.key))}),e.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.08)",paddingTop:"16px"},children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"900",color:"rgba(255,255,255,0.4)",letterSpacing:"1.5px",marginBottom:"12px"},children:"CUSTOM DATE RANGE"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"12px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",marginBottom:"4px",fontWeight:"700"},children:"FROM"}),e.jsx("input",{type:"date",value:x,onChange:t=>W(t.target.value),style:{width:"100%",padding:"8px 10px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"10px",color:"white",fontSize:"12px",fontWeight:"700",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.4)",marginBottom:"4px",fontWeight:"700"},children:"TO"}),e.jsx("input",{type:"date",value:g,onChange:t=>$(t.target.value),style:{width:"100%",padding:"8px 10px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"10px",color:"white",fontSize:"12px",fontWeight:"700",boxSizing:"border-box"}})]})]}),e.jsx("button",{onClick:F,disabled:!x||!g,style:{width:"100%",padding:"10px",borderRadius:"12px",background:x&&g?"linear-gradient(135deg, #0ea5e9, #6366f1)":"rgba(255,255,255,0.05)",color:x&&g?"white":"rgba(255,255,255,0.3)",border:"none",fontWeight:"900",fontSize:"13px",cursor:x&&g?"pointer":"not-allowed",transition:"all 0.2s"},children:"Apply Custom Range"})]}),e.jsx("button",{onClick:()=>m(!1),style:{position:"absolute",top:"12px",right:"12px",width:"28px",height:"28px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(Y,{size:14})})]})]})]})}),e.jsxs("div",{style:{position:"relative",minHeight:"600px"},children:[e.jsx(q,{children:r&&e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"absolute",inset:0,background:"rgba(15, 23, 42, 0.4)",backdropFilter:"blur(4px)",zIndex:10,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"16px",pointerEvents:"none"},children:e.jsx("div",{className:"spinner"})})}),a&&e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"dashboard-main-container",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsx(n,{icon:v,label:"TOTAL DRIVER SALARY",value:`â‚¹${(a.monthlyRegularSalaryTotal||0).toLocaleString()}`,color:"#fbbf24",loading:r,onClick:()=>i("/admin/advances"),trend:h()}),e.jsx(n,{icon:E,label:"TOTAL DRIVER ADVANCE",value:`â‚¹${(a.totalAdvancePending||0).toLocaleString()}`,color:"#f59e0b",loading:r,onClick:()=>i("/admin/advances"),trend:"PENDING"}),e.jsx(n,{icon:Q,label:`FUEL (${h()})`,value:`â‚¹${a.monthlyFuelAmount?.toLocaleString()||0}`,color:"#0ea5e9",loading:r,onClick:()=>i("/admin/fuel")}),e.jsx(n,{icon:_,label:`MAINTENANCE (${h()})`,value:`â‚¹${a.monthlyMaintenanceAmount?.toLocaleString()||0}`,color:"#f43f5e",loading:r,onClick:()=>i("/admin/maintenance")}),e.jsx(n,{icon:J,label:`OUTSIDE CARS (${h()})`,value:`â‚¹${(a.monthlyOutsideCarsTotal||0).toLocaleString()}`,color:"#8b5cf6",loading:r,onClick:()=>i("/admin/outside-cars")}),e.jsx(n,{icon:E,label:`PARKING (${h()})`,value:`â‚¹${a.monthlyParkingAmount?.toLocaleString()||0}`,color:"#f59e0b",loading:r,onClick:()=>i("/admin/parking")}),e.jsx(n,{icon:v,label:`FREELANCERS (${h()})`,value:`â‚¹${(a.monthlyFreelancerSalaryTotal||0).toLocaleString()}`,color:"#f59e0b",loading:r,onClick:()=>i("/admin/freelancers")}),e.jsx(n,{icon:X,label:"WARRANTY COST (TOTAL)",value:`â‚¹${(a.totalWarrantyCost||0).toLocaleString()}`,color:"#8b5cf6",loading:r,onClick:()=>i("/admin/warranties")}),e.jsx(n,{icon:v,label:"CURRENT DRIVERS",value:a.totalDrivers,color:"#0ea5e9",loading:r,onClick:()=>i(u?.role==="Executive"?"/admin/freelancers":"/admin/drivers")}),e.jsx(n,{icon:D,label:"FLEET SIZE",value:a.totalVehicles,color:"#8b5cf6",loading:r,onClick:()=>i(u?.role==="Executive"?"/admin/outside-cars":"/admin/vehicles")}),e.jsx(n,{icon:Z,label:"TOTAL STAFF",value:a.totalStaff,color:"#f59e0b",loading:r,onClick:()=>i("/admin/staff")}),e.jsx(n,{icon:ee,label:"FASTAG BAL.",value:`â‚¹${a.totalFastagBalance?.toLocaleString()||0}`,color:"#fbbf24",loading:r,onClick:()=>i("/admin/fastag")}),e.jsx(n,{icon:te,label:"TOTAL DUTIES",value:a.countPunchIns,color:"#3b82f6",loading:r,onClick:()=>{},trend:"LIVE"})]}),e.jsx("div",{className:"stats-grid",style:{marginTop:"0"},children:e.jsx(n,{icon:ae,label:"TOTAL ACCIDENT COST",value:`â‚¹${(a.monthlyAccidentAmount||0).toLocaleString()}`,color:"#f43f5e",loading:r,onClick:()=>i("/admin/accident-logs"),trend:"ALL TIME"})}),a.expiringAlerts&&a.expiringAlerts.length>0&&e.jsxs("div",{className:"glass-card",style:{border:"1px solid rgba(244, 63, 94, 0.2)",background:"linear-gradient(145deg, rgba(244, 63, 94, 0.05), rgba(15, 23, 42, 0.2))",marginBottom:"clamp(20px, 4vw, 30px)",width:"100%",boxSizing:"border-box"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"clamp(16px, 3.5vw, 20px)",flexWrap:"wrap"},children:[e.jsx(ie,{color:"#f43f5e",size:20}),e.jsx("h3",{style:{fontSize:"clamp(13px, 3.2vw, 16px)",fontWeight:"700",color:"white",margin:0,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Expiry Alerts (Within 30 Days)"})]}),e.jsx("div",{className:"expiry-alerts-grid",children:a.expiringAlerts.map((t,o)=>e.jsxs("div",{className:"alert-card glass-card-hover-effect",style:{background:t.status==="Expired"?"rgba(244, 63, 94, 0.1)":"rgba(245, 158, 11, 0.1)",border:`1px solid ${t.status==="Expired"?"rgba(244, 63, 94, 0.2)":"rgba(245, 158, 11, 0.2)"}`,position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"10px",gap:"8px"},children:[e.jsx("span",{className:"alert-identifier",style:{color:"rgba(255,255,255,0.9)",textTransform:"uppercase",flex:1,fontWeight:"700"},children:t.identifier}),e.jsx("span",{style:{fontSize:"clamp(9px, 2vw, 10px)",padding:"4px 8px",borderRadius:"6px",background:t.daysLeft<0?"#f43f5e":t.daysLeft===0?"#0ea5e9":"#f59e0b",color:"white",fontWeight:"800",flexShrink:0,whiteSpace:"nowrap",boxShadow:"0 2px 5px rgba(0,0,0,0.2)"},children:t.type==="Service"?t.daysLeft<=0?`${Math.abs(t.daysLeft)} KM Overdue`:`${t.daysLeft} KM Due`:t.daysLeft<0?`${Math.abs(t.daysLeft)}d Overdue`:t.daysLeft===0?"Today":`${t.daysLeft}d Left`})]}),e.jsx("div",{className:"alert-type",style:{color:"white",marginBottom:"8px"},children:t.documentType}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",gap:"8px"},children:[e.jsxs("div",{className:"alert-date",style:{color:"rgba(255,255,255,0.6)",fontWeight:"500",fontSize:"clamp(10px, 2.5vw, 12px)"},children:["Exp: ",e.jsx("span",{style:{color:"white",fontWeight:"700"},children:new Date(t.expiryDate).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("a",{href:`https://wa.me/916367466426?text=${encodeURIComponent(`REMINDER: Vehicle document for ${t.identifier} (${t.documentType}) is expiring on ${new Date(t.expiryDate).toLocaleDateString()}. Please renew it ASAP.`)}`,target:"_blank",rel:"noopener noreferrer",style:{background:"rgba(37, 211, 102, 0.2)",color:"#25D366",padding:"4px 8px",borderRadius:"6px",fontSize:"clamp(9px, 2.2vw, 10px)",fontWeight:"800",display:"flex",alignItems:"center",gap:"4px",textDecoration:"none",border:"1px solid rgba(37, 211, 102, 0.3)"},title:"Send WhatsApp Reminder",children:[e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ’¬"})," WA"]})]})]},o))})]}),e.jsxs("div",{className:"dashboard-feeds-container",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px",marginTop:"10px",marginBottom:"20px"},children:[e.jsx(f.div,{whileHover:{y:-5},onClick:()=>i("/admin/live-feed"),className:"glass-card",style:{padding:"24px",cursor:"pointer",border:"1px solid rgba(16, 185, 129, 0.2)",background:"rgba(16, 185, 129, 0.03)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"15px",background:"rgba(16, 185, 129, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(v,{color:"#10b981",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{style:{color:"white",margin:0,fontSize:"18px",fontWeight:"900"},children:"Driver Presence"}),e.jsxs("p",{style:{margin:0,fontSize:"12px",color:"rgba(16, 185, 129, 0.6)",fontWeight:"700"},children:[a.countPunchIns," Present Today"]})]})]}),e.jsx(z,{color:"rgba(16, 185, 129, 0.4)"})]})}),e.jsx(f.div,{whileHover:{y:-5},onClick:()=>i("/admin/live-feed"),className:"glass-card",style:{padding:"24px",cursor:"pointer",border:"1px solid rgba(14, 165, 233, 0.2)",background:"rgba(14, 165, 233, 0.03)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"15px",background:"rgba(14, 165, 233, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(D,{color:"#0ea5e9",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{style:{color:"white",margin:0,fontSize:"18px",fontWeight:"900"},children:"Fleet Utilization"}),e.jsxs("p",{style:{margin:0,fontSize:"12px",color:"rgba(14, 165, 233, 0.6)",fontWeight:"700"},children:[a.liveVehiclesFeed?.filter(t=>t.status!=="Idle").length," In Operation"]})]})]}),e.jsx(z,{color:"rgba(14, 165, 233, 0.4)"})]})})]})]})]})]})};export{ge as default};
