const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/xlsx.min-DHmspywJ.js","assets/vendor-BHRyg4ZX.js","assets/excel-DBw7RJ0s.js"])))=>i.map(i=>d[i]);
import{b as Ee,i as U,_ as ne}from"./index-Dzbcx6at.js";import{b as g,j as e,a3 as Pe,K as ie,m as k,a4 as ae,V,U as Fe,C as se,F as Le,W as Be,I as Me,o as le,M as $e,y as Ke,T as Ue,O as Ve,q as H,w as re,a5 as oe,a6 as de,Y as ce,J as pe,l as He,X as xe}from"./vendor-BHRyg4ZX.js";import{S as Ye}from"./SEO-SOXuDcZn.js";const qe=({item:a,onClose:N,borderTaxRecords:W})=>e.jsxs("div",{className:"modal-overlay",style:{position:"fixed",inset:0,zIndex:1e3,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(5px)",display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:[e.jsx("style",{children:`
            .grid-1-2-2-3 { display: grid; grid-template-columns: 1fr; }
            @media(min-width: 768px) { .grid-1-2-2-3 { grid-template-columns: 1fr 1fr; } }
            
            .grid-1-2-3-4 { display: grid; grid-template-columns: 1fr; }
            @media(min-width: 640px) { .grid-1-2-3-4 { grid-template-columns: 1fr 1fr; } }
            @media(min-width: 1024px) { .grid-1-2-3-4 { grid-template-columns: 1fr 1fr 1fr; } }
            
            /* Hide scrollbar for modal content */
            .modal-content::-webkit-scrollbar { width: 8px; }
            .modal-content::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
            .modal-content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 4px; }
        `}),e.jsxs(k.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"glass-card modal-content",style:{width:"100%",maxWidth:"900px",maxHeight:"92vh",overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header",style:{position:"sticky",top:0,background:"var(--bg-dark)",zIndex:10,margin:"-20px -20px 20px -20px",padding:"15px 20px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("h2",{className:"modal-title",children:["Report Detail: ",a.driver?.name||a.driverName||"Report"]}),e.jsx("button",{onClick:N,className:"modal-close-btn",children:e.jsx(xe,{size:18})})]}),a.entryType==="attendance"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid-1-2-2-3",style:{gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{className:"modal-section-title",style:{borderColor:"#10b981"},children:"Punch In Details"}),e.jsxs("div",{className:"photo-grid",children:[e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"SELFIE"}),e.jsx("img",{src:a.punchIn?.selfie,className:"photo-thumbnail",onClick:()=>window.open(a.punchIn?.selfie),loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"KM METER"}),e.jsx("img",{src:a.punchIn?.kmPhoto,className:"photo-thumbnail",onClick:()=>window.open(a.punchIn?.kmPhoto),loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"CAR PHOTO"}),e.jsx("img",{src:a.punchIn?.carSelfie,className:"photo-thumbnail",onClick:()=>window.open(a.punchIn?.carSelfie),loading:"lazy"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"modal-section-title",style:{borderColor:"#f43f5e"},children:"Punch Out Details"}),a.punchOut?.time?e.jsxs("div",{className:"photo-grid",children:[e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"SELFIE"}),e.jsx("img",{src:a.punchOut?.selfie,className:"photo-thumbnail",onClick:()=>window.open(a.punchOut?.selfie),loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"KM METER"}),e.jsx("img",{src:a.punchOut?.kmPhoto,className:"photo-thumbnail",onClick:()=>window.open(a.punchOut?.kmPhoto),loading:"lazy"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"photo-label",children:"CAR PHOTO"}),e.jsx("img",{src:a.punchOut?.carSelfie,className:"photo-thumbnail",onClick:()=>window.open(a.punchOut?.carSelfie),loading:"lazy"})]})]}):e.jsx("div",{style:{height:"80px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"var(--text-muted)",background:"rgba(255,255,255,0.02)",border:"1px dashed rgba(255,255,255,0.1)",borderRadius:"12px"},children:e.jsx("p",{style:{fontSize:"12px",margin:0,fontWeight:"600"},children:"Driver currently on road..."})})]})]}),e.jsxs("div",{className:"resp-grid grid-1-2-3-4",style:{marginTop:"25px",gap:"15px"},children:[e.jsxs("div",{className:"glass-card",style:{padding:"15px",background:"rgba(255,255,255,0.02)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"12px",fontWeight:"800",textTransform:"uppercase"},children:"Fuel Management"}),a.fuel?.filled?e.jsx("div",{style:{display:"grid",gap:"10px"},children:a.fuel.entries&&a.fuel.entries.length>0?a.fuel.entries.map((c,y)=>e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",background:"rgba(255,255,255,0.03)",padding:"8px",borderRadius:"8px"},children:[e.jsx("img",{src:c.slipPhoto,onClick:()=>window.open(c.slipPhoto),style:{width:"40px",height:"40px",borderRadius:"6px",objectFit:"cover",cursor:"pointer"},loading:"lazy"}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"14px",margin:0},children:["â‚¹",c.amount]}),e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700",fontSize:"10px",margin:0},children:[c.km," KM"]})]})]},y)):e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[a.fuel.slipPhoto&&e.jsx("img",{src:a.fuel.slipPhoto,onClick:()=>window.open(a.fuel.slipPhoto),style:{width:"50px",height:"50px",borderRadius:"8px",objectFit:"cover",cursor:"pointer"}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"16px",margin:0},children:["â‚¹",a.fuel.amount]}),e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700",fontSize:"11px",margin:0},children:[a.fuel.km||"--"," KM"]})]})]})}):null]}),e.jsxs("div",{className:"glass-card",style:{padding:"15px",background:"rgba(255,255,255,0.02)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"12px",fontWeight:"800",textTransform:"uppercase"},children:"Tolls & Parking"}),a.punchOut?.tollParkingAmount>0||a.parking&&a.parking.length>0?e.jsxs("div",{children:[e.jsxs("p",{style:{color:"white",fontWeight:"800",fontSize:"16px",margin:0},children:["â‚¹",a.punchOut?.tollParkingAmount||a.parking?.reduce((c,y)=>c+(y.amount||0),0)]}),a.parking&&a.parking.length>0&&e.jsx("div",{style:{display:"flex",gap:"4px",marginTop:"10px",flexWrap:"wrap"},children:a.parking.map((c,y)=>e.jsx("img",{src:c.slipPhoto,onClick:()=>window.open(c.slipPhoto),style:{width:"30px",height:"30px",borderRadius:"4px",objectFit:"cover",border:"1px solid rgba(255,255,255,0.1)",cursor:"pointer"}},y))})]}):null]}),e.jsxs("div",{className:"glass-card",style:{padding:"15px",background:"rgba(255,255,255,0.02)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"12px",fontWeight:"800",textTransform:"uppercase"},children:"Incentives & Taxes"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[a.punchOut?.allowanceTA>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"TA:"})," ",e.jsxs("span",{style:{color:"#10b981",fontWeight:"800"},children:["+â‚¹",a.punchOut.allowanceTA]})]}),a.punchOut?.nightStayAmount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Stay:"})," ",e.jsxs("span",{style:{color:"#10b981",fontWeight:"800"},children:["+â‚¹",a.punchOut.nightStayAmount]})]}),a.outsideTrip?.occurred&&e.jsxs("div",{style:{padding:"8px",background:"rgba(56, 189, 248, 0.05)",borderRadius:"8px",marginTop:"5px",border:"1px solid rgba(56, 189, 248, 0.1)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"#38bdf8",fontWeight:"800",margin:"0 0 4px 0"},children:"DRIVER'S SELECTION"}),e.jsx("p",{style:{fontSize:"12px",color:"white",fontWeight:"700",margin:0},children:a.outsideTrip.tripType||"Outside Trip"}),a.outsideTrip.bonusAmount>0&&e.jsxs("p",{style:{fontSize:"11px",color:"#10b981",fontWeight:"800",margin:"4px 0 0 0"},children:["+â‚¹",a.outsideTrip.bonusAmount]})]}),W.filter(c=>c.date===a.date&&c.vehicle?._id===a.vehicle?._id).map((c,y)=>e.jsx("div",{style:{padding:"6px",background:"rgba(16, 185, 129, 0.08)",borderRadius:"6px",fontSize:"11px",border:"1px solid rgba(16, 185, 129, 0.1)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"white"},children:c.borderName}),e.jsxs("span",{style:{color:"#10b981",fontWeight:"900"},children:["â‚¹",c.amount]})]})},y))]})]})]}),e.jsxs("div",{className:"flex-resp",style:{marginTop:"20px",gap:"12px",display:"flex"},children:[e.jsxs("div",{className:"glass-card",style:{padding:"15px",flex:"1",minWidth:"120px",textAlign:"center",background:"rgba(16, 185, 129, 0.03)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"5px",fontWeight:"800"},children:"TOTAL PAYABLE"}),e.jsxs("h3",{style:{color:"#10b981",margin:0,fontSize:"20px",fontWeight:"900"},children:["â‚¹",((a.dailyWage||a.driver?.dailyWage||a.vehicle?.dutyAmount||500)+(a.punchOut?.allowanceTA||0)+(a.punchOut?.nightStayAmount||0)+(a.outsideTrip?.bonusAmount||0)).toLocaleString()]}),e.jsx("p",{style:{fontSize:"8px",color:"var(--text-muted)",marginTop:"4px"},children:"Base + Incentives"})]}),e.jsxs("div",{className:"glass-card",style:{padding:"15px",flex:"1",minWidth:"120px",textAlign:"center",background:"rgba(16, 185, 129, 0.03)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"var(--text-muted)",marginBottom:"5px",fontWeight:"800"},children:"DISTANCE"}),e.jsxs("h3",{style:{color:"#10b981",margin:0,fontSize:"20px",fontWeight:"900"},children:[a.totalKM||"0"," KM"]})]})]}),a.punchOut?.remarks&&e.jsxs("div",{className:"glass-card",style:{padding:"15px",marginTop:"15px",border:"1px solid rgba(16, 185, 129, 0.2)",background:"rgba(16, 185, 129, 0.02)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"#10b981",marginBottom:"8px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Duty Remarks / Destination"}),e.jsx("p",{style:{color:"white",fontSize:"13px",lineHeight:"1.6",margin:0,fontWeight:"600"},children:a.punchOut.remarks})]}),a.punchOut?.otherRemarks&&e.jsxs("div",{className:"glass-card",style:{padding:"15px",marginTop:"12px",border:"1px solid rgba(244, 63, 94, 0.2)",background:"rgba(244, 63, 94, 0.02)"},children:[e.jsx("p",{style:{fontSize:"9px",color:"#f43f5e",marginBottom:"8px",fontWeight:"900",textTransform:"uppercase",letterSpacing:"1px"},children:"Maintenance Remarks"}),e.jsx("p",{style:{color:"white",fontSize:"13px",lineHeight:"1.5",margin:0},children:a.punchOut.otherRemarks})]})]}):e.jsx("div",{style:{padding:"20px"},children:e.jsxs("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap"},children:[(a.billPhoto||a.receiptPhoto||a.slipPhoto)&&e.jsxs("div",{style:{flex:"0 0 300px"},children:[e.jsx("p",{className:"photo-label",children:"RECEIPT / BILL PHOTO"}),e.jsx("img",{src:a.billPhoto||a.receiptPhoto||a.slipPhoto,style:{width:"100%",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)"},onClick:()=>window.open(a.billPhoto||a.receiptPhoto||a.slipPhoto)})]}),e.jsxs("div",{style:{flex:1,minWidth:"250px"},children:[e.jsx("h3",{className:"modal-section-title",style:{borderColor:"var(--primary)"},children:"Entry Details"}),e.jsxs("div",{className:"glass-card",style:{padding:"20px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"CATEGORY"}),e.jsx("p",{style:{color:"var(--primary)",fontWeight:"900",textTransform:"uppercase"},children:a.entryType})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"AMOUNT"}),e.jsxs("p",{style:{color:"#10b981",fontSize:"24px",fontWeight:"900"},children:["â‚¹",a.amount]})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"VEHICLE"}),e.jsx("p",{style:{color:"white",fontWeight:"800"},children:a.vehicle?.carNumber||a.carNumber||"--"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"ODOMETER"}),e.jsxs("p",{style:{color:"white",fontWeight:"800"},children:[a.odometer||a.km||"--"," KM"]})]}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("p",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"REMARKS / DESCRIPTION"}),e.jsx("p",{style:{color:"white",fontSize:"14px"},children:a.remarks||a.location||a.description||"--"})]})]})]})]})})]})]}),Ge=({item:a,onClose:N,onUpdate:W})=>{const[c,y]=g.useState({allowanceTA:a.punchOut?.allowanceTA||0,nightStayAmount:a.punchOut?.nightStayAmount||0,bonusAmount:a.outsideTrip?.bonusAmount||0,remarks:a.punchOut?.remarks||"",status:a.status||"incomplete"}),S=f=>{f.preventDefault(),W(a._id,c)};return e.jsx("div",{className:"modal-overlay",style:{position:"fixed",inset:0,zIndex:1100,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(5px)",display:"flex",justifyContent:"center",alignItems:"center",padding:"20px"},children:e.jsxs(k.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"glass-card modal-content",style:{width:"100%",maxWidth:"450px",padding:"25px",background:"#0f172a",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"24px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[e.jsx("h2",{style:{color:"white",fontSize:"20px",fontWeight:"900",margin:0,letterSpacing:"-0.5px"},children:"Edit Report"}),e.jsx("button",{onClick:N,style:{background:"rgba(255,255,255,0.05)",color:"white",border:"none",padding:"8px",borderRadius:"50%",display:"flex",cursor:"pointer"},children:e.jsx(xe,{size:18})})]}),a.outsideTrip?.tripType&&e.jsxs("div",{style:{background:"rgba(56, 189, 248, 0.1)",border:"1px solid rgba(56, 189, 248, 0.2)",padding:"12px",borderRadius:"12px",marginBottom:"20px"},children:[e.jsx("p",{style:{margin:0,fontSize:"10px",color:"#38bdf8",fontWeight:"800",textTransform:"uppercase"},children:"Driver's Selection"}),e.jsx("p",{style:{margin:"4px 0 0",color:"white",fontSize:"14px",fontWeight:"700"},children:a.outsideTrip.tripType}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:"10px",color:"rgba(255,255,255,0.5)",fontStyle:"italic"},children:"Please enter the amounts below based on this selection."})]}),e.jsxs("form",{onSubmit:S,style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.6)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",letterSpacing:"0.5px"},children:"Same Day Allowance (TA)"}),e.jsx("input",{type:"number",className:"input-field",value:c.allowanceTA,onChange:f=>y({...c,allowanceTA:f.target.value}),style:{width:"100%",marginBottom:0,height:"48px"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.6)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",letterSpacing:"0.5px"},children:"Night Stay Amount"}),e.jsx("input",{type:"number",className:"input-field",value:c.nightStayAmount,onChange:f=>y({...c,nightStayAmount:f.target.value}),style:{width:"100%",marginBottom:0,height:"48px"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.6)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",letterSpacing:"0.5px"},children:"Other Bonus / Trip Incentive"}),e.jsx("input",{type:"number",className:"input-field",value:c.bonusAmount,onChange:f=>y({...c,bonusAmount:f.target.value}),style:{width:"100%",marginBottom:0,height:"48px"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.6)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"8px",letterSpacing:"0.5px"},children:"Duty Remarks / Destination"}),e.jsx("textarea",{className:"input-field",value:c.remarks,onChange:f=>y({...c,remarks:f.target.value}),style:{width:"100%",minHeight:"100px",marginBottom:0,paddingTop:"12px"}})]}),e.jsxs("div",{className:"form-group",style:{display:"flex",alignItems:"center",gap:"10px",background:"rgba(255,255,255,0.03)",padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("input",{type:"checkbox",id:"statusComplete",checked:c.status==="completed",onChange:f=>y({...c,status:f.target.checked?"completed":"incomplete"}),style:{width:"20px",height:"20px",cursor:"pointer"}}),e.jsx("label",{htmlFor:"statusComplete",style:{color:"white",fontSize:"13px",fontWeight:"700",cursor:"pointer"},children:"Mark Duty as Completed"})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{height:"52px",fontWeight:"900",marginTop:"10px",fontSize:"14px"},children:"SAVE UPDATED DETAILS"})]})]})})},et=()=>{const{selectedCompany:a}=Ee(),N=()=>new Date().toISOString().split("T")[0],W=()=>{const n=new Date;return n.setDate(n.getDate()-180),n.toISOString().split("T")[0]},[c,y]=g.useState(W()),[S,f]=g.useState(N()),[D,ue]=g.useState([]),[R,he]=g.useState([]),[C,ge]=g.useState([]),[I,ye]=g.useState([]),[_,me]=g.useState([]),[E,fe]=g.useState([]),[P,be]=g.useState([]),[ve,je]=g.useState([]),[Te,Se]=g.useState([]),[Y,q]=g.useState(!0),[G,F]=g.useState(null),[X,z]=g.useState(null),[J,we]=g.useState(""),[L,ke]=g.useState("All"),[d,B]=g.useState(["drivers"]),A=[{id:"drivers",label:"Staff Drivers",icon:V,color:"#10b981"},{id:"freelancers",label:"Freelancers",icon:Fe,color:"#8b5cf6"},{id:"vehicles",label:"Vehicle Fleet",icon:ae,color:"#0ea5e9"},{id:"outsideCars",label:"Outside Cars",icon:se,color:"#f59e0b"},{id:"fuel",label:"Fuel Logs",icon:Le,color:"#22c55e"},{id:"maintenance",label:"Maintenance",icon:Be,color:"#ef4444"},{id:"advances",label:"Advances",icon:Me,color:"#6366f1"},{id:"borderTax",label:"Border Tax",icon:le,color:"#8b5cf6"},{id:"parking",label:"Parking",icon:$e,color:"#6366f1"},{id:"fastag",label:"Fastag Logs",icon:Ke,color:"#ec4899"},{id:"accidentLogs",label:"Accident Logs",icon:Ue,color:"#f43f5e"},{id:"partsWarranty",label:"Parts Warranty",icon:le,color:"#f59e0b"}],Ne=n=>{B(t=>t.includes(n)?t.filter(s=>s!==n):[...t,n])},We=()=>{d.length===A.length?B([]):B(A.map(n=>n.id))};g.useEffect(()=>{a&&M()},[a,c,S]);const M=async()=>{if(a?._id){q(!0);try{const n=JSON.parse(localStorage.getItem("userInfo"));if(!n)return;const{data:t}=await U.get(`/api/admin/reports/${a._id}?from=${c}&to=${S}`,{headers:{Authorization:`Bearer ${n.token}`}});ue(t.attendance||[]),he(t.fastagRecharges||[]),ge(t.borderTax||[]),ye(t.fuel||[]),me(t.maintenance||[]),fe(t.advances||[]),be(t.parking||[]),je(t.accidentLogs||[]),Se(t.partsWarranty||[])}catch(n){console.error("Error fetching reports",n)}finally{q(!1)}}},Ce=async(n,t)=>{try{const s=JSON.parse(localStorage.getItem("userInfo"));await U.put(`/api/admin/attendance/${n}`,t,{headers:{Authorization:`Bearer ${s.token}`}}),z(null),M(),alert("Report updated successfully")}catch(s){console.error("Error updating record:",s),alert("Failed to update record: "+(s.response?.data?.message||s.message))}},Q=async n=>{if(window.confirm("Are you sure you want to delete this report entry? This action cannot be undone."))try{const t=JSON.parse(localStorage.getItem("userInfo"));let s="";if(n.entryType==="attendance")s=n.isOutsideCar?`/api/admin/vehicles/${n._id}`:`/api/admin/attendance/${n._id}`;else if(n.entryType==="fuel")s=`/api/admin/fuel/${n._id}`;else if(n.entryType==="parking")s=`/api/admin/parking/${n._id}`;else if(n.entryType==="advance")s=`/api/admin/advances/${n._id}`;else if(n.entryType==="maintenance")s=`/api/admin/maintenance/${n._id}`;else if(n.entryType==="borderTax")s=`/api/admin/border-tax/${n._id}`;else if(n.entryType!=="accidentLog")if(n.entryType==="accidentLog")s=`/api/admin/accident-logs/${n._id}`;else if(n.entryType==="partsWarranty")s=`/api/admin/warranties/${n.itemId||n._id}`,s=`/api/admin/parts-warranty/${n._id}`;else{alert("Deletion not supported for this entry type");return}await U.delete(s,{headers:{Authorization:`Bearer ${t.token}`}}),M(),alert("Record deleted successfully")}catch(t){console.error("Error deleting record:",t),alert("Failed to delete record: "+(t.response?.data?.message||t.message))}},ze=async()=>{const n=await ne(()=>import("./xlsx.min-DHmspywJ.js").then(i=>i.x),__vite__mapDeps([0,1,2]));if(w.length===0)return alert("No records to export in the current table.");const t=n.utils.book_new(),s=new Set,x=w.map(i=>{const r=i.punchIn?.time?new Date(i.punchIn.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--",p=i.punchOut?.time?new Date(i.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--",h=i.date||"Unknown",[v,m,$]=h.split("-"),o=i.driver?._id||i.vehicle?._id||i.driver?.name,b=`${o}_${h}`;let j=0;return o&&!s.has(b)&&(j=i.dailyWage||i.driver?.dailyWage||i.vehicle?.dutyAmount||500,s.add(b)),{Date:`${$}-${m}-${v}`,Name:i.driver?.name||i.vehicle?.driverName||(i.vehicle?.isOutsideCar?"Outside Car":"Unknown"),Car:i.vehicle?.carNumber?i.vehicle.carNumber.split("#")[0]:"",In:r,Out:p,KM:i.totalKM||0,Daily:j,Bonus:(i.punchOut?.allowanceTA||0)+(i.punchOut?.nightStayAmount||0),"T/P":i.punchOut?.tollParkingAmount||(i.parking||[]).reduce((T,O)=>T+(O.amount||0),0),Company:i.vehicle?.isOutsideCar?"OUTSIDE":i.driver?.isFreelancer?"FREELANCER":"Yatree Destination",Remarks:i.punchOut?.otherRemarks||""}}),u=n.utils.json_to_sheet(x),l=n.utils.decode_range(u["!ref"]);for(let i=l.s.c;i<=l.e.c;++i){let r=10;for(let p=l.s.r;p<=l.e.r;++p){const h=u[n.utils.encode_cell({r:p,c:i})];h&&(h.s={alignment:{horizontal:"center",vertical:"center"},font:{name:"Arial",sz:10}},p===0&&(h.s.font.bold=!0,h.s.fill={fgColor:{rgb:"E9E9E9"}}),h.v&&(r=Math.max(r,h.v.toString().length+2)))}u["!cols"]||(u["!cols"]=[]),u["!cols"][i]={wch:r}}n.utils.book_append_sheet(t,u,"Daily Operational Log"),n.writeFile(t,`Daily_Log_${a.name}_${c}.xlsx`)},Ae=async()=>{const n=await ne(()=>import("./xlsx.min-DHmspywJ.js").then(l=>l.x),__vite__mapDeps([0,1,2]));if(d.length===0)return alert("Please select at least one report type from the config box.");const t=n.utils.book_new();let s=!1;const x=l=>{if(!l)return"--";if(l instanceof Date){const h=l.getDate(),v=l.getMonth()+1,m=l.getFullYear();return`${String(h).padStart(2,"0")}-${String(v).padStart(2,"0")}-${m}`}const[i,r,p]=l.includes("T")?l.split("T")[0].split("-"):l.split("-");return`${p}-${r}-${i}`},u=(l,i)=>{const r=D.filter(i);if(r.length===0)return;const p=l==="Outside Cars";r.sort((o,b)=>{const j=(o.driver?.name||"").toLowerCase(),T=(b.driver?.name||"").toLowerCase();return j<T?-1:j>T?1:new Date(o.date)-new Date(b.date)}),s=!0;const h=new Set,v=r.map(o=>{const b={hour:"2-digit",minute:"2-digit",hour12:!0},j=o.punchIn?.time?new Date(o.punchIn.time).toLocaleTimeString("en-IN",b):"--",T=o.punchOut?.time?new Date(o.punchOut.time).toLocaleTimeString("en-IN",b):"--",O=o.driver?._id||o.vehicle?._id||o.driver?.name,ee=`${O}_${o.date}`;let K=0;O&&!h.has(ee)&&(K=o.dailyWage||o.driver?.dailyWage||o.vehicle?.dutyAmount||500,h.add(ee));const te=o.vehicle?.carNumber?o.vehicle.carNumber.split("#")[0].slice(-4):"";return p?{"Driver Name":o.driver?.name||o.vehicle?.driverName||(o.vehicle?.isOutsideCar?"Outside Car":"Unknown"),Date:x(o.date),Car:te,"Punch In":j,"Punch Out":T,"Daily Wage":K}:{"Driver Name":o.driver?.name||o.vehicle?.driverName||(o.vehicle?.isOutsideCar?"Outside Car":"Unknown"),Date:x(o.date),Car:te,"Punch In":j,"Punch Out":T,"KM Run":o.totalKM||0,"Daily Wage":K,Bonus:(o.punchOut?.allowanceTA||0)+(o.punchOut?.nightStayAmount||0),"Toll/Parking":o.punchOut?.tollParkingAmount||(o.parking||[]).reduce((Ie,_e)=>Ie+(_e.amount||0),0),"Fuel Cost":o.fuel?.amount||0,Remarks:o.punchOut?.otherRemarks||o.punchIn?.remarks||""}}),m=v.reduce((o,b)=>(p||(o["KM Run"]+=Number(b["KM Run"])||0,o["Toll/Parking"]+=Number(b["Toll/Parking"])||0,o["Fuel Cost"]+=Number(b["Fuel Cost"])||0,o.Bonus+=Number(b.Bonus)||0),o["Daily Wage"]+=Number(b["Daily Wage"])||0,o),p?{"Driver Name":"TOTAL",Date:"-",Car:"-","Punch In":"-","Punch Out":"-","Daily Wage":0}:{"Driver Name":"TOTAL",Date:"-",Car:"-","KM Run":0,"Daily Wage":0,Bonus:0,"Toll/Parking":0,"Fuel Cost":0});v.push(m);const $=n.utils.json_to_sheet(v);n.utils.book_append_sheet(t,$,l)};if(d.includes("drivers")&&u("Staff Drivers",l=>!(l.vehicle?.isOutsideCar||l.isOutsideCar||l.isFreelancer||l.driver?.isFreelancer)),d.includes("freelancers")&&u("Freelancers",l=>(l.isFreelancer||l.driver?.isFreelancer)&&!(l.vehicle?.isOutsideCar||l.isOutsideCar)),d.includes("outsideCars")&&u("Outside Cars",l=>l.vehicle?.isOutsideCar||l.isOutsideCar),d.includes("vehicles")){const l={};D.forEach(r=>{const p=r.vehicle?._id;if(!p)return;const h=r.vehicle.carNumber?r.vehicle.carNumber.split("#")[0]:"";l[p]||(l[p]={"Car Number":h,Model:r.vehicle.model||"",Type:r.vehicle.carType||"","Total KM":0,"Days Worked":0,"Toll & Parking":0,"Fuel Cost":0,"Net Revenue":0}),l[p]["Total KM"]+=r.totalKM||0,l[p]["Days Worked"]+=1,l[p]["Toll & Parking"]+=r.punchOut?.tollParkingAmount||0,l[p]["Fuel Cost"]+=r.fuel?.amount||0,l[p]["Net Revenue"]+=r.vehicle?.dutyAmount||0});const i=Object.values(l).sort((r,p)=>r["Car Number"].localeCompare(p["Car Number"]));i.length>0&&(s=!0,n.utils.book_append_sheet(t,n.utils.json_to_sheet(i),"Vehicle Summary"))}if(d.includes("fuel")&&I.length>0){s=!0;const l=I.map(i=>({Date:x(new Date(i.date)),Car:i.vehicle?.carNumber?i.vehicle.carNumber.split("#")[0]:"N/A","Fuel Type":i.fuelType,Quantity:i.quantity,Rate:i.rate,Amount:i.amount,"KM Odometer":i.odometer,Station:i.stationName||"N/A",Payment:i.paymentMode,Driver:i.driver||"N/A"}));n.utils.book_append_sheet(t,n.utils.json_to_sheet(l),"Fuel Logs")}if(d.includes("maintenance")&&_.length>0){s=!0;const l=_.map(i=>({Date:x(new Date(i.billDate)),Car:i.vehicle?.carNumber?i.vehicle.carNumber.split("#")[0]:"N/A",Type:i.maintenanceType,Category:i.category||"N/A",Description:i.description||"N/A",Garage:i.garageName||"N/A","Bill No":i.billNumber||"N/A",Amount:i.amount,"KM Reading":i.currentKm||"N/A"}));n.utils.book_append_sheet(t,n.utils.json_to_sheet(l),"Maintenance")}if(d.includes("advances")&&E.length>0){s=!0;const l=E.map(i=>({Date:x(new Date(i.date)),"Driver Name":i.driver?.name||"Unknown",Mobile:i.driver?.mobile||"N/A",Amount:i.amount,Remark:i.remark||"",Status:i.status==="Pending"?"Advance Success":i.status==="Recovered"?"Fully Recovered":i.status}));n.utils.book_append_sheet(t,n.utils.json_to_sheet(l),"Advances")}if(d.includes("borderTax")&&C.length>0){s=!0;const i=[...C].sort((r,p)=>new Date(r.date)-new Date(p.date)).map(r=>({Date:x(r.date),"Car Number":r.vehicle?.carNumber?r.vehicle.carNumber.split("#")[0]:"N/A","Border Name":r.borderName,Amount:r.amount,Remarks:r.remarks||""}));n.utils.book_append_sheet(t,n.utils.json_to_sheet(i),"Border Tax")}if(d.includes("parking")&&P.length>0){s=!0;const l=P.map(i=>({Date:x(new Date(i.date)),Car:i.vehicle?.carNumber?i.vehicle.carNumber.split("#")[0]:"N/A",Driver:i.driver||"N/A",Amount:i.amount,Location:i.location||"N/A",Remark:i.remark||"",Source:i.source||"Admin"}));n.utils.book_append_sheet(t,n.utils.json_to_sheet(l),"Parking Logs")}if(d.includes("fastag")&&R.length>0){s=!0;const i=[...R].sort((r,p)=>new Date(r.date)-new Date(p.date)).map(r=>{const p=new Date(r.date);return{Date:x(p),Time:p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"Car Number":r.carNumber||"N/A",Amount:Number(r.amount)||0,"Bank/Method":r.method||"Not Specified",Remarks:r.remarks||""}});n.utils.book_append_sheet(t,n.utils.json_to_sheet(i),"Fastag Recharges")}if(!s)return alert("No data available for the selected categories in this range.");Object.values(t.Sheets).forEach(l=>{if(!l["!ref"])return;const i=n.utils.decode_range(l["!ref"]),r=[];for(let p=i.s.c;p<=i.e.c;++p){let h=10;for(let v=i.s.r;v<=i.e.r;++v){const m=l[n.utils.encode_cell({r:v,c:p})];m&&(m.s={alignment:{horizontal:"center",vertical:"center"},font:{name:"Arial",sz:10}},v===0&&(m.s.font.bold=!0,m.s.fill={fgColor:{rgb:"333333"}},m.s.font.color={rgb:"FFFFFF"}),l[n.utils.encode_cell({r:v,c:0})]?.v==="TOTAL"&&(m.s.font.bold=!0,m.s.fill={fgColor:{rgb:"FFFFCC"}}),m.v&&(h=Math.max(h,m.v.toString().length+2)))}r.push({wch:h})}l["!cols"]=r}),n.writeFile(t,`Premium_Fleet_Export_${c}.xlsx`)},Oe=()=>{let n=[];const t=s=>{if(!s)return"";if(typeof s=="string")return s.split("T")[0];try{return new Date(s).toISOString().split("T")[0]}catch{return""}};if(d.includes("drivers")||d.includes("freelancers")||d.includes("outsideCars")||d.includes("vehicles")){const s=D.filter(x=>{const u=x.vehicle?.isOutsideCar||x.isOutsideCar,l=x.isFreelancer||x.driver?.isFreelancer;return!!(d.includes("outsideCars")&&u||d.includes("freelancers")&&l||d.includes("drivers")&&!u&&!l||d.includes("vehicles"))});n=[...n,...s.map(x=>({...x,entryType:"attendance"}))]}return(d.includes("fuel")||d.includes("vehicles"))&&(n=[...n,...I.map(s=>({...s,entryType:"fuel",date:t(s.date)}))]),(d.includes("maintenance")||d.includes("vehicles"))&&(n=[...n,..._.map(s=>({...s,entryType:"maintenance",date:t(s.billDate)}))]),d.includes("advances")&&(n=[...n,...E.map(s=>({...s,entryType:"advance",date:t(s.date)}))]),(d.includes("borderTax")||d.includes("vehicles"))&&(n=[...n,...C.map(s=>({...s,entryType:"borderTax"}))]),d.includes("fastag")&&(n=[...n,...R.map(s=>({...s,entryType:"fastag",date:t(s.date)}))]),d.includes("parking")&&(n=[...n,...P.map(s=>({...s,entryType:"parking",date:t(s.date)}))]),d.includes("accidentLogs")&&(n=[...n,...ve.map(s=>({...s,entryType:"accidentLog",date:t(s.date),receiptPhoto:s.photos&&s.photos.length>0?s.photos[0]:null}))]),d.includes("partsWarranty")&&(n=[...n,...Te.map(s=>({...s,entryType:"partsWarranty",date:t(s.purchaseDate),amount:s.cost,description:`${s.partName} (${s.brandName}) - Ends: ${t(s.warrantyEndDate)}`,receiptPhoto:s.warrantyCardImage}))]),n.sort((s,x)=>{const u=s.date||"";return(x.date||"").localeCompare(u)})},De=n=>{const t=J.toLowerCase(),s=(n.driver?.name||n.driverName||"").toLowerCase(),x=(n.vehicle?.carNumber||n.carNumber||"").toLowerCase(),u=s.includes(t)||x.includes(t),l=L==="All"||x===L.toLowerCase();return u&&l},Z=Oe(),Re=[...new Set(Z.map(n=>n.vehicle?.carNumber||n.carNumber).filter(Boolean))].sort(),w=Z.filter(De);return e.jsxs("div",{className:"container-fluid",style:{paddingBottom:"40px"},children:[e.jsx(Ye,{title:"Operational Reports",description:"Detailed daily fleet reports, attendance logs, and expenditure history for your taxi business."}),e.jsxs("header",{className:"flex-resp",style:{justifyContent:"space-between",padding:"30px 0",gap:"20px",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"clamp(40px,10vw,50px)",height:"clamp(40px,10vw,50px)",background:"linear-gradient(135deg, white, #f8fafc)",borderRadius:"16px",padding:"8px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:e.jsx(Pe,{size:28,color:"#fbbf24"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#fbbf24",boxShadow:"0 0 8px #fbbf24"}}),e.jsx("span",{style:{fontSize:"clamp(9px,2.5vw,10px)",fontWeight:"800",color:"rgba(255,255,255,0.5)",letterSpacing:"1px",textTransform:"uppercase"},children:"Operational Insights"})]}),e.jsxs("h1",{style:{color:"white",fontSize:"clamp(24px,5vw,32px)",fontWeight:"900",margin:0,letterSpacing:"-1px",cursor:"pointer"},children:["Daily ",e.jsx("span",{className:"text-gradient-yellow",children:"Reports"})]})]})]}),e.jsxs("div",{className:"flex-resp",style:{gap:"12px",flexWrap:"wrap",justifyContent:"flex-end",flex:"1 1 auto"},children:[e.jsxs("div",{className:"mobile-stack",style:{gap:"15px",display:"flex",flexWrap:"wrap",justifyContent:"flex-end"},children:[e.jsxs("div",{style:{position:"relative",flex:"1 1 140px"},children:[e.jsx("span",{style:{position:"absolute",top:"-18px",left:"0",fontSize:"9px",fontWeight:"800",color:"var(--text-muted)",textTransform:"uppercase"},children:"From"}),e.jsx("input",{type:"date",value:c,onChange:n=>y(n.target.value),className:"input-field",style:{height:"45px",marginBottom:0,width:"100%",minWidth:"130px",padding:"0 12px"}})]}),e.jsxs("div",{style:{position:"relative",flex:"1 1 140px"},children:[e.jsx("span",{style:{position:"absolute",top:"-18px",left:"0",fontSize:"9px",fontWeight:"800",color:"var(--text-muted)",textTransform:"uppercase"},children:"To"}),e.jsx("input",{type:"date",value:S,onChange:n=>f(n.target.value),className:"input-field",style:{height:"45px",marginBottom:0,width:"100%",minWidth:"130px",padding:"0 12px"}})]})]}),e.jsxs("button",{onClick:ze,className:"btn-primary",style:{height:"45px",padding:"0 20px",display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",whiteSpace:"nowrap",flexShrink:0},children:[e.jsx(ie,{size:18})," ",e.jsx("span",{className:"hide-mobile",children:"Export Excel"}),e.jsx("span",{className:"show-mobile",children:"Export"})]})]})]}),e.jsxs(k.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"glass-card",style:{padding:"clamp(15px, 3vw, 25px)",marginBottom:"30px",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.05)",borderRadius:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px",flexWrap:"wrap",gap:"15px"},children:[e.jsxs("div",{className:"flex-resp",style:{gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ae,{size:20,style:{color:"var(--primary)"}}),e.jsx("h2",{style:{fontSize:"18px",fontWeight:"800",color:"white",margin:0},children:"Reports Config"})]}),e.jsxs("div",{className:"flex-resp hide-mobile",style:{gap:"12px",background:"rgba(255,255,255,0.03)",padding:"8px 15px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"START:"}),e.jsx("input",{type:"date",value:c,onChange:n=>y(n.target.value),style:{background:"transparent",border:"none",color:"white",fontSize:"12px",outline:"none",cursor:"pointer"}})]}),e.jsx("div",{style:{width:"1px",height:"15px",background:"rgba(255,255,255,0.1)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"END:"}),e.jsx("input",{type:"date",value:S,onChange:n=>f(n.target.value),style:{background:"transparent",border:"none",color:"white",fontSize:"12px",outline:"none",cursor:"pointer"}})]})]}),e.jsxs("button",{onClick:Ae,className:"btn-primary",style:{background:"linear-gradient(135deg, #10b981, #059669)",padding:"10px 18px",fontSize:"13px",gap:"8px"},children:[e.jsx(ie,{size:16})," ",e.jsx("span",{className:"hide-mobile",children:"Download Selected"}),e.jsx("span",{className:"show-mobile",children:"Download"})]})]}),e.jsx("button",{onClick:We,style:{background:"rgba(14, 165, 233, 0.1)",border:"none",color:"var(--primary)",padding:"8px 15px",borderRadius:"8px",fontSize:"12px",fontWeight:"800",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:d.length===A.length?"Deselect All":"Select All"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(110px, 1fr))",gap:"10px"},children:A.map(n=>e.jsxs(k.div,{whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},onClick:()=>Ne(n.id),style:{padding:"12px",borderRadius:"12px",cursor:"pointer",transition:"0.2s",background:d.includes(n.id)?`${n.color}15`:"rgba(255,255,255,0.02)",border:`1px solid ${d.includes(n.id)?n.color:"rgba(255,255,255,0.05)"}`,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",textAlign:"center"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",display:"flex",justifyContent:"center",alignItems:"center",background:d.includes(n.id)?n.color:"rgba(255,255,255,0.05)",color:d.includes(n.id)?"white":"var(--text-muted)"},children:e.jsx(n.icon,{size:16})}),e.jsx("span",{style:{fontSize:"11px",fontWeight:"800",color:d.includes(n.id)?"white":"var(--text-muted)"},children:n.label})]},n.id))})]}),e.jsxs("div",{className:"flex-resp",style:{marginBottom:"30px",gap:"15px"},children:[e.jsxs("div",{style:{position:"relative",flex:2,minWidth:"min(100%, 300px)"},children:[e.jsx("input",{type:"text",placeholder:"Search driver or car number...",value:J,onChange:n=>we(n.target.value),className:"input-field",style:{width:"100%",paddingLeft:"45px",marginBottom:0,height:"50px",borderRadius:"15px"}}),e.jsx(Ve,{size:20,style:{position:"absolute",left:"16px",top:"15px",color:"var(--text-muted)"}})]}),e.jsx("div",{style:{flex:1,minWidth:"200px"},children:e.jsxs("select",{value:L,onChange:n=>ke(n.target.value),className:"input-field",style:{width:"100%",height:"50px",borderRadius:"15px",marginBottom:0,background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)",color:"white",fontWeight:"700"},children:[e.jsx("option",{value:"All",style:{background:"#0f172a"},children:"Filter by Car Number"}),Re.map(n=>e.jsx("option",{value:n,style:{background:"#0f172a"},children:n},n))]})})]}),e.jsx("div",{className:"scroll-x glass-card hide-mobile",style:{padding:"0",border:"1px solid rgba(255,255,255,0.05)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:"white",minWidth:"1000px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(255,255,255,0.02)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Duty Date"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Fleet Personnel"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Type"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Insight"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"In/Start"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Out/End"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Amount/Pay"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase"},children:"Duty KM"}),e.jsx("th",{style:{padding:"18px 25px",color:"var(--text-muted)",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",textAlign:"right"},children:"Action"})]})}),e.jsx("tbody",{children:(()=>{const n=new Set;return Y?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{padding:"80px",textAlign:"center"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",color:"var(--text-muted)"},children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Parsing fleet logs..."})]})})}):w.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",style:{padding:"80px",textAlign:"center"},children:[e.jsx("div",{style:{opacity:.2,marginBottom:"15px"},children:e.jsx(H,{size:40,style:{margin:"0 auto"}})}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"14px",margin:0},children:"No transaction history found for the selected period."})]})}):w.map(t=>{const s=t.driver?._id||t.vehicle?._id||t.driver?.name,x=`${s}_${t.date}`;let u=0;return s&&!n.has(x)&&(u=(t.dailyWage||t.driver?.dailyWage||t.vehicle?.dutyAmount||500)+(t.punchOut?.allowanceTA||0)+(t.punchOut?.nightStayAmount||0),n.add(x)),e.jsxs(k.tr,{initial:{opacity:0},animate:{opacity:1},style:{borderBottom:"1px solid rgba(255,255,255,0.03)",transition:"background 0.2s"},className:"hover-row",children:[e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"var(--text-muted)"},children:[e.jsx(H,{size:14,style:{opacity:.5}}),e.jsx("span",{style:{fontWeight:"700",fontSize:"13px",color:"white"},children:(()=>{if(!t.date)return"--";const[l,i,r]=t.date.split("-");return`${r}-${i}-${l}`})()})]})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"38px",height:"38px",borderRadius:"12px",background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(V,{size:18,color:"white"})}),e.jsxs("div",{children:[e.jsx("p",{style:{fontWeight:"800",fontSize:"14px",margin:0},children:t.driver?.name||t.vehicle?.driverName||(t.vehicle?.isOutsideCar?"Outside Car":typeof t.driver=="string"?t.driver:"N/A")}),e.jsx("p",{style:{fontSize:"11px",color:"var(--text-muted)",margin:"2px 0 0 0"},children:t.driver?.mobile||"-"}),t.entryType==="attendance"&&t.outsideTrip?.tripType&&e.jsxs("p",{style:{fontSize:"10px",color:"#38bdf8",margin:"4px 0 0 0",fontWeight:"800"},children:["ðŸš— ",t.outsideTrip.tripType]}),t.entryType==="attendance"&&t.punchOut?.remarks&&e.jsxs("p",{style:{fontSize:"10px",color:"var(--primary)",margin:"4px 0 0 0",fontWeight:"700",opacity:.8},children:["ðŸ“ ",t.punchOut.remarks]})]})]})}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[e.jsx("span",{style:{fontSize:"10px",fontWeight:"800",textTransform:"uppercase",padding:"4px 10px",borderRadius:"6px",background:t.entryType==="attendance"?"rgba(16, 185, 129, 0.1)":t.entryType==="fuel"?"rgba(34, 197, 94, 0.1)":t.entryType==="parking"||t.entryType==="advance"?"rgba(99, 102, 241, 0.1)":"rgba(255,255,255,0.05)",color:t.entryType==="attendance"?"#10b981":t.entryType==="fuel"?"#22c55e":t.entryType==="parking"||t.entryType==="advance"?"#6366f1":"white",textAlign:"center"},children:t.entryType}),t.entryType==="attendance"&&t.status==="incomplete"&&e.jsx("span",{style:{fontSize:"8px",background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",padding:"2px 6px",borderRadius:"4px",fontWeight:"800",textAlign:"center"},children:"INCOMPLETE"}),t.entryType==="attendance"&&t.status==="completed"&&e.jsx("span",{style:{fontSize:"8px",background:"rgba(16, 185, 129, 0.1)",color:"#10b981",padding:"2px 6px",borderRadius:"4px",fontWeight:"800",textAlign:"center"},children:"COMPLETED"})]})}),e.jsxs("td",{style:{padding:"18px 25px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"white",fontWeight:"700",fontSize:"14px"},children:[e.jsx(se,{size:16,style:{color:"var(--primary)",opacity:.7}}),e.jsx("span",{children:(t.vehicle?.carNumber||t.carNumber||"--").split("#")[0]})]}),t.entryType==="attendance"&&(t.punchOut?.allowanceTA>0||t.punchOut?.nightStayAmount>0)&&e.jsxs("div",{style:{display:"flex",gap:"4px",marginTop:"4px"},children:[t.punchOut.allowanceTA>0&&e.jsxs("span",{style:{fontSize:"9px",background:"rgba(16, 185, 129, 0.1)",color:"#10b981",padding:"1px 4px",borderRadius:"3px",fontWeight:"800"},children:["DAY +",t.punchOut.allowanceTA]}),t.punchOut.nightStayAmount>0&&e.jsxs("span",{style:{fontSize:"9px",background:"rgba(245, 158, 11, 0.1)",color:"#f59e0b",padding:"1px 4px",borderRadius:"3px",fontWeight:"800"},children:["NIGHT +",t.punchOut.nightStayAmount]})]})]}),e.jsx("td",{style:{padding:"18px 25px"},children:t.entryType==="attendance"?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#10b981",fontWeight:"800"},children:[e.jsx(re,{size:14}),e.jsx("span",{children:new Date(t.punchIn?.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}):t.entryType==="fuel"?e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"12px"},children:[t.fuelType," | ",t.quantity,"L"]}):t.entryType==="parking"?e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"12px"},children:t.location||"Local Parking"}):t.entryType==="fastag"?e.jsx("span",{style:{color:"#ec4899",fontSize:"12px",fontWeight:"800"},children:t.method||"Manual"}):t.entryType==="maintenance"?e.jsx("span",{style:{color:"#ef4444",fontSize:"12px",fontWeight:"800"},children:t.maintenanceType||"Service"}):t.entryType==="borderTax"?e.jsx("span",{style:{color:"#8b5cf6",fontSize:"12px",fontWeight:"800"},children:t.borderName}):t.entryType==="partsWarranty"?e.jsx("span",{style:{color:"#f59e0b",fontSize:"12px",fontWeight:"800"},children:t.partName}):t.entryType==="accidentLog"?e.jsx("span",{style:{color:"#f43f5e",fontSize:"12px",fontWeight:"800"},children:t.description?t.description.substring(0,20)+"...":"Incident"}):"--"}),e.jsx("td",{style:{padding:"18px 25px"},children:t.entryType==="attendance"&&t.punchOut?.time?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#f43f5e",fontWeight:"800"},children:[e.jsx(oe,{size:14}),e.jsx("span",{children:new Date(t.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}):t.entryType==="fastag"?e.jsx("span",{style:{color:"rgba(255,255,255,0.4)",fontSize:"11px"},children:"Recharge"}):t.entryType==="partsWarranty"?e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:["Exp: ",new Date(t.warrantyEndDate).toLocaleDateString()]}):"--"}),e.jsx("td",{style:{padding:"18px 25px"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("span",{style:{color:"#10b981",fontWeight:"900",fontSize:"15px"},children:["â‚¹",(t.amount||u||0).toLocaleString()]}),t.entryType==="attendance"&&u>0&&e.jsxs("span",{style:{fontSize:"9px",color:"var(--text-muted)",fontWeight:"600"},children:["(W:",t.dailyWage||t.driver?.dailyWage||500," + B:",(t.punchOut?.allowanceTA||0)+(t.punchOut?.nightStayAmount||0),")"]})]})}),e.jsx("td",{style:{padding:"18px 25px"},children:t.entryType==="advance"?e.jsx("span",{style:{fontSize:"11px",fontWeight:"800",color:t.status==="Pending"?"#fbbf24":"#10b981"},children:t.status==="Pending"?"Advance Given":"Success"}):t.entryType==="attendance"?e.jsx("span",{style:{color:"white",fontSize:"14px",fontWeight:"800"},children:t.totalKM?`${t.totalKM} KM`:"--"}):t.entryType==="fuel"?e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:[t.odometer||"--"," KM"]}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"11px"},children:"--"})}),e.jsx("td",{style:{padding:"18px 25px",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[(t.entryType==="attendance"||t.entryType==="fuel"||t.entryType==="parking"||t.entryType==="advance"||t.entryType==="maintenance"||t.entryType==="borderTax"||t.entryType==="partsWarranty"||t.entryType==="accidentLog")&&e.jsxs("button",{onClick:()=>F(t),className:"glass-card",style:{padding:"8px 15px",color:"var(--primary)",border:"1px solid rgba(14, 165, 233, 0.1)",display:"inline-flex",alignItems:"center",gap:"8px",fontSize:"11px",fontWeight:"800"},children:[e.jsx(de,{size:14})," VIEW"]}),t.entryType==="attendance"&&e.jsxs("button",{onClick:()=>z(t),className:"glass-card",style:{padding:"8px 15px",color:"#fbbf24",border:"1px solid rgba(251, 191, 36, 0.1)",display:"inline-flex",alignItems:"center",gap:"8px",fontSize:"11px",fontWeight:"800"},children:[e.jsx(ce,{size:14})," EDIT"]}),e.jsxs("button",{onClick:()=>Q(t),className:"glass-card",style:{padding:"8px 15px",color:"#f43f5e",border:"1px solid rgba(244, 63, 94, 0.1)",display:"inline-flex",alignItems:"center",gap:"8px",fontSize:"11px",fontWeight:"800"},children:[e.jsx(pe,{size:14})," DELETE"]})]})})]},t._id)})})()})]})}),e.jsx("div",{className:"show-mobile",children:(()=>{const n=new Set;return Y?e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"40px"},children:e.jsx("div",{className:"spinner"})}):w.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"var(--text-muted)",background:"rgba(255,255,255,0.02)",borderRadius:"16px"},children:[e.jsx(H,{size:40,style:{opacity:.2,marginBottom:"10px"}}),e.jsx("p",{children:"No transactions found."})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:w.map(t=>{const s=t.driver?._id||t.vehicle?._id||t.driver?.name,x=`${s}_${t.date}`;let u=0;return s&&!n.has(x)&&(u=(t.dailyWage||t.driver?.dailyWage||t.vehicle?.dutyAmount||500)+(t.punchOut?.allowanceTA||0)+(t.punchOut?.nightStayAmount||0),n.add(x)),e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"glass-card",style:{padding:"16px",background:"rgba(30, 41, 59, 0.4)",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"10px",background:"rgba(14, 165, 233, 0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(V,{size:18,color:"var(--primary)"})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"white",fontWeight:"900",fontSize:"16px"},children:t.driver?.name||(t.vehicle?.isOutsideCar?"Outside Car":typeof t.driver=="string"?t.driver:"N/A")}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:t.vehicle?.carNumber?.split("#")[0]||(typeof t.carNumber=="string"?t.carNumber:"--")}),t.entryType==="attendance"&&t.punchOut?.remarks&&e.jsx("div",{style:{fontSize:"11px",color:"var(--primary)",marginTop:"2px",fontWeight:"600"},children:t.punchOut.remarks}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx("span",{style:{fontSize:"10px",fontWeight:"800",textTransform:"uppercase",padding:"2px 8px",borderRadius:"4px",background:t.entryType==="attendance"?"rgba(16, 185, 129, 0.1)":t.entryType==="fuel"?"rgba(34, 197, 94, 0.1)":t.entryType==="parking"||t.entryType==="advance"?"rgba(99, 102, 241, 0.1)":"rgba(255,255,255,0.05)",color:t.entryType==="attendance"?"#10b981":t.entryType==="fuel"?"#22c55e":t.entryType==="parking"||t.entryType==="advance"?"#6366f1":"white"},children:t.entryType})})]})]}),e.jsx("span",{style:{fontSize:"9px",color:t.vehicle?.isOutsideCar?"#f59e0b":t.driver?.isFreelancer?"#f43f5e":"#10b981",background:t.vehicle?.isOutsideCar?"rgba(245, 158, 11, 0.1)":t.driver?.isFreelancer?"rgba(244, 63, 94, 0.1)":"rgba(16, 185, 129, 0.1)",padding:"3px 8px",borderRadius:"6px",fontWeight:"800",textTransform:"uppercase",letterSpacing:"0.4px"},children:t.vehicle?.isOutsideCar?"OUT":t.driver?.isFreelancer?"FREE":"STAFF"}),t.entryType==="attendance"&&(t.punchOut?.allowanceTA>0||t.punchOut?.nightStayAmount>0)&&e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.punchOut.allowanceTA>0&&e.jsxs("span",{style:{fontSize:"9px",background:"rgba(16, 185, 129, 0.1)",color:"#10b981",padding:"1px 4px",borderRadius:"3px",fontWeight:"800"},children:["+",t.punchOut.allowanceTA]}),t.punchOut.nightStayAmount>0&&e.jsxs("span",{style:{fontSize:"9px",background:"rgba(245, 158, 11, 0.1)",color:"#f59e0b",padding:"1px 4px",borderRadius:"3px",fontWeight:"800"},children:["+",t.punchOut.nightStayAmount]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"12px",padding:"10px",background:"rgba(0,0,0,0.2)",borderRadius:"10px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:"800"},children:"In Time"}),e.jsxs("div",{style:{color:"#10b981",fontSize:"13px",fontWeight:"700",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(re,{size:12}),new Date(t.punchIn?.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:"800"},children:"Out Time"}),e.jsxs("div",{style:{color:"#f43f5e",fontSize:"13px",fontWeight:"700",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(oe,{size:12}),t.punchOut?.time?new Date(t.punchOut.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"ON DUTY"]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"10px",borderTop:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"KM RUN"}),e.jsxs("div",{style:{color:"white",fontWeight:"900"},children:[t.totalKM||t.odometer||"0"," KM"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:"800"},children:"PAY"}),e.jsx("div",{style:{color:"#10b981",fontWeight:"900"},children:u>0?`â‚¹${u}`:"--"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[(t.entryType==="attendance"||t.entryType==="fuel"||t.entryType==="parking"||t.entryType==="advance"||t.entryType==="maintenance"||t.entryType==="borderTax")&&e.jsxs("button",{onClick:()=>F(t),style:{background:"rgba(14, 165, 233, 0.1)",color:"var(--primary)",padding:"8px 12px",borderRadius:"8px",border:"1px solid rgba(14, 165, 233, 0.2)",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:"700"},children:[e.jsx(de,{size:14})," View"]}),t.entryType==="attendance"&&e.jsx("button",{onClick:()=>z(t),style:{background:"rgba(251, 191, 36, 0.1)",color:"#fbbf24",padding:"8px 12px",borderRadius:"8px",border:"1px solid rgba(251, 191, 36, 0.2)",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:"700"},children:e.jsx(ce,{size:14})}),e.jsx("button",{onClick:()=>Q(t),style:{background:"rgba(244, 63, 94, 0.1)",color:"#f43f5e",padding:"8px 12px",borderRadius:"8px",border:"1px solid rgba(244, 63, 94, 0.2)",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:"700"},children:e.jsx(pe,{size:14})})]})]})]},t._id)})})})()}),e.jsxs(He,{children:[G&&e.jsx(qe,{item:G,onClose:()=>F(null),borderTaxRecords:C}),X&&e.jsx(Ge,{item:X,onClose:()=>z(null),onUpdate:Ce})]})]})};export{et as default};
